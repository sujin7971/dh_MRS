(()=>{"use strict";const e=e=>null==e||"object"==typeof e&&0===Object.keys(e).length||!(!Array.isArray(e)||0!==e.length)||"string"==typeof e&&0===e.trim().length,t=(e=16)=>((e<1||e>16)&&(e=16),([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))).substring(0,e)),n=(t,n)=>{if(!e(t)&&!e(n))for(const e in n)(t.hasOwnProperty(e)||t[e])&&Object.assign(t,{[e]:n[e]})},s=document,i=(e,...t)=>{const n=s.createElement(e);return a(n,...t),n},o=e=>{const t=i("div");return t.innerHTML=e.trim(),t.firstChild},a=(t,...n)=>{const s=l(t);for(const t of n)e(t)||s?.classList.add(t);return s},r=(t,...n)=>{const s=l(t);for(const t of n)e(t)||s?.classList.remove(t);return s},l=e=>e instanceof HTMLElement?e:s.querySelector(e),d=e=>e instanceof HTMLElement?e:s.querySelectorAll(e),c={on(e,t){if(this._eventHandlers||(this._eventHandlers={}),"string"==typeof e)this._eventHandlers[e]||(this._eventHandlers[e]=[]),this._eventHandlers[e].push(t);else if("object"==typeof e)for(let t in e){let n=t,s=e[t];this._eventHandlers[n]||(this._eventHandlers[n]=[]),this._eventHandlers[n].push(s)}return this},off(e,t){if(!this._eventHandlers)return;if(!e&&!t)return void(this._eventHandlers={});if(e&&!t)return void delete this._eventHandlers[e];let n=this._eventHandlers?.[e];if(n){let e=n.indexOf(t);-1!==e&&n.splice(e,1)}return this},unbind(...e){this.off(...e)},trigger(e,...t){if(this._eventHandlers?.[e])if("string"==typeof e)this._eventHandlers[e].forEach((e=>e.apply(this,t)));else if("object"==typeof e)for(let t in e){let n=t,s=e[t];this._eventHandlers[n].forEach((e=>e.apply(this,s)))}}};class u{static TEMPLATE='\n\t<div class="modal" data-modal="09bcbd7d">\n\t\t<div class="modalWrap">\n\t\t\t<div class="modal_content">\n\t\t\t\t<div class="modalTitle" data-modal-role="title"></div>\n\t\t\t\t<div class="modalBody" data-modal-role="message"></div>\n\t\t\t\t<div class="modalBtnDiv" data-modal-role="btn-container"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t';constructor(e){const{modalElement:t,exclusive:n=!1,autoHide:s=!0,autoDestroy:i=!0}=e;this.update({modalElement:t,exclusive:n,autoHide:s,autoDestroy:i}),l("body").appendChild(this.modalElement)}update(e){const{modalElement:t=this.modalElement,exclusive:n=this.exclusive,autoHide:s=this.autoHide,autoDestroy:i=this.autoDestroy}=e;this.exclusive=n,this.autoHide=s,this.autoDestroy=i,this.modalElement=t,this.id=t.dataset.modal,this.setButton()}show(){if(!this.resolve)return this.payload=void 0,this.modalElement.style.display="block",this.trigger("show"),new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}async hide(e={}){const{action:t="AUTO",source:n="USER",status:s="SUCESS",payload:i}=e;this.modalElement.style.display="none",this.trigger("hide");const o={action:t,status:s,source:n,timestamp:Date.now(),payload:i};i&&(o.payload=i),this.resolve?.(o),this.resolve=null,this.reject=null}setTitle(e){const t=this.modalElement.querySelector(".modalTitle");return t&&(t.innerHTML=e),this}setMessage(e){const t=this.modalElement.querySelector(".modalBody");return t&&(t.innerHTML=e),this}addButton(e){const t=this.modalElement.querySelector(".modalBtnDiv");if(!t)return this;for(const n of e.flat()){const{label:e="닫기",action:s="close",color:o="blue"}=n,a=["btn","btn-md"];switch(o){case"red":a.push("btn-red");break;case"yellow":a.push("btn-yellow");break;case"blue":a.push("btn-blue");break;default:a.push("btn-silver")}const r=i("button",...a);r.type="button",r.innerText=e,r.dataset.modalAction=s,t.appendChild(r)}return this.setButton(),this}setButton(){const e=this.modalElement.querySelectorAll("[data-modal-action]");this.buttons=e,e.forEach((e=>{const t=e.dataset.modalAction?.toUpperCase()||"NONE",n=e.dataset.modalClose||!0;e.onclick=()=>{this.trigger("action",t,e),!0===this.autoHide&&!0===n&&this.hide({soure:"AUTO",action:t})}}))}isExclulsive(){return this.exclusive}getId(){return this.id}getElement(){return this.modalElement}displayButton(...e){this.buttons.forEach((t=>{(0==e.length||e.includes(t.name))&&(t.style.display="")}))}concealButton(...e){this.buttons.forEach((t=>{(0==e.length||e.includes(t.name))&&(t.style.display="none")}))}enableButton(...e){this.buttons.forEach((t=>{(0==e.length||e.includes(t.name))&&(t.disabled=!1)}))}disableButton(...e){this.buttons.forEach((t=>{(0==e.length||e.includes(t.name))&&(t.disabled=!0)}))}destroy(){this.modalElement?.remove?.(),this.off?.()}getType(){return"NORMAL"}}Object.assign(u.prototype,c);class h extends u{static instance;static TEMPLATE='\n\t<div class="modal" data-modal="09bcbd7d">\n\t\t<div class="modalWrap">\n\t\t\t<div class="modal_content flex-row align-items-center">\n\t\t\t\t<div class="modalIcon overflow-hidden p-2" data-modal-role="icon-container"></div>\n\t\t\t\t<div class="modalBody" data-modal-role="message"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t';constructor(e){if(h.instance)return h.instance.update(e),h.instance;super(e),h.instance=this}setIcon(e="spinner"){const t=(e=>{switch(e){case"spinner":return'<div class="spinner-border text-primary"></div>';case"grow":return'<div class="spinner-grow text-primary"></div>';case"roller":return'<div class="lds-roller"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>';default:return'<div class="lds-ring"><div></div><div></div><div></div><div></div></div>'}})(e),n=this.modalElement.querySelector("[data-modal-role=icon-container]"),s=o(t);n.appendChild(s)}process(e){return this.asyncFunction=e,this}getType(){return"LOADING"}}const p=((m={add(e){if(!(e instanceof u))throw new Error("Modal 인스턴스만 추가할 수 있습니다.");this.delete(e.getId()),this.modalCollection.add(e),e.on("hide",(()=>{!0===e.autoDestroy&&(e.destroy(),p.delete(e))})),e.on("show",(()=>{"NORMAL"===e.getType()&&this.getAll().forEach((e=>{"LOADING"===e.getType()&&e.hide({action:"SYSTEM",source:"MODAL"})})),e.isExclulsive()&&this.getAll().forEach((e=>{e.hide({action:"SYSTEM",source:"MODAL"})}))}))},delete(e){if(e instanceof u)this.modalCollection.delete(e);else{const t=this.get(e);this.modalCollection.delete(t)}},get(e){return Array.from(this.modalCollection).find((t=>t.id===e))},getAll(){return Array.from(this.modalCollection)},getLoadingModal(){return Array.from(this.modalCollection).find((e=>e instanceof h))},hasExclusive(){return Array.from(this.modalCollection).some((e=>!0===e.isExclulsive()))}}).modalCollection=new Set,document.addEventListener("DOMContentLoaded",(()=>{d("[data-modal]").forEach((e=>{const t=e.dataset.modal;if(!m.get(t)){const t=new u({modalElement:e,autoDestroy:!1});m.add(t)}}))})),m);var m;class g{static Model=u;constructor(e={}){const{exclusive:n=!1,autoHide:s=!0,autoDestroy:i=!0}=e;this.builderContext={},this.builderContext.exclusive=n,this.builderContext.autoHide=s,this.builderContext.autoDestroy=i,this.builderContext.buttons=[];const a=o(g.Model.TEMPLATE);return this.builderContext.modalElement=a,a.dataset.modal=t(8),this}setTitle(e){if(!this.builderContext)throw new Error("속성을 설정하기 전에 'builder' 메서드를 호출해야 합니다.");return this.builderContext.title=e,this}setMessage(e){if(!this.builderContext)throw new Error("속성을 설정하기 전에 'builder' 메서드를 호출해야 합니다.");return this.builderContext.message=e,this}addButton(...e){if(!this.builderContext)throw new Error("속성을 설정하기 전에 'builder' 메서드를 호출해야 합니다.");return this.builderContext.buttons.push(...e.flat()),this}build(){if(!this.builderContext)throw new Error("먼저 'builder' 메서드를 호출한 다음에 'build'를 호출해야 합니다.");const{title:e="",message:t="",buttons:n=[]}=this.builderContext,s=new g.Model(this.builderContext);return s.setTitle(e),s.setMessage(t),s.addButton(n),p.add(s),s}}class f extends g{static Model=h;constructor(e={}){super({exclusive:!1,autoHide:!0,autoRemove:!0});const n=o(f.Model.TEMPLATE);return this.builderContext.modalElement=n,n.dataset.modal=t(8),this}setTitle(){return this}setIcon(e){if(!this.builderContext)throw new Error("속성을 설정하기 전에 'builder' 메서드를 호출해야 합니다.");return this.builderContext.icon=e,this}addButton(){return this}build(){if(!this.builderContext)throw new Error("Must call 'builder' before 'build'");const{message:e="",icon:t="spinner"}=this.builderContext;l("body").appendChild(this.builderContext.modalElement);const n=new f.Model(this.builderContext);return n.setMessage(e),n.setIcon(t),p.add(n),n}}const v={ModalBuilder:{Model:class extends u{setMessage(e){const t=this.modalElement.querySelector("[data-modal-role=message]");if(t.innerHTML="",e){const n=i("div","commonMent");n.innerHTML=e,t.appendChild(n)}return this}}},ModalService:{deleteBuilder:(e={})=>new g(e).setTitle("확인").setMessage("삭제하시겠습니까?").addButton([{label:"아니오",action:"no",color:"silver"},{label:"삭제",action:"yes",color:"red"}]),errorBuilder(e){const{status:t,responseText:n,message:s,detail:i,error:o}=e,a=s||(e=>{switch(e){case 400:return"400 Bad Request";case 401:return"401 Unauthorized";case 403:return"403 Forbidden";case 404:return"404 Not Found";case 409:return"409 Conflict";case 422:return"422 Unprocessable Entity";default:return"잠시 후 다시 시도해주세요"}})(t),r=i||(e=>{switch(e){case 400:return"요청문에 오류가 있거나 서버가 요청을 이해하지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";case 401:return"인증되지 않은 사용자의 요청입니다. 로그인 페이지로 이동합니다.";case 403:return"요청에 대한 권한이 없습니다.";case 404:return"요청한 페이지를 찾을 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";case 409:return"요청한 서비스가 현재 사용 가능하지 않습니다. 다시 시도해 주세요.";case 422:return"요청에 대해 응답할 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";default:return"서버로부터 올바른 응답을 받지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요."}})(t),l=(e=>401===e)(t);return new g({...e,exclusive:l}).setTitle(a).setMessage(r).addButton([{label:"확인",action:"close",color:"silver"}])}}},y={builder:(e={})=>new g(e),infoBuilder:(e={})=>new g(e).setTitle("알림").addButton([{label:"확인",action:"CLOSE",color:"silver"}]),confirmBuilder:(e={})=>new g(e).setTitle("확인").addButton([{label:"아니오",action:"NO",color:"silver"},{label:"예",action:"YES",color:"blue"}]),deleteBuilder:(e={})=>new g(e).setTitle("확인").setMessage("삭제하시겠습니까?").addButton([{label:"아니오",action:"NO",color:"silver"},{label:"삭제",action:"YES",color:"yellow"}]),errorBuilder(e={}){const{status:t,payload:n={}}=e,s=n.message||(e=>{switch(e){case 400:return"400 Bad Request";case 401:return"401 Unauthorized";case 403:return"403 Forbidden";case 404:return"404 Not Found";case 409:return"409 Conflict";case 422:return"422 Unprocessable Entity";default:return"잠시 후 다시 시도해주세요"}})(t),i=n.errors?.pop().message||(e=>{switch(e){case 400:return"요청문에 오류가 있거나 서버가 요청을 이해하지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";case 401:return"인증되지 않은 사용자의 요청입니다. 로그인 페이지로 이동합니다.";case 403:return"요청에 대한 권한이 없습니다.";case 404:return"요청한 페이지를 찾을 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";case 409:return"요청한 서비스가 현재 사용 가능하지 않습니다. 다시 시도해 주세요.";case 422:return"요청에 대해 응답할 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";default:return"서버로부터 올바른 응답을 받지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요."}})(t),o=(e=>401===e)(t);return new g({...e,exclusive:o}).setTitle(s).setMessage(i).addButton([{label:"확인",action:"CLOSE",color:"silver"}])},loadingBuilder:(e={})=>new f(e).setMessage("잠시만 기다려주세요..."),get:e=>p.get(e),getLoadingModal:()=>p.getLoadingModal(),delete(e){e instanceof u&&p.delete(e)},add(e){e instanceof u&&p.add(e)},getModalModel:()=>u},b=y;document.addEventListener("DOMContentLoaded",(()=>{v&&(v.ModalService&&n(y,v.ModalService),v.ModalBuilder&&n(g,v.ModalBuilder),v.Modal&&n(u,v.Modal))}));const w={collection:new Set,add(e){this.collection.add(e)},delete(e){this.collection.delete(e)},get(e){return Array.from(this.collection).find((t=>t.id==e))},getAll(){return this.collection},hasSingleton(){return!!Array.from(this.collection).find((e=>1==e.singleton))}},C=(e,t)=>{if("show"==t){if(w.hasSingleton()&&1!=e.singleton)return;1==e.singleton&&w.getAll().forEach((e=>{e.close()})),w.add(e)}else"hide"==t&&(w.delete(e),1!=e.persistent&&e.remove())},E={promisifyModal(e){const t="string"==typeof e?l(e):e;if(!t)return null;if(1==t.promisify)return t;const n=t.querySelectorAll("[data-modal-btn]");return n.forEach((e=>{e.addEventListener("click",(()=>{t.resolve?.(e.dataset.modalBtn),e.dataset.modalClose&&"manual"==e.dataset.modalClose||t.hide()})),e.setText=t=>(e.innerText=t,e),e.setColor=t=>{switch(t){case"blue":r("$btn","btn-red","btn-white"),a("$btn","btn-blue");break;case"red":r("$btn","btn-blue","btn-white"),a("$btn","btn-red");break;case"white":r("$btn","btn-red","btn-blue"),a("$btn","btn-white")}return e}})),t.getBtn=e=>{const t=Array.from(n).filter((t=>t.dataset.modalBtn==e));return t?.pop()},t.show=e=>(t.style.display="block",t.onshow?.(),t.onswitch?.(t,"show"),e?.(),new Promise(((e,n)=>{t.resolve=e,t.reject=n,t.close=()=>{e("CLOSE"),t.hide()}}))),t.hide=()=>{t.style.display="none",n.forEach((e=>{e.onclick=void 0})),t.onhide?.(),t.onswitch?.(t,"hide")},t.close=t.hide,t.enableBtn=e=>{const n=t.querySelector('[data-modal-btn="'+e+'"]');n&&(n.disabled=!1)},t.disableBtn=e=>{const n=t.querySelector('[data-modal-btn="'+e+'"]');n&&(n.disabled=!0)},t.on=(e,n)=>{switch(e){case"show":t.onshow=n;break;case"hide":t.onhide=n;break;case"switch":t.onswitch=n}return t},t.off=e=>{switch(e){case"show":t.onshow=null;break;case"hide":t.onhide=null;break;case"switch":t.onswitch=null}return t},t.promisify=!0,t},buildTemplate(e){const t=i("div","modal","top-front"),n=i("div","modalWrap");t.appendChild(n);const s=i("div","modal_content");n.appendChild(s);const o=i("div","modalTitle");o.style.display="none",s.appendChild(o),t.getTitleDiv=()=>o;const r=i("div","modalBody","flex-direction-column");r.style.display="none",s.appendChild(r),t.getMsgDiv=()=>r;const l=i("div","modalInfo");l.style.display="none",s.appendChild(l),t.getDetailDiv=()=>l;const d=i("div","modalBtnDiv");return"vertical"==e&&a(d,"flex-direction-column"),s.appendChild(d),t.addBtn=e=>{d.appendChild(e)},t.singleton=!1,t.addBlackout=()=>{t.style.background="rgba(0,0,0,0.5)"},t.removeBlackout=()=>{t.style.background=""},t},buildButton(e){switch(e){case"OK":const t=i("button","btn","btn-md","btn-blue");return t.innerHTML="확 인",t.dataset.modalBtn="OK",t;case"CLOSE":const n=i("button","btn","btn-md","btn-silver");return n.innerHTML="닫 기",n.dataset.modalBtn="CLOSE",n;case"CANCEL":const s=i("button","btn","btn-md","btn-silver");return s.innerHTML="취 소",s.dataset.modalBtn="CANCEL",s;case"DELETE":const o=i("button","btn","btn-md","btn-red");return o.innerHTML="삭 제",o.dataset.modalBtn="DELETE",o;default:const{isPrimary:r,key:l,text:d}=e,c=i("button","btn","btn-md");return a(c,1==r?"btn-blue":"btn-blue-border"),c.innerHTML=d,c.dataset.modalBtn=l,c}},buildModal(e={}){const{btnList:t,direction:n="horizontal",target:s=l("body")}=e,o=this.buildTemplate(n);return t.forEach((e=>o.addBtn(this.buildButton(e)))),o.setTitle=e=>{const t=o.getTitleDiv();t.style.display="",t.innerHTML=e},o.setMsg=e=>{const t=i("div","commonMent");t.innerHTML=e;const n=o.getMsgDiv();n.querySelector(".commonMent")?.remove(),n.style.display="",n.appendChild(t)},o.setDetail=(...e)=>{if(0==e.length)return;const t=i("ul","modalInfo");for(const n of e){const e=i("li");e.innerHTML=n.message?n.message:n,t.appendChild(e)}const n=o.getDetailDiv();n.style.display="",n.appendChild(t)},o.setErrorInfo=(...e)=>{const t=i("ul","modalInfo");for(const n of e){const e=i("li");e.innerHTML=n.message?n.message:n,t.appendChild(e)}o.setDetail(t)},o.persistent=!1,s.appendChild(o),this.promisifyModal(o).on(C)}},D={animations:{doubleBounce:()=>{const e=i("div","sk-double-bounce"),t=i("div","sk-child","sk-double-bounce1"),n=i("div","sk-child","sk-double-bounce2");return e.appendChild(t),e.appendChild(n),e},pulse:()=>i("div","sk-spinner","sk-spinner-pulse"),spinner:()=>{const e=i("div","sk-fading-circle");for(let t=0;t<12;t++){const n=i("div","sk-circle","sk-circle"+(t+1));e.appendChild(n)}return e},foldingCube:()=>{const e=i("div","sk-folding-cube"),t=i("div","sk-cube","sk-cube1"),n=i("div","sk-cube","sk-cube2"),s=i("div","sk-cube","sk-cube3"),o=i("div","sk-cube","sk-cube4");return e.appendChild(t),e.appendChild(n),e.appendChild(o),e.appendChild(s),e}},promisifyModal(e){const t="string"==typeof e?l(e):e;if(!t)return null;if(1==t.promisify)return t;const n=t.querySelectorAll("[data-modal-btn]");return t.show=()=>(a(t,"visible"),r(t,"hidden"),t.onshow?.(),t.onswitch?.(t,"show"),new Promise(((e,s)=>{n.forEach((n=>{n.onclick=()=>{e(n.dataset.modalBtn),t.hide()}})),t.close=()=>{e("CLOSE"),t.hide()}}))),t.hide=()=>{r(t,"visible"),a(t,"hidden"),n.forEach((e=>{e.onclick=void 0})),t.onhide?.(),t.onswitch?.(t,"hide")},t.close=t.hide,t.on=(e,n)=>{switch(e){case"show":t.onshow=n;break;case"hide":t.onhide=n;break;case"switch":t.onswitch=n}return t},t.off=e=>{switch(e){case"show":t.onshow=null;break;case"hide":t.onhide=null;break;case"hide":t.onswitch=null}return t},t.promisify=!0,t},buildTemplate(){const e=i("div","modal","loading-modal","visible"),t=i("div","loading-info-box","m-2");e.appendChild(t);const n=i("div","loading-animation");t.appendChild(n);const s=i("div","loading-text");return t.appendChild(s),e.setAnimation=t=>{const s=this.animations[t]?.();n.appendChild(s),e.animation=s},e.setPosition=t=>{e.style.position=t},e.setText=e=>{s.innerHTML=e},e.setTextColor=e=>{s.style.color=e},e.setAnimationColor=t=>{e.animation.setColor(t)},e.setBackgroundColor=t=>{e.style.backgroundColor=t},e.setBackgroundOpacity=t=>{e.style.opacity=t},e.persistent=!1,e.addBlackout=()=>{e.style.background="rgba(0,0,0,0.5)",r(n,"blackout")},e.removeBlackout=()=>{e.style.background="none",a(n,"blackout")},e},buildLoading(e={}){const{position:t="auto",text:n="",color:s="#fff",opacity:i="0.7",backgroundColor:o="rgb(0,0,0)",animation:a="doubleBounce",target:d=l("body"),blackout:c=!0,isModal:u=!0}=e,h=w.get("loadingModal")?w.get("loadingModal"):this.buildTemplate();return h.setPosition(t),h.setAnimation(a),h.setText(n),h.setTextColor(s),h.setBackgroundColor(o),h.setBackgroundOpacity(i),c?h.addBlackout():h.removeBlackout(),u||r(h,"modal"),d.appendChild(h),this.promisifyModal(h).on("switch",C)}},T={init(){this.target=l("body"),this.persistentMap=new Map,d(".modal").forEach(((e,t)=>{const n=E.promisifyModal(e)?.on("switch",C);if(n){n.persistent=!0;const e=n.id?n.id:"modal"+t;this.persistentMap.set(e,n),n.hide()}}))},persistentModal(e){return this.persistentMap.get(e)},info(e={}){const{id:t="infoModal",title:n="알 림",detail:s,msg:i,singleton:o=!1}=e;console.log("info modal","title",n,"msg",i,"detail",s);const a=E.buildModal({btnList:["OK"]});return a.id=t,a.singleton=o,n&&a.setTitle(n),i&&a.setMsg(i),s&&a.setDetail(...s),a},confirm(e={}){const{id:t="confirmModal",title:n,msg:s,detail:i,delMode:o=!1,singleton:a=!1}=e,r=1==o?["CANCEL","DELETE"]:["CANCEL","OK"],l=E.buildModal({btnList:r});return l.id=t,l.singleton=a,n&&l.setTitle(n),s&&l.setMsg(s),i&&l.setDetail(...i),l},select(e={}){const{id:t="selectModal",title:n,msg:s,select:i=[],singleton:o=!1,direction:a="vertical"}=e;i.push("CLOSE");const r=E.buildModal({btnList:i,direction:a});return r.id=t,r.singleton=o,n&&r.setTitle(n),s&&r.setMsg(s),r},error(e={}){const{id:t="errorModal",singleton:n=!1,response:{status:s,responseText:i,message:o,detail:a,error:r}}=e,l=E.buildModal({btnList:["OK"]});switch(l.id=t,l.singleton=n,s){case 0:l.setTitle("연결 실패"),l.setMsg("서버와의 연결이 끊어졌습니다. 인터넷 연결 상태를 확인하고 다시 시도해주세요."),l.onhide=e=>{location.href="/login"},l.singleton=!0;break;case 500:l.setTitle("500 Internal Server Error"),l.setMsg("서버에서 요청을 처리할 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.");break;case 400:l.setTitle("400 Bad Request"),l.setMsg("요청문에 오류가 있거나 서버가 요청을 이해하지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.");break;case 422:l.setTitle("422 Unprocessable Entity"),l.setMsg("요청에 대해 응답할 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.");break;case 401:l.setTitle("401 Unauthorized"),l.setMsg(i||"인증되지 않은 사용자의 요청입니다. 로그인 페이지로 이동합니다."),l.onhide=e=>{location.href="/login"},l.singleton=!0;break;case 403:l.setTitle("403 Forbidden"),l.setMsg("요청에 대한 권한이 없습니다.");break;case 404:l.setTitle("404 Not Found"),l.setMsg("요청한 페이지를 찾을 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.");break;case 409:l.setTitle("409 Conflict"),l.setMsg("요청한 서비스가 현재 사용 가능하지 않습니다. 다시 시도해 주세요.");break;default:l.setTitle("잠시 후 다시 시도해주세요"),l.setMsg("서버로부터 올바른 응답을 받지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.")}return o&&l.setTitle(o),a&&l.setMsg(a),r&&0!=r.length&&l.setErrorInfo(...r),l},loading(e={}){const{id:t="loadingModal",target:n=this.target}=e;n!==this.target&&(e.blackout=!1,e.isModal=!1);const s=D.buildLoading(e);return s.id=t,s}},M={__proto__:c,init(e={}){const{}=e},promisify:e=>E.promisifyModal(e),info:(e={})=>T.info(e).show(),confirm:(e={})=>T.confirm(e).show(),select:(e={})=>T.select(e).show(),error:(e={})=>T.error(e).show(),startLoading:(e={})=>T.loading(e).show(),endLoading(e={}){w.get("loadingModal")?.hide()},get:e=>T.persistentModal(e),getPopupList:()=>w.getAll(),show:e=>T.persistentModal(e).show(),close(e){const t=w.get(e);t?.close()},closeAll(){w.getAll().forEach((e=>{e.close()}))}};T.init();const S=["success-only","http-errors-only","no-exceptions"];class k{constructor(e={}){const{request:t,param:n,loading:s=!0,debug:i=!0,exception:o=S[1],exceptionModal:a=!0}=e;this.request=t,this.param=n,this.loading=s,this.debug=i,this.exception=o}success(e){return this.successExe=e,this}error(e){return this.errorExe=e,this}finally(e){return this.finallyExe=e,this}async exe(){try{this.loading&&M.startLoading();const e=await this.request(this.param);if(this.loading&&M.endLoading(),this.exception==S[0]&&200!=e.status)throw e;return this.successExe?.(e),e}catch(e){return this.loading&&M.endLoading(),this.debug&&console.log(e),this.exceptionModal&&M.error({response:e}),this.errorExe?.(e),null}finally{this.finallyExe?.()}}}const L=(e={})=>new k(e);function x(e,t,n,s){return new(n||(n=Promise))((function(i,o){function a(e){try{l(s.next(e))}catch(e){o(e)}}function r(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}l((s=s.apply(e,t||[])).next())}))}function N(e,t){var n,s,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(i=2&o[0]?s.return:o[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,o[1])).done)return i;switch(s=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,s=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],s=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}}Object.create,Object.create,new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");var H=new Error("request for lock canceled");const B=function(){function e(e,t){if(void 0===t&&(t=H),this._maxConcurrency=e,this._cancelError=t,this._queue=[],this._waiters=[],e<=0)throw new Error("semaphore must be initialized to a positive value");this._value=e}return e.prototype.acquire=function(){var e=this,t=this.isLocked(),n=new Promise((function(t,n){return e._queue.push({resolve:t,reject:n})}));return t||this._dispatch(),n},e.prototype.runExclusive=function(e){return x(this,void 0,void 0,(function(){var t,n,s;return N(this,(function(i){switch(i.label){case 0:return[4,this.acquire()];case 1:t=i.sent(),n=t[0],s=t[1],i.label=2;case 2:return i.trys.push([2,,4,5]),[4,e(n)];case 3:return[2,i.sent()];case 4:return s(),[7];case 5:return[2]}}))}))},e.prototype.waitForUnlock=function(){return x(this,void 0,void 0,(function(){var e=this;return N(this,(function(t){return this.isLocked()?[2,new Promise((function(t){return e._waiters.push({resolve:t})}))]:[2,Promise.resolve()]}))}))},e.prototype.isLocked=function(){return this._value<=0},e.prototype.release=function(){if(this._maxConcurrency>1)throw new Error("this method is unavailable on semaphores with concurrency > 1; use the scoped release returned by acquire instead");if(this._currentReleaser){var e=this._currentReleaser;this._currentReleaser=void 0,e()}},e.prototype.cancel=function(){var e=this;this._queue.forEach((function(t){return t.reject(e._cancelError)})),this._queue=[]},e.prototype._dispatch=function(){var e=this,t=this._queue.shift();if(t){var n=!1;this._currentReleaser=function(){n||(n=!0,e._value++,e._resolveWaiters(),e._dispatch())},t.resolve([this._value--,this._currentReleaser])}},e.prototype._resolveWaiters=function(){this._waiters.forEach((function(e){return e.resolve()})),this._waiters=[]},e}(),A=document.querySelector("meta[name='_csrf']")?.content,O=document.querySelector("meta[name='_csrf_header']")?.content,P=e=>Object.fromEntries(Object.entries(e).filter((([e,t])=>null!=t))),_=(e,t="GET",n=null,s={},i={})=>{const o=((e,t)=>{const n=new URLSearchParams(P(t)).toString();return n?`${e}?${n}`:e})(e,s),a={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"};A&&O&&!["GET","HEAD","OPTIONS","TRACE"].includes(t.toUpperCase())&&(a[O]=A);const r={method:t,headers:{...a,...i}};return n&&("multipart/form-data"===r.headers["Content-Type"]?(delete r.headers["Content-Type"],r.body=n instanceof FormData?n:new FormData):r.headers["Content-Type"].includes("application/x-www-form-urlencoded")?r.body=n instanceof FormData?n:new URLSearchParams(n).toString():r.body=n&&JSON.stringify(n)),console.log("Request","requestUrl:",o,"data:",n,"Options:",r),fetch(o,r).then((e=>{if(!e.ok)throw e;if("0"===e.headers.get("Content-Length"))return null;const t=e.headers.get("Content-Type");if(!t||!t.includes("application/json"))return e.text();try{return e.json()}catch(e){return null}})).catch((e=>{throw console.error("Fetch error:",e),e}))},Y=(e,t={})=>_(e,"GET",null,P(t),{}),q=(e,{data:t=null,queryParams:n={},headers:s={}}={})=>_(e,"POST",t,P(n),s),R=(e,{data:t=null,queryParams:n={},headers:s={}}={})=>_(e,"PUT",t,P(n),s),F=e=>Y(`/api/ewp/dept/${e}/sub`),I={Get:{deptOne:e=>Y(`/api/ewp/dept/${e}`),subDeptList:F,userList:(e={})=>{const{officeCode:t,deptId:n,deptName:s,userKey:i,userName:o}=e;return Y("/api/ewp/user/list",{officeCode:t,deptId:n,deptName:s,userName:o})},subDeptList:F,userAuthorityForMeeting:e=>Y(`/api/ewp/user/authority/meeting/${e}`),adminAuthorityForMeeting:e=>Y(`/api/ewp/admin/authority/meeting/${e}`),approvalManagerPublicList:(e={})=>{const{officeCode:t,roomType:n}=e;return Y("/api/ewp/public/roster/approval-manager/list",{officeCode:t,roomType:n})}},Post:{switchUserAuthenticationToken:(e={})=>{const{userId:t,loginType:n}=e;return q(`/api/ewp/dev/switch-authentication/user/${t}/loginType/${n}`)}},Put:{},Delete:{}},K={Get:{assignOne:e=>Y(`/api/ewp/meeting/assign/${e}`,{skdKey:e}),assignList:(e={})=>{const{officeCode:t,approvalStatus:n,roomType:s,roomKey:i,title:o,host:a,attendeeName:r,elecYN:l,secretYN:d,startDate:c,endDate:u,pageNo:h,pageCnt:p,orderColumn:m,orderDirection:g="ASC"}=e;return Y("/api/ewp/meeting/assign/list",{officeCode:t,approvalStatus:n,roomType:s,roomKey:i,title:o,host:a,attendeeName:r,elecYN:l,secretYN:d,startDate:c,endDate:u,pageNo:h,pageCnt:p,orderColumn:m,orderDirection:g})},assignListCnt:(e={})=>{const{officeCode:t,approvalStatus:n,roomType:s,roomKey:i,title:o,host:a,attendeeName:r,elecYN:l,secretYN:d,startDate:c,endDate:u,pageNo:h,pageCnt:p}=e;return Y("/api/ewp/meeting/assign/list/cnt",{officeCode:t,approvalStatus:n,roomType:s,roomKey:i,title:o,host:a,attendeeName:r,elecYN:l,secretYN:d,startDate:c,endDate:u,pageNo:h,pageCnt:p})},assignListForPlanned:(e={})=>{const{startDate:t,endDate:n}=e;return Y("/api/ewp/meeting/assign/planned/list",{startDate:t,endDate:n})},assignStatForPlanned:(e={})=>{const{startDate:t,endDate:n}=e;return Y("/api/ewp/meeting/assign/planned/stat",{startDate:t,endDate:n})},assignListForRegister:(e={})=>{const{pageNo:t,pageCnt:n}=e;return Y("/api/ewp/meeting/assign/register/list",{pageNo:t,pageCnt:n})},assignListForDisplay:(e={})=>{const{officeCode:t,roomType:n,roomKey:s,startDate:i,endDate:o}=e;return Y("/api/ewp/meeting/assign/display/list",{officeCode:t,roomType:n,roomKey:s,startDate:i,endDate:o})},assignPublicListForDisplay:(e={})=>{const{officeCode:t,roomType:n,roomKey:s,startDate:i,endDate:o}=e;return Y("/api/ewp/public/meeting/assign/display/list",{officeCode:t,roomType:n,roomKey:s,startDate:i,endDate:o})},userArchiveList:(e={})=>{const{skdHost:t,title:n,originalName:s,roleType:i,startDate:o,endDate:a,pageNo:r,pageCnt:l}=e;return Y("/api/ewp/meeting/archive/manage/user",{skdHost:t,title:n,originalName:s,roleType:i,startDate:o,endDate:a,pageNo:r,pageCnt:l})},deptArchiveList:(e={})=>{const{skdHost:t,title:n,originalName:s,startDate:i,endDate:o,pageNo:a,pageCnt:r}=e;return Y("/api/ewp/meeting/archive/manage/dept",{skdHost:t,title:n,originalName:s,startDate:i,endDate:o,pageNo:a,pageCnt:r})},adminArchiveList:(e={})=>{const{skdHost:t,title:n,originalName:s,startDate:i,endDate:o,pageNo:a,pageCnt:r}=e;return Y("/api/ewp/admin/master/meeting/archive/manage",{skdHost:t,title:n,originalName:s,startDate:i,endDate:o,pageNo:a,pageCnt:r})},userAssignList:(e={})=>{const{approvalStatus:t,meetingStatus:n,roomType:s,title:i,host:o,writerKey:a,attendeeName:r,elecYN:l,secretYN:d,startDate:c,endDate:u,pageNo:h,pageCnt:p,orderColumn:m,orderDirection:g="DESC"}=e;return Y("/api/ewp/meeting/assign/manage/user",{approvalStatus:t,meetingStatus:n,roomType:s,title:i,host:o,writerKey:a,attendeeName:r,elecYN:l,secretYN:d,startDate:c,endDate:u,pageNo:h,pageCnt:p,orderColumn:m,orderDirection:g})},deptAssignList:(e={})=>{const{approvalStatus:t,meetingStatus:n,roomType:s,title:i,host:o,attendeeName:a,elecYN:r,secretYN:l,startDate:d,endDate:c,pageNo:u,pageCnt:h,orderColumn:p,orderDirection:m="DESC"}=e;return Y("/api/ewp/meeting/assign/manage/dept",{approvalStatus:t,meetingStatus:n,roomType:s,title:i,host:o,attendeeName:a,elecYN:r,secretYN:l,startDate:d,endDate:c,pageNo:u,pageCnt:h,orderColumn:p,orderDirection:m})}},Post:{assignApproval:(e={})=>{const{skdKey:t,status:n,comment:s}=e;return q(`/api/ewp/meeting/assign/${t}/approval/${n}`,{queryParams:{comment:s}})},assignOne:(e={})=>{const{roomType:t,formData:n}=e;return q("/api/ewp/meeting/assign/post",{data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}},Put:{assignOne:(e={})=>{const{skdKey:t,formData:n}=e;return R(`/api/ewp/meeting/assign/${t}`,{data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}},Delete:{}};document.addEventListener("DOMContentLoaded",(async()=>{U.init({date}),G.init()}));const U={init(e={}){this.today=moment().format("YYYY-MM-DD");const{date:t=today}=e;moment.locale("ko");const n=async(e,t)=>{if(!this.selectedDate){const t=moment(e);await W.updateDailyStat(t)}this.selectedDate=e,this.setPageDayTitle(),this.setScheduleCard()};$("#datepicker").datepicker({dateFormat:"yy-mm-dd",defaultDate:this.selectedDate,onSelect:n,onChangeMonthYear:async(e,t,n)=>{const s=moment().year(e).month(t).subtract(1,"month");await W.updateDailyStat(s)},beforeShowDay:e=>{let t=W.dailyStat[moment(e).format("YYYY-MM-DD")];return t=null==t?0:t,0==t?[!0,"schedule-none",""]:[!0,"schedule",t+""]}}),n(t)},setPageDayTitle(){const e=document.querySelector("#calendarTit");e.innerHTML="";let t="";t=this.selectedDate!=this.today?moment(this.selectedDate).format("MM월 DD일"):"오늘";const n=i("span","mr-1");n.innerHTML=t+"의 스케줄",e.appendChild(n)},async setScheduleCard(){const e=d("[data-btn=assign]");e.forEach((e=>{e.style.display="none",e.onlick=""})),await W.updateScheduleList(this.selectedDate),"SSO"==loginType&&this.today<=this.selectedDate&&e.forEach((e=>{e.style.display="",e.onclick=()=>{location.href="/ewp/meeting/assign/status/list?holdingDate="+this.selectedDate}}))}},j={generate(e){const t=document.querySelector("#cardBox");if(t.innerHTML="",e&&e.length>0){for(const n of e){const e=this.createRow(n);n.cardElem=e,t.appendChild(e)}V.start(e)}else V.clear()},clear(){document.querySelector("#cardBox").innerHTML=""},loading(e){const t=document.querySelector("#cardBox");for(e=e||1,this.clear();e--;){const e=this.createLoadingRow();t.appendChild(e)}},createLoadingRow:()=>o('<div class="cardDiv placeholder-wave placeholder"><div class="mPropertyDiv"><div class="mDivision placeholder"></div><div class="electDoc placeholder" title="전자회의"></div><div class="myTab placeholder"></div><div class="cancelTab placeholder"></div><div class="regTab placeholder"></div><div class="attend mandatory placeholder"></div><div class="attend option placeholder"></div><div class="attend finishIn placeholder"></div><div class="attend finishNo placeholder"></div><div class="count placeholder"></div></div><div class="timePlaceDiv"><div class="meetTime placeholder"><span></span></div><div class="meetPlace placeholder"></div></div><div class="pubSecDiv placeholder w-20"><span></span></div><div class="meetTit placeholder w-80"></div><div class="meetHost placeholder w-60"><span class="placeholder w-20"></span><span class="placeholder w-20"></span><span class="placeholder w-20"></span></div></div>'),createRow(e){const t=i("div","cardDiv");(()=>{const n=new Set,s=e.roomType;n.add(this.getRoomTypeProp(s));const i=e.appStatus;if("APPROVED"==i?n.add(this.getMeetingStatusProp(e.meetingStatus)):n.add(this.getSkdStatusProp(i)),"Y"==e.secretYN&&n.add("secu"),"Y"==e.elecYN){if(n.add("elec"),e.writerKey==loginKey&&n.add("writer"),e.attendeeList&&0!=e.attendeeList.length){const t=e.attendeeList[0];"HOST"==t.attendRole&&n.add("my"),"END"==e.meetingStatus?"Y"==t.attendYN?n.add("a3"):n.add("a4"):"HOST"==t.attendRole||"ATTENDEE"==t.attendRole?n.add("a1"):n.add("a2")}}else e.writerKey==loginKey&&n.add("my");a(t,...n)})();const n=(()=>{const e=i("div","mPropertyDiv"),n=i("div","mDivision"),s=i("div","electDoc"),o=i("div","myTab"),a=i("div","cancelTab"),r=i("div","regTab"),l=i("div","attend","option"),d=i("div","attend","finishIn"),c=i("div","attend","finishNo"),u=i("div","count");return e.appendChild(n),e.appendChild(s),e.appendChild(a),e.appendChild(r),e.appendChild(o),e.appendChild(l),e.appendChild(d),e.appendChild(c),e.appendChild(u),t.showCount=()=>{u.style.visibility="visible"},t.hideCount=()=>{u.style.visibility="hidden"},t.removeCount=()=>{u.remove()},t.setCount=e=>{u.innerHTML=e},e})();t.appendChild(n);const s=(()=>{const t=i("div","timePlaceDiv"),n=i("div","meetDate"),s=moment(e.holdingDate).format("YYYY.MM.DD");n.innerHTML=s;const o=i("div","meetTime"),a=moment(e.beginDateTime).format("HH:mm");o.innerHTML=a+" ";const r=i("span"),l=moment(e.finishDateTime).format("HH:mm");r.innerHTML="~ "+l,o.appendChild(r);const d=i("div","meetPlace"),c=e.room;return d.innerHTML=c?.officeName+" "+c?.roomName,t.appendChild(n),t.appendChild(o),t.appendChild(d),t})();t.appendChild(s);const o=(()=>{const e=i("div","pubSecDiv"),t=i("span");return e.appendChild(t),e})();t.appendChild(o);const r=(()=>{const t=i("div","meetTit");return t.innerHTML=e.title,t})();t.appendChild(r);const l=(()=>{const t=i("div","meetTit");return t.innerHTML=e.skdHost,t})();return t.appendChild(l),t.onclick=()=>{const{skdKey:t}=e;location.href=`/ewp/meeting/assign/${t}`},t},getRoomTypeProp:e=>"MEETING_ROOM"==e?"mr":"EDU_ROOM"==e?"lr":"HALL"==e?"at":void 0,getSkdStatusProp(e){switch(e){case"REQUEST":return"s0";case"APPROVED":return this.getMeetingStatusProp(assign.meetingStatus);case"CANCELED":return"s4";case"REJECTED":return"s5"}},getMeetingStatusProp(e){switch(e){case"FINISH":case"CLOSING":case"END":return"s3";case"OPENING":case"APPROVED":return"s1";default:return"s2"}},getSecuProp(e){if(1==e)return"secu"}},G={init(){this.setHelpModal(),this.setStatModal()},setHelpModal(){const e=l("#scheduleHelpBtn");e&&(e.onclick=()=>{b.get("guideForSchedule").show()})},setStatModal(){const e=l("#statHelpBtn");e&&(e.onclick=()=>{b.get("guideForStat").show()})}},V={start(e){this.clear(),this.assignSet=new Set(e),this.semaphore=new B(e.length);const t=async e=>{const t=moment();switch(e.appStatus){case"REQUEST":case"CANCELED":case"REJECTED":e.cardElem.removeCount(),this.assignSet.delete(e);break;case"APPROVED":const n=moment(e.beginDateTime).diff(t,"seconds");if(n<0)try{L({request:I.Get.userAuthorityForMeeting,param:e.meetingKey,loading:!1}).success((t=>{t.includes("FUNC_VIEW")?(e.cardElem.setCount(""),a(e.cardElem,"s2")):e.cardElem.onclick=()=>{b.get("guideForAccessDenied").show()}})).finally((()=>{this.assignSet.delete(e)})).exe()}catch(e){console.log(e),this.clear(),b.errorBuilder(e).build().show()}else n<3600?(e.cardElem.showCount(),e.cardElem.setCount(Math.floor(n/60)+1+"분전")):e.cardElem.hideCount()}},n=async()=>{0!=this.assignSet.size?this.assignSet.forEach((async e=>{const[n,s]=await this.semaphore.acquire();await t(e),s()})):this.clear()};n(),this.intervalTask=setInterval(n,1e3)},clear(){this.intervalTask&&(clearInterval(this.intervalTask),this.intervalTask=null)}},W={dailyStat:{},async updateDailyStat(e){return new Promise(((t,n)=>{L({request:K.Get.assignStatForPlanned,param:(e=>({startDate:e.startOf("month").format("YYYY-MM-DD"),endDate:e.endOf("month").format("YYYY-MM-DD")}))(e),exceptionModal:!1,loading:!1}).success((e=>{e.forEach((e=>{this.dailyStat[e.refDate]=e.statValue1}))})).error((e=>{this.dailyStat={}})).finally((()=>{$("#datepicker").datepicker("refresh"),t()})).exe()}))},async updateScheduleList(e){console.log("stat",this.dailyStat[e]),null!=this.dailyStat[e]?(j.loading(this.dailyStat[e]),L({request:K.Get.assignListForPlanned,param:{startDate:e,endDate:e},loading:!1}).success((e=>{j.generate(e)})).finally((()=>{$("#datepicker").datepicker("refresh")})).exe()):j.clear()}}})();