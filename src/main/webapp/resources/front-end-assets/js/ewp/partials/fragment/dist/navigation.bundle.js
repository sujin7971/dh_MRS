(()=>{"use strict";const e=e=>null==e||"object"==typeof e&&0===Object.keys(e).length||!(!Array.isArray(e)||0!==e.length)||"string"==typeof e&&0===e.trim().length,t=(e=16)=>((e<1||e>16)&&(e=16),([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))).substring(0,e)),s=(t,s)=>{if(!e(t)&&!e(s))for(const e in s)(t.hasOwnProperty(e)||t[e])&&Object.assign(t,{[e]:s[e]})},n=document,o=(e,...t)=>{const s=n.createElement(e);return l(s,...t),s},i=e=>{const t=o("div");return t.innerHTML=e.trim(),t.firstChild},l=(t,...s)=>{const n=a(t);for(const t of s)e(t)||n?.classList.add(t);return n},r=(t,...s)=>{const n=a(t);for(const t of s)e(t)||n?.classList.remove(t);return n},a=e=>e instanceof HTMLElement?e:n.querySelector(e),d=e=>e instanceof HTMLElement?e:n.querySelectorAll(e),c={on(e,t){if(this._eventHandlers||(this._eventHandlers={}),"string"==typeof e)this._eventHandlers[e]||(this._eventHandlers[e]=[]),this._eventHandlers[e].push(t);else if("object"==typeof e)for(let t in e){let s=t,n=e[t];this._eventHandlers[s]||(this._eventHandlers[s]=[]),this._eventHandlers[s].push(n)}return this},off(e,t){if(!this._eventHandlers)return;if(!e&&!t)return void(this._eventHandlers={});if(e&&!t)return void delete this._eventHandlers[e];let s=this._eventHandlers?.[e];if(s){let e=s.indexOf(t);-1!==e&&s.splice(e,1)}return this},unbind(...e){this.off(...e)},trigger(e,...t){if(this._eventHandlers?.[e])if("string"==typeof e)this._eventHandlers[e].forEach((e=>e.apply(this,t)));else if("object"==typeof e)for(let t in e){let s=t,n=e[t];this._eventHandlers[s].forEach((e=>e.apply(this,n)))}}};class u{static TEMPLATE='\n\t<div class="modal" data-modal="09bcbd7d">\n\t\t<div class="modalWrap">\n\t\t\t<div class="modal_content">\n\t\t\t\t<div class="modalTitle" data-modal-role="title"></div>\n\t\t\t\t<div class="modalBody" data-modal-role="message"></div>\n\t\t\t\t<div class="modalBtnDiv" data-modal-role="btn-container"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t';constructor(e){const{modalElement:t,exclusive:s=!1,autoHide:n=!0,autoDestroy:o=!0}=e;this.update({modalElement:t,exclusive:s,autoHide:n,autoDestroy:o}),a("body").appendChild(this.modalElement)}update(e){const{modalElement:t=this.modalElement,exclusive:s=this.exclusive,autoHide:n=this.autoHide,autoDestroy:o=this.autoDestroy}=e;this.exclusive=s,this.autoHide=n,this.autoDestroy=o,this.modalElement=t,this.id=t.dataset.modal,this.setButton()}show(){if(!this.resolve)return this.payload=void 0,this.modalElement.style.display="block",this.trigger("show"),new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}async hide(e={}){const{action:t="AUTO",source:s="USER",status:n="SUCESS",payload:o}=e;this.modalElement.style.display="none",this.trigger("hide");const i={action:t,status:n,source:s,timestamp:Date.now(),payload:o};o&&(i.payload=o),this.resolve?.(i),this.resolve=null,this.reject=null}setTitle(e){const t=this.modalElement.querySelector(".modalTitle");return t&&(t.innerHTML=e),this}setMessage(e){const t=this.modalElement.querySelector(".modalBody");return t&&(t.innerHTML=e),this}addButton(e){const t=this.modalElement.querySelector(".modalBtnDiv");if(!t)return this;for(const s of e.flat()){const{label:e="닫기",action:n="close",color:i="blue"}=s,l=["btn","btn-md"];switch(i){case"red":l.push("btn-red");break;case"yellow":l.push("btn-yellow");break;case"blue":l.push("btn-blue");break;default:l.push("btn-silver")}const r=o("button",...l);r.type="button",r.innerText=e,r.dataset.modalAction=n,t.appendChild(r)}return this.setButton(),this}setButton(){const e=this.modalElement.querySelectorAll("[data-modal-action]");this.buttons=e,e.forEach((e=>{const t=e.dataset.modalAction?.toUpperCase()||"NONE",s=e.dataset.modalClose||!0;e.onclick=()=>{this.trigger("action",t,e),!0===this.autoHide&&!0===s&&this.hide({soure:"AUTO",action:t})}}))}isExclulsive(){return this.exclusive}getId(){return this.id}getElement(){return this.modalElement}displayButton(...e){this.buttons.forEach((t=>{(0==e.length||e.includes(t.name))&&(t.style.display="")}))}concealButton(...e){this.buttons.forEach((t=>{(0==e.length||e.includes(t.name))&&(t.style.display="none")}))}enableButton(...e){this.buttons.forEach((t=>{(0==e.length||e.includes(t.name))&&(t.disabled=!1)}))}disableButton(...e){this.buttons.forEach((t=>{(0==e.length||e.includes(t.name))&&(t.disabled=!0)}))}destroy(){this.modalElement?.remove?.(),this.off?.()}getType(){return"NORMAL"}}Object.assign(u.prototype,c);class h extends u{static instance;static TEMPLATE='\n\t<div class="modal" data-modal="09bcbd7d">\n\t\t<div class="modalWrap">\n\t\t\t<div class="modal_content flex-row align-items-center">\n\t\t\t\t<div class="modalIcon overflow-hidden p-2" data-modal-role="icon-container"></div>\n\t\t\t\t<div class="modalBody" data-modal-role="message"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t';constructor(e){if(h.instance)return h.instance.update(e),h.instance;super(e),h.instance=this}setIcon(e="spinner"){const t=(e=>{switch(e){case"spinner":return'<div class="spinner-border text-primary"></div>';case"grow":return'<div class="spinner-grow text-primary"></div>';case"roller":return'<div class="lds-roller"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>';default:return'<div class="lds-ring"><div></div><div></div><div></div><div></div></div>'}})(e),s=this.modalElement.querySelector("[data-modal-role=icon-container]"),n=i(t);s.appendChild(n)}process(e){return this.asyncFunction=e,this}getType(){return"LOADING"}}const m=((v={add(e){if(!(e instanceof u))throw new Error("Modal 인스턴스만 추가할 수 있습니다.");this.delete(e.getId()),this.modalCollection.add(e),e.on("hide",(()=>{!0===e.autoDestroy&&(e.destroy(),m.delete(e))})),e.on("show",(()=>{"NORMAL"===e.getType()&&this.getAll().forEach((e=>{"LOADING"===e.getType()&&e.hide({action:"SYSTEM",source:"MODAL"})})),e.isExclulsive()&&this.getAll().forEach((e=>{e.hide({action:"SYSTEM",source:"MODAL"})}))}))},delete(e){if(e instanceof u)this.modalCollection.delete(e);else{const t=this.get(e);this.modalCollection.delete(t)}},get(e){return Array.from(this.modalCollection).find((t=>t.id===e))},getAll(){return Array.from(this.modalCollection)},getLoadingModal(){return Array.from(this.modalCollection).find((e=>e instanceof h))},hasExclusive(){return Array.from(this.modalCollection).some((e=>!0===e.isExclulsive()))}}).modalCollection=new Set,document.addEventListener("DOMContentLoaded",(()=>{d("[data-modal]").forEach((e=>{const t=e.dataset.modal;if(!v.get(t)){const t=new u({modalElement:e,autoDestroy:!1});v.add(t)}}))})),v);var v;class b{static Model=u;constructor(e={}){const{exclusive:s=!1,autoHide:n=!0,autoDestroy:o=!0}=e;this.builderContext={},this.builderContext.exclusive=s,this.builderContext.autoHide=n,this.builderContext.autoDestroy=o,this.builderContext.buttons=[];const l=i(b.Model.TEMPLATE);return this.builderContext.modalElement=l,l.dataset.modal=t(8),this}setTitle(e){if(!this.builderContext)throw new Error("속성을 설정하기 전에 'builder' 메서드를 호출해야 합니다.");return this.builderContext.title=e,this}setMessage(e){if(!this.builderContext)throw new Error("속성을 설정하기 전에 'builder' 메서드를 호출해야 합니다.");return this.builderContext.message=e,this}addButton(...e){if(!this.builderContext)throw new Error("속성을 설정하기 전에 'builder' 메서드를 호출해야 합니다.");return this.builderContext.buttons.push(...e.flat()),this}build(){if(!this.builderContext)throw new Error("먼저 'builder' 메서드를 호출한 다음에 'build'를 호출해야 합니다.");const{title:e="",message:t="",buttons:s=[]}=this.builderContext,n=new b.Model(this.builderContext);return n.setTitle(e),n.setMessage(t),n.addButton(s),m.add(n),n}}class f extends b{static Model=h;constructor(e={}){super({exclusive:!1,autoHide:!0,autoRemove:!0});const s=i(f.Model.TEMPLATE);return this.builderContext.modalElement=s,s.dataset.modal=t(8),this}setTitle(){return this}setIcon(e){if(!this.builderContext)throw new Error("속성을 설정하기 전에 'builder' 메서드를 호출해야 합니다.");return this.builderContext.icon=e,this}addButton(){return this}build(){if(!this.builderContext)throw new Error("Must call 'builder' before 'build'");const{message:e="",icon:t="spinner"}=this.builderContext;a("body").appendChild(this.builderContext.modalElement);const s=new f.Model(this.builderContext);return s.setMessage(e),s.setIcon(t),m.add(s),s}}const p={ModalBuilder:{Model:class extends u{setMessage(e){const t=this.modalElement.querySelector("[data-modal-role=message]");if(t.innerHTML="",e){const s=o("div","commonMent");s.innerHTML=e,t.appendChild(s)}return this}}},ModalService:{deleteBuilder:(e={})=>new b(e).setTitle("확인").setMessage("삭제하시겠습니까?").addButton([{label:"아니오",action:"no",color:"silver"},{label:"삭제",action:"yes",color:"red"}]),errorBuilder(e){const{status:t,responseText:s,message:n,detail:o,error:i}=e,l=n||(e=>{switch(e){case 400:return"400 Bad Request";case 401:return"401 Unauthorized";case 403:return"403 Forbidden";case 404:return"404 Not Found";case 409:return"409 Conflict";case 422:return"422 Unprocessable Entity";default:return"잠시 후 다시 시도해주세요"}})(t),r=o||(e=>{switch(e){case 400:return"요청문에 오류가 있거나 서버가 요청을 이해하지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";case 401:return"인증되지 않은 사용자의 요청입니다. 로그인 페이지로 이동합니다.";case 403:return"요청에 대한 권한이 없습니다.";case 404:return"요청한 페이지를 찾을 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";case 409:return"요청한 서비스가 현재 사용 가능하지 않습니다. 다시 시도해 주세요.";case 422:return"요청에 대해 응답할 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";default:return"서버로부터 올바른 응답을 받지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요."}})(t),a=(e=>401===e)(t);return new b({...e,exclusive:a}).setTitle(l).setMessage(r).addButton([{label:"확인",action:"close",color:"silver"}])}}},y={builder:(e={})=>new b(e),infoBuilder:(e={})=>new b(e).setTitle("알림").addButton([{label:"확인",action:"CLOSE",color:"silver"}]),confirmBuilder:(e={})=>new b(e).setTitle("확인").addButton([{label:"아니오",action:"NO",color:"silver"},{label:"예",action:"YES",color:"blue"}]),deleteBuilder:(e={})=>new b(e).setTitle("확인").setMessage("삭제하시겠습니까?").addButton([{label:"아니오",action:"NO",color:"silver"},{label:"삭제",action:"YES",color:"yellow"}]),errorBuilder(e={}){const{status:t,payload:s={}}=e,n=s.message||(e=>{switch(e){case 400:return"400 Bad Request";case 401:return"401 Unauthorized";case 403:return"403 Forbidden";case 404:return"404 Not Found";case 409:return"409 Conflict";case 422:return"422 Unprocessable Entity";default:return"잠시 후 다시 시도해주세요"}})(t),o=s.errors?.pop().message||(e=>{switch(e){case 400:return"요청문에 오류가 있거나 서버가 요청을 이해하지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";case 401:return"인증되지 않은 사용자의 요청입니다. 로그인 페이지로 이동합니다.";case 403:return"요청에 대한 권한이 없습니다.";case 404:return"요청한 페이지를 찾을 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";case 409:return"요청한 서비스가 현재 사용 가능하지 않습니다. 다시 시도해 주세요.";case 422:return"요청에 대해 응답할 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";default:return"서버로부터 올바른 응답을 받지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요."}})(t),i=(e=>401===e)(t);return new b({...e,exclusive:i}).setTitle(n).setMessage(o).addButton([{label:"확인",action:"CLOSE",color:"silver"}])},loadingBuilder:(e={})=>new f(e).setMessage("잠시만 기다려주세요..."),get:e=>m.get(e),getLoadingModal:()=>m.getLoadingModal(),delete(e){e instanceof u&&m.delete(e)},add(e){e instanceof u&&m.add(e)},getModalModel:()=>u},g=y;document.addEventListener("DOMContentLoaded",(()=>{p&&(p.ModalService&&s(y,p.ModalService),p.ModalBuilder&&s(b,p.ModalBuilder),p.Modal&&s(u,p.Modal))})),document.addEventListener("DOMContentLoaded",(async()=>{E.init(),w.init()}));const E={init(){this.setUserIcon(),this.setUserImg()},setUserIcon(){const e=d("[data-input=userName]"),t=userRole.includes("ROLE_MASTER_ADMIN")?"adminS":userRole.includes("ROLE_SYSTEM_ADMIN")?"admin":"";e.forEach((e=>{l(e,t)}))},setUserImg(){const e=a("#userPic"),t=o("img","img-profile","my-4");t.src="/api/ewp/user/"+loginKey+"/img",t.onload=()=>{r(e,"userPic"),e.appendChild(t)}}},w={init(){this.setExpand(),this.setDropDown(),this.setUserInfoBtn(),this.setLogoutBtn()},setExpand(){const e=a(".btn-screen.full"),t=a(".btn-screen.win");e&&t&&(e.onclick=()=>{docV.requestFullscreen?docV.requestFullscreen():docV.webkitRequestFullscreen?docV.webkitRequestFullscreen():docV.mozRequestFullScreen?docV.mozRequestFullScreen():docV.msRequestFullscreen&&docV.msRequestFullscreen(),e.style.display="none",t.style.display=""},t.onclick=()=>{document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),e.style.display="",t.style.display="none"})},setDropDown(){const t=a("div.shy-menu");if(t){const s=a(".wrapper"),n=(a(".shy-menu-panel"),()=>{r(t,"is-open"),s.onclick=null}),o=()=>{l(t,"is-open"),s.onclick=()=>{n()}};t.querySelector(".shy-menu-hamburger").onclick=()=>{((t,s)=>{const n=a(t);return!(!n||e(s))&&n.classList.contains(s)})(t,"is-open")?n():o()}}},setUserInfoBtn(){const e=d("[data-btn=userName]"),t=()=>{g.get("profile").show()};e.forEach((e=>{e.onclick=t}))},setLogoutBtn(){const e=a("#logoutBtn");e&&(e.onclick=async()=>{const{action:e}=await g.confirmBuilder().setMessage("로그아웃 하시겠습니까?").build().show();"OK"==e&&(location.href="/logout")})}}})();