(()=>{"use strict";const e=e=>null==e||"object"==typeof e&&0===Object.keys(e).length||!(!Array.isArray(e)||0!==e.length)||"string"==typeof e&&0===e.trim().length,t=(e=16)=>((e<1||e>16)&&(e=16),([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))).substring(0,e)),s=(t,s)=>{if(!e(t)&&!e(s))for(const e in s)(t.hasOwnProperty(e)||t[e])&&Object.assign(t,{[e]:s[e]})},o=document,i=(e,...t)=>{const s=o.createElement(e);return r(s,...t),s},n=e=>{const t=i("div");return t.innerHTML=e.trim(),t.firstChild},r=(t,...s)=>{const o=l(t);for(const t of s)e(t)||o?.classList.add(t);return o},a=(t,...s)=>{const o=l(t);for(const t of s)e(t)||o?.classList.remove(t);return o},l=e=>e instanceof HTMLElement?e:o.querySelector(e),c=e=>e instanceof HTMLElement?e:o.querySelectorAll(e),d={on(e,t){if(this._eventHandlers||(this._eventHandlers={}),"string"==typeof e)this._eventHandlers[e]||(this._eventHandlers[e]=[]),this._eventHandlers[e].push(t);else if("object"==typeof e)for(let t in e){let s=t,o=e[t];this._eventHandlers[s]||(this._eventHandlers[s]=[]),this._eventHandlers[s].push(o)}return this},off(e,t){if(!this._eventHandlers)return;if(!e&&!t)return void(this._eventHandlers={});if(e&&!t)return void delete this._eventHandlers[e];let s=this._eventHandlers?.[e];if(s){let e=s.indexOf(t);-1!==e&&s.splice(e,1)}return this},unbind(...e){this.off(...e)},trigger(e,...t){if(this._eventHandlers?.[e])if("string"==typeof e)this._eventHandlers[e].forEach((e=>e.apply(this,t)));else if("object"==typeof e)for(let t in e){let s=t,o=e[t];this._eventHandlers[s].forEach((e=>e.apply(this,o)))}}},h={collection:new Set,add(e){this.collection.add(e)},delete(e){this.collection.delete(e)},get(e){return Array.from(this.collection).find((t=>t.id==e))},getAll(){return this.collection},hasSingleton(){return!!Array.from(this.collection).find((e=>1==e.singleton))}},u=(e,t)=>{if("show"==t){if(h.hasSingleton()&&1!=e.singleton)return;1==e.singleton&&h.getAll().forEach((e=>{e.close()})),h.add(e)}else"hide"==t&&(h.delete(e),1!=e.persistent&&e.remove())},p={promisifyModal(e){const t="string"==typeof e?l(e):e;if(!t)return null;if(1==t.promisify)return t;const s=t.querySelectorAll("[data-modal-btn]");return s.forEach((e=>{e.addEventListener("click",(()=>{t.resolve?.(e.dataset.modalBtn),e.dataset.modalClose&&"manual"==e.dataset.modalClose||t.hide()})),e.setText=t=>(e.innerText=t,e),e.setColor=t=>{switch(t){case"blue":a("$btn","btn-red","btn-white"),r("$btn","btn-blue");break;case"red":a("$btn","btn-blue","btn-white"),r("$btn","btn-red");break;case"white":a("$btn","btn-red","btn-blue"),r("$btn","btn-white")}return e}})),t.getBtn=e=>{const t=Array.from(s).filter((t=>t.dataset.modalBtn==e));return t?.pop()},t.show=e=>(t.style.display="block",t.onshow?.(),t.onswitch?.(t,"show"),e?.(),new Promise(((e,s)=>{t.resolve=e,t.reject=s,t.close=()=>{e("CLOSE"),t.hide()}}))),t.hide=()=>{t.style.display="none",s.forEach((e=>{e.onclick=void 0})),t.onhide?.(),t.onswitch?.(t,"hide")},t.close=t.hide,t.enableBtn=e=>{const s=t.querySelector('[data-modal-btn="'+e+'"]');s&&(s.disabled=!1)},t.disableBtn=e=>{const s=t.querySelector('[data-modal-btn="'+e+'"]');s&&(s.disabled=!0)},t.on=(e,s)=>{switch(e){case"show":t.onshow=s;break;case"hide":t.onhide=s;break;case"switch":t.onswitch=s}return t},t.off=e=>{switch(e){case"show":t.onshow=null;break;case"hide":t.onhide=null;break;case"switch":t.onswitch=null}return t},t.promisify=!0,t},buildTemplate(e){const t=i("div","modal","top-front"),s=i("div","modalWrap");t.appendChild(s);const o=i("div","modal_content");s.appendChild(o);const n=i("div","modalTitle");n.style.display="none",o.appendChild(n),t.getTitleDiv=()=>n;const a=i("div","modalBody","flex-direction-column");a.style.display="none",o.appendChild(a),t.getMsgDiv=()=>a;const l=i("div","modalInfo");l.style.display="none",o.appendChild(l),t.getDetailDiv=()=>l;const c=i("div","modalBtnDiv");return"vertical"==e&&r(c,"flex-direction-column"),o.appendChild(c),t.addBtn=e=>{c.appendChild(e)},t.singleton=!1,t.addBlackout=()=>{t.style.background="rgba(0,0,0,0.5)"},t.removeBlackout=()=>{t.style.background=""},t},buildButton(e){switch(e){case"OK":const t=i("button","btn","btn-md","btn-blue");return t.innerHTML="확 인",t.dataset.modalBtn="OK",t;case"CLOSE":const s=i("button","btn","btn-md","btn-silver");return s.innerHTML="닫 기",s.dataset.modalBtn="CLOSE",s;case"CANCEL":const o=i("button","btn","btn-md","btn-silver");return o.innerHTML="취 소",o.dataset.modalBtn="CANCEL",o;case"DELETE":const n=i("button","btn","btn-md","btn-red");return n.innerHTML="삭 제",n.dataset.modalBtn="DELETE",n;default:const{isPrimary:a,key:l,text:c}=e,d=i("button","btn","btn-md");return r(d,1==a?"btn-blue":"btn-blue-border"),d.innerHTML=c,d.dataset.modalBtn=l,d}},buildModal(e={}){const{btnList:t,direction:s="horizontal",target:o=l("body")}=e,n=this.buildTemplate(s);return t.forEach((e=>n.addBtn(this.buildButton(e)))),n.setTitle=e=>{const t=n.getTitleDiv();t.style.display="",t.innerHTML=e},n.setMsg=e=>{const t=i("div","commonMent");t.innerHTML=e;const s=n.getMsgDiv();s.querySelector(".commonMent")?.remove(),s.style.display="",s.appendChild(t)},n.setDetail=(...e)=>{if(0==e.length)return;const t=i("ul","modalInfo");for(const s of e){const e=i("li");e.innerHTML=s.message?s.message:s,t.appendChild(e)}const s=n.getDetailDiv();s.style.display="",s.appendChild(t)},n.setErrorInfo=(...e)=>{const t=i("ul","modalInfo");for(const s of e){const e=i("li");e.innerHTML=s.message?s.message:s,t.appendChild(e)}n.setDetail(t)},n.persistent=!1,o.appendChild(n),this.promisifyModal(n).on(u)}},g={animations:{doubleBounce:()=>{const e=i("div","sk-double-bounce"),t=i("div","sk-child","sk-double-bounce1"),s=i("div","sk-child","sk-double-bounce2");return e.appendChild(t),e.appendChild(s),e},pulse:()=>i("div","sk-spinner","sk-spinner-pulse"),spinner:()=>{const e=i("div","sk-fading-circle");for(let t=0;t<12;t++){const s=i("div","sk-circle","sk-circle"+(t+1));e.appendChild(s)}return e},foldingCube:()=>{const e=i("div","sk-folding-cube"),t=i("div","sk-cube","sk-cube1"),s=i("div","sk-cube","sk-cube2"),o=i("div","sk-cube","sk-cube3"),n=i("div","sk-cube","sk-cube4");return e.appendChild(t),e.appendChild(s),e.appendChild(n),e.appendChild(o),e}},promisifyModal(e){const t="string"==typeof e?l(e):e;if(!t)return null;if(1==t.promisify)return t;const s=t.querySelectorAll("[data-modal-btn]");return t.show=()=>(r(t,"visible"),a(t,"hidden"),t.onshow?.(),t.onswitch?.(t,"show"),new Promise(((e,o)=>{s.forEach((s=>{s.onclick=()=>{e(s.dataset.modalBtn),t.hide()}})),t.close=()=>{e("CLOSE"),t.hide()}}))),t.hide=()=>{a(t,"visible"),r(t,"hidden"),s.forEach((e=>{e.onclick=void 0})),t.onhide?.(),t.onswitch?.(t,"hide")},t.close=t.hide,t.on=(e,s)=>{switch(e){case"show":t.onshow=s;break;case"hide":t.onhide=s;break;case"switch":t.onswitch=s}return t},t.off=e=>{switch(e){case"show":t.onshow=null;break;case"hide":t.onhide=null;break;case"hide":t.onswitch=null}return t},t.promisify=!0,t},buildTemplate(){const e=i("div","modal","loading-modal","visible"),t=i("div","loading-info-box","m-2");e.appendChild(t);const s=i("div","loading-animation");t.appendChild(s);const o=i("div","loading-text");return t.appendChild(o),e.setAnimation=t=>{const o=this.animations[t]?.();s.appendChild(o),e.animation=o},e.setPosition=t=>{e.style.position=t},e.setText=e=>{o.innerHTML=e},e.setTextColor=e=>{o.style.color=e},e.setAnimationColor=t=>{e.animation.setColor(t)},e.setBackgroundColor=t=>{e.style.backgroundColor=t},e.setBackgroundOpacity=t=>{e.style.opacity=t},e.persistent=!1,e.addBlackout=()=>{e.style.background="rgba(0,0,0,0.5)",a(s,"blackout")},e.removeBlackout=()=>{e.style.background="none",r(s,"blackout")},e},buildLoading(e={}){const{position:t="auto",text:s="",color:o="#fff",opacity:i="0.7",backgroundColor:n="rgb(0,0,0)",animation:r="doubleBounce",target:c=l("body"),blackout:d=!0,isModal:p=!0}=e,g=h.get("loadingModal")?h.get("loadingModal"):this.buildTemplate();return g.setPosition(t),g.setAnimation(r),g.setText(s),g.setTextColor(o),g.setBackgroundColor(n),g.setBackgroundOpacity(i),d?g.addBlackout():g.removeBlackout(),p||a(g,"modal"),c.appendChild(g),this.promisifyModal(g).on("switch",u)}},f={init(){this.target=l("body"),this.persistentMap=new Map,c(".modal").forEach(((e,t)=>{const s=p.promisifyModal(e)?.on("switch",u);if(s){s.persistent=!0;const e=s.id?s.id:"modal"+t;this.persistentMap.set(e,s),s.hide()}}))},persistentModal(e){return this.persistentMap.get(e)},info(e={}){const{id:t="infoModal",title:s="알 림",detail:o,msg:i,singleton:n=!1}=e;console.log("info modal","title",s,"msg",i,"detail",o);const r=p.buildModal({btnList:["OK"]});return r.id=t,r.singleton=n,s&&r.setTitle(s),i&&r.setMsg(i),o&&r.setDetail(...o),r},confirm(e={}){const{id:t="confirmModal",title:s,msg:o,detail:i,delMode:n=!1,singleton:r=!1}=e,a=1==n?["CANCEL","DELETE"]:["CANCEL","OK"],l=p.buildModal({btnList:a});return l.id=t,l.singleton=r,s&&l.setTitle(s),o&&l.setMsg(o),i&&l.setDetail(...i),l},select(e={}){const{id:t="selectModal",title:s,msg:o,select:i=[],singleton:n=!1,direction:r="vertical"}=e;i.push("CLOSE");const a=p.buildModal({btnList:i,direction:r});return a.id=t,a.singleton=n,s&&a.setTitle(s),o&&a.setMsg(o),a},error(e={}){const{id:t="errorModal",singleton:s=!1,response:{status:o,responseText:i,message:n,detail:r,error:a}}=e,l=p.buildModal({btnList:["OK"]});switch(l.id=t,l.singleton=s,o){case 0:l.setTitle("연결 실패"),l.setMsg("서버와의 연결이 끊어졌습니다. 인터넷 연결 상태를 확인하고 다시 시도해주세요."),l.onhide=e=>{location.href="/login"},l.singleton=!0;break;case 500:l.setTitle("500 Internal Server Error"),l.setMsg("서버에서 요청을 처리할 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.");break;case 400:l.setTitle("400 Bad Request"),l.setMsg("요청문에 오류가 있거나 서버가 요청을 이해하지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.");break;case 422:l.setTitle("422 Unprocessable Entity"),l.setMsg("요청에 대해 응답할 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.");break;case 401:l.setTitle("401 Unauthorized"),l.setMsg(i||"인증되지 않은 사용자의 요청입니다. 로그인 페이지로 이동합니다."),l.onhide=e=>{location.href="/login"},l.singleton=!0;break;case 403:l.setTitle("403 Forbidden"),l.setMsg("요청에 대한 권한이 없습니다.");break;case 404:l.setTitle("404 Not Found"),l.setMsg("요청한 페이지를 찾을 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.");break;case 409:l.setTitle("409 Conflict"),l.setMsg("요청한 서비스가 현재 사용 가능하지 않습니다. 다시 시도해 주세요.");break;default:l.setTitle("잠시 후 다시 시도해주세요"),l.setMsg("서버로부터 올바른 응답을 받지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.")}return n&&l.setTitle(n),r&&l.setMsg(r),a&&0!=a.length&&l.setErrorInfo(...a),l},loading(e={}){const{id:t="loadingModal",target:s=this.target}=e;s!==this.target&&(e.blackout=!1,e.isModal=!1);const o=g.buildLoading(e);return o.id=t,o}},m={__proto__:d,init(e={}){const{}=e},promisify:e=>p.promisifyModal(e),info:(e={})=>f.info(e).show(),confirm:(e={})=>f.confirm(e).show(),select:(e={})=>f.select(e).show(),error:(e={})=>f.error(e).show(),startLoading:(e={})=>f.loading(e).show(),endLoading(e={}){h.get("loadingModal")?.hide()},get:e=>f.persistentModal(e),getPopupList:()=>h.getAll(),show:e=>f.persistentModal(e).show(),close(e){const t=h.get(e);t?.close()},closeAll(){h.getAll().forEach((e=>{e.close()}))}};f.init();const v=["success-only","http-errors-only","no-exceptions"];class y{constructor(e={}){const{request:t,param:s,loading:o=!0,debug:i=!0,exception:n=v[1],exceptionModal:r=!0}=e;this.request=t,this.param=s,this.loading=o,this.debug=i,this.exception=n}success(e){return this.successExe=e,this}error(e){return this.errorExe=e,this}finally(e){return this.finallyExe=e,this}async exe(){try{this.loading&&m.startLoading();const e=await this.request(this.param);if(this.loading&&m.endLoading(),this.exception==v[0]&&200!=e.status)throw e;return this.successExe?.(e),e}catch(e){return this.loading&&m.endLoading(),this.debug&&console.log(e),this.exceptionModal&&m.error({response:e}),this.errorExe?.(e),null}finally{this.finallyExe?.()}}}class b{static TEMPLATE='\n\t<div class="modal" data-modal="09bcbd7d">\n\t\t<div class="modalWrap">\n\t\t\t<div class="modal_content">\n\t\t\t\t<div class="modalTitle" data-modal-role="title"></div>\n\t\t\t\t<div class="modalBody" data-modal-role="message"></div>\n\t\t\t\t<div class="modalBtnDiv" data-modal-role="btn-container"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t';constructor(e){const{modalElement:t,exclusive:s=!1,autoHide:o=!0,autoDestroy:i=!0}=e;this.update({modalElement:t,exclusive:s,autoHide:o,autoDestroy:i}),l("body").appendChild(this.modalElement)}update(e){const{modalElement:t=this.modalElement,exclusive:s=this.exclusive,autoHide:o=this.autoHide,autoDestroy:i=this.autoDestroy}=e;this.exclusive=s,this.autoHide=o,this.autoDestroy=i,this.modalElement=t,this.id=t.dataset.modal,this.setButton()}show(){if(!this.resolve)return this.payload=void 0,this.modalElement.style.display="block",this.trigger("show"),new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}async hide(e={}){const{action:t="AUTO",source:s="USER",status:o="SUCESS",payload:i}=e;this.modalElement.style.display="none",this.trigger("hide");const n={action:t,status:o,source:s,timestamp:Date.now(),payload:i};i&&(n.payload=i),this.resolve?.(n),this.resolve=null,this.reject=null}setTitle(e){const t=this.modalElement.querySelector(".modalTitle");return t&&(t.innerHTML=e),this}setMessage(e){const t=this.modalElement.querySelector(".modalBody");return t&&(t.innerHTML=e),this}addButton(e){const t=this.modalElement.querySelector(".modalBtnDiv");if(!t)return this;for(const s of e.flat()){const{label:e="닫기",action:o="close",color:n="blue"}=s,r=["btn","btn-md"];switch(n){case"red":r.push("btn-red");break;case"yellow":r.push("btn-yellow");break;case"blue":r.push("btn-blue");break;default:r.push("btn-silver")}const a=i("button",...r);a.type="button",a.innerText=e,a.dataset.modalAction=o,t.appendChild(a)}return this.setButton(),this}setButton(){const e=this.modalElement.querySelectorAll("[data-modal-action]");this.buttons=e,e.forEach((e=>{const t=e.dataset.modalAction?.toUpperCase()||"NONE",s=e.dataset.modalClose||!0;e.onclick=()=>{this.trigger("action",t,e),!0===this.autoHide&&!0===s&&this.hide({soure:"AUTO",action:t})}}))}isExclulsive(){return this.exclusive}getId(){return this.id}getElement(){return this.modalElement}displayButton(...e){this.buttons.forEach((t=>{(0==e.length||e.includes(t.name))&&(t.style.display="")}))}concealButton(...e){this.buttons.forEach((t=>{(0==e.length||e.includes(t.name))&&(t.style.display="none")}))}enableButton(...e){this.buttons.forEach((t=>{(0==e.length||e.includes(t.name))&&(t.disabled=!1)}))}disableButton(...e){this.buttons.forEach((t=>{(0==e.length||e.includes(t.name))&&(t.disabled=!0)}))}destroy(){this.modalElement?.remove?.(),this.off?.()}getType(){return"NORMAL"}}Object.assign(b.prototype,d);class w extends b{static instance;static TEMPLATE='\n\t<div class="modal" data-modal="09bcbd7d">\n\t\t<div class="modalWrap">\n\t\t\t<div class="modal_content flex-row align-items-center">\n\t\t\t\t<div class="modalIcon overflow-hidden p-2" data-modal-role="icon-container"></div>\n\t\t\t\t<div class="modalBody" data-modal-role="message"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t';constructor(e){if(w.instance)return w.instance.update(e),w.instance;super(e),w.instance=this}setIcon(e="spinner"){const t=(e=>{switch(e){case"spinner":return'<div class="spinner-border text-primary"></div>';case"grow":return'<div class="spinner-grow text-primary"></div>';case"roller":return'<div class="lds-roller"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>';default:return'<div class="lds-ring"><div></div><div></div><div></div><div></div></div>'}})(e),s=this.modalElement.querySelector("[data-modal-role=icon-container]"),o=n(t);s.appendChild(o)}process(e){return this.asyncFunction=e,this}getType(){return"LOADING"}}const C=((x={add(e){if(!(e instanceof b))throw new Error("Modal 인스턴스만 추가할 수 있습니다.");this.delete(e.getId()),this.modalCollection.add(e),e.on("hide",(()=>{!0===e.autoDestroy&&(e.destroy(),C.delete(e))})),e.on("show",(()=>{"NORMAL"===e.getType()&&this.getAll().forEach((e=>{"LOADING"===e.getType()&&e.hide({action:"SYSTEM",source:"MODAL"})})),e.isExclulsive()&&this.getAll().forEach((e=>{e.hide({action:"SYSTEM",source:"MODAL"})}))}))},delete(e){if(e instanceof b)this.modalCollection.delete(e);else{const t=this.get(e);this.modalCollection.delete(t)}},get(e){return Array.from(this.modalCollection).find((t=>t.id===e))},getAll(){return Array.from(this.modalCollection)},getLoadingModal(){return Array.from(this.modalCollection).find((e=>e instanceof w))},hasExclusive(){return Array.from(this.modalCollection).some((e=>!0===e.isExclulsive()))}}).modalCollection=new Set,document.addEventListener("DOMContentLoaded",(()=>{c("[data-modal]").forEach((e=>{const t=e.dataset.modal;if(!x.get(t)){const t=new b({modalElement:e,autoDestroy:!1});x.add(t)}}))})),x);var x;class E{static Model=b;constructor(e={}){const{exclusive:s=!1,autoHide:o=!0,autoDestroy:i=!0}=e;this.builderContext={},this.builderContext.exclusive=s,this.builderContext.autoHide=o,this.builderContext.autoDestroy=i,this.builderContext.buttons=[];const r=n(E.Model.TEMPLATE);return this.builderContext.modalElement=r,r.dataset.modal=t(8),this}setTitle(e){if(!this.builderContext)throw new Error("속성을 설정하기 전에 'builder' 메서드를 호출해야 합니다.");return this.builderContext.title=e,this}setMessage(e){if(!this.builderContext)throw new Error("속성을 설정하기 전에 'builder' 메서드를 호출해야 합니다.");return this.builderContext.message=e,this}addButton(...e){if(!this.builderContext)throw new Error("속성을 설정하기 전에 'builder' 메서드를 호출해야 합니다.");return this.builderContext.buttons.push(...e.flat()),this}build(){if(!this.builderContext)throw new Error("먼저 'builder' 메서드를 호출한 다음에 'build'를 호출해야 합니다.");const{title:e="",message:t="",buttons:s=[]}=this.builderContext,o=new E.Model(this.builderContext);return o.setTitle(e),o.setMessage(t),o.addButton(s),C.add(o),o}}class S extends E{static Model=w;constructor(e={}){super({exclusive:!1,autoHide:!0,autoRemove:!0});const s=n(S.Model.TEMPLATE);return this.builderContext.modalElement=s,s.dataset.modal=t(8),this}setTitle(){return this}setIcon(e){if(!this.builderContext)throw new Error("속성을 설정하기 전에 'builder' 메서드를 호출해야 합니다.");return this.builderContext.icon=e,this}addButton(){return this}build(){if(!this.builderContext)throw new Error("Must call 'builder' before 'build'");const{message:e="",icon:t="spinner"}=this.builderContext;l("body").appendChild(this.builderContext.modalElement);const s=new S.Model(this.builderContext);return s.setMessage(e),s.setIcon(t),C.add(s),s}}const k={ModalBuilder:{Model:class extends b{setMessage(e){const t=this.modalElement.querySelector("[data-modal-role=message]");if(t.innerHTML="",e){const s=i("div","commonMent");s.innerHTML=e,t.appendChild(s)}return this}}},ModalService:{deleteBuilder:(e={})=>new E(e).setTitle("확인").setMessage("삭제하시겠습니까?").addButton([{label:"아니오",action:"no",color:"silver"},{label:"삭제",action:"yes",color:"red"}]),errorBuilder(e){const{status:t,responseText:s,message:o,detail:i,error:n}=e,r=o||(e=>{switch(e){case 400:return"400 Bad Request";case 401:return"401 Unauthorized";case 403:return"403 Forbidden";case 404:return"404 Not Found";case 409:return"409 Conflict";case 422:return"422 Unprocessable Entity";default:return"잠시 후 다시 시도해주세요"}})(t),a=i||(e=>{switch(e){case 400:return"요청문에 오류가 있거나 서버가 요청을 이해하지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";case 401:return"인증되지 않은 사용자의 요청입니다. 로그인 페이지로 이동합니다.";case 403:return"요청에 대한 권한이 없습니다.";case 404:return"요청한 페이지를 찾을 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";case 409:return"요청한 서비스가 현재 사용 가능하지 않습니다. 다시 시도해 주세요.";case 422:return"요청에 대해 응답할 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";default:return"서버로부터 올바른 응답을 받지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요."}})(t),l=(e=>401===e)(t);return new E({...e,exclusive:l}).setTitle(r).setMessage(a).addButton([{label:"확인",action:"close",color:"silver"}])}}},T={builder:(e={})=>new E(e),infoBuilder:(e={})=>new E(e).setTitle("알림").addButton([{label:"확인",action:"CLOSE",color:"silver"}]),confirmBuilder:(e={})=>new E(e).setTitle("확인").addButton([{label:"아니오",action:"NO",color:"silver"},{label:"예",action:"YES",color:"blue"}]),deleteBuilder:(e={})=>new E(e).setTitle("확인").setMessage("삭제하시겠습니까?").addButton([{label:"아니오",action:"NO",color:"silver"},{label:"삭제",action:"YES",color:"yellow"}]),errorBuilder(e={}){const{status:t,payload:s={}}=e,o=s.message||(e=>{switch(e){case 400:return"400 Bad Request";case 401:return"401 Unauthorized";case 403:return"403 Forbidden";case 404:return"404 Not Found";case 409:return"409 Conflict";case 422:return"422 Unprocessable Entity";default:return"잠시 후 다시 시도해주세요"}})(t),i=s.errors?.pop().message||(e=>{switch(e){case 400:return"요청문에 오류가 있거나 서버가 요청을 이해하지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";case 401:return"인증되지 않은 사용자의 요청입니다. 로그인 페이지로 이동합니다.";case 403:return"요청에 대한 권한이 없습니다.";case 404:return"요청한 페이지를 찾을 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";case 409:return"요청한 서비스가 현재 사용 가능하지 않습니다. 다시 시도해 주세요.";case 422:return"요청에 대해 응답할 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.";default:return"서버로부터 올바른 응답을 받지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요."}})(t),n=(e=>401===e)(t);return new E({...e,exclusive:n}).setTitle(o).setMessage(i).addButton([{label:"확인",action:"CLOSE",color:"silver"}])},loadingBuilder:(e={})=>new S(e).setMessage("잠시만 기다려주세요..."),get:e=>C.get(e),getLoadingModal:()=>C.getLoadingModal(),delete(e){e instanceof b&&C.delete(e)},add(e){e instanceof b&&C.add(e)},getModalModel:()=>b},N=T;function D(e,t,s,o){return new(s||(s=Promise))((function(i,n){function r(e){try{l(o.next(e))}catch(e){n(e)}}function a(e){try{l(o.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))}function P(e,t){var s,o,i,n,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(s)throw new TypeError("Generator is already executing.");for(;r;)try{if(s=1,o&&(i=2&n[0]?o.return:n[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,o=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){r=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){r.label=n[1];break}if(6===n[0]&&r.label<i[1]){r.label=i[1],i=n;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(n);break}i[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(e){n=[6,e],o=0}finally{s=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}document.addEventListener("DOMContentLoaded",(()=>{k&&(k.ModalService&&s(T,k.ModalService),k.ModalBuilder&&s(E,k.ModalBuilder),k.Modal&&s(b,k.Modal))})),Object.create,Object.create,new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");var M=new Error("request for lock canceled");const _=function(){function e(e,t){if(void 0===t&&(t=M),this._maxConcurrency=e,this._cancelError=t,this._queue=[],this._waiters=[],e<=0)throw new Error("semaphore must be initialized to a positive value");this._value=e}return e.prototype.acquire=function(){var e=this,t=this.isLocked(),s=new Promise((function(t,s){return e._queue.push({resolve:t,reject:s})}));return t||this._dispatch(),s},e.prototype.runExclusive=function(e){return D(this,void 0,void 0,(function(){var t,s,o;return P(this,(function(i){switch(i.label){case 0:return[4,this.acquire()];case 1:t=i.sent(),s=t[0],o=t[1],i.label=2;case 2:return i.trys.push([2,,4,5]),[4,e(s)];case 3:return[2,i.sent()];case 4:return o(),[7];case 5:return[2]}}))}))},e.prototype.waitForUnlock=function(){return D(this,void 0,void 0,(function(){var e=this;return P(this,(function(t){return this.isLocked()?[2,new Promise((function(t){return e._waiters.push({resolve:t})}))]:[2,Promise.resolve()]}))}))},e.prototype.isLocked=function(){return this._value<=0},e.prototype.release=function(){if(this._maxConcurrency>1)throw new Error("this method is unavailable on semaphores with concurrency > 1; use the scoped release returned by acquire instead");if(this._currentReleaser){var e=this._currentReleaser;this._currentReleaser=void 0,e()}},e.prototype.cancel=function(){var e=this;this._queue.forEach((function(t){return t.reject(e._cancelError)})),this._queue=[]},e.prototype._dispatch=function(){var e=this,t=this._queue.shift();if(t){var s=!1;this._currentReleaser=function(){s||(s=!0,e._value++,e._resolveWaiters(),e._dispatch())},t.resolve([this._value--,this._currentReleaser])}},e.prototype._resolveWaiters=function(){this._waiters.forEach((function(e){return e.resolve()})),this._waiters=[]},e}(),O=function(){function e(e){this._semaphore=new _(1,e)}return e.prototype.acquire=function(){return D(this,void 0,void 0,(function(){return P(this,(function(e){switch(e.label){case 0:return[4,this._semaphore.acquire()];case 1:return[2,e.sent()[1]]}}))}))},e.prototype.runExclusive=function(e){return this._semaphore.runExclusive((function(){return e()}))},e.prototype.isLocked=function(){return this._semaphore.isLocked()},e.prototype.waitForUnlock=function(){return this._semaphore.waitForUnlock()},e.prototype.release=function(){this._semaphore.release()},e.prototype.cancel=function(){return this._semaphore.cancel()},e}(),L={on(e,t){this._eventHandlers||(this._eventHandlers={}),this._eventHandlers[e]||(this._eventHandlers[e]=[]),this._eventHandlers[e].push(t)},off(e,t){let s=this._eventHandlers?.[e];if(s)for(let e=0;e<s.length;e++)s[e]===t&&s.splice(e--,1)},trigger(e,...t){this._eventHandlers?.[e]&&this._eventHandlers[e].forEach((e=>e.apply(this,t)))}};class A{constructor(e={}){const{instance:t=null,width:s=300,height:o=150,image:i=null,color:n="white",scale:r=1}=e;this.instance=t,this.nowWidth=s,this.nowHeight=o,this.scale=r,this.resizeScreen({width:s,height:o}),this.deployScreenSizeObserver(),this.setBackgroundColor(n),this.transformScale()}deployScreenSizeObserver(){new ResizeObserver(((e,t)=>{this.fitOrientation?this.fitOrientation():this.transformScale()})).observe(this.instance.sectionNode)}resizeScreen(e={}){const{width:t=300,height:s=150}=e;this.width=t,this.height=s;const o=this.instance.svgNode;o.setAttribute("width",t),o.setAttribute("height",s);const i=this.instance.screenNode;i.style.width=t+"px",i.style.height=s+"px"}fitScreenToWindow(){this.width>this.height?this.fitHorizontalOrientation():this.fitVerticalOrientation()}fitVerticalOrientation(){this.fitOrientation=this.fitVerticalOrientation;const e=(this.instance.sectionNode.offsetHeight-6)/this.height;this.transformScale({scale:e})}fitHorizontalOrientation(){this.fitOrientation=this.fitHorizontalOrientation;const e=(this.instance.sectionNode.offsetWidth-6)/this.width;this.transformScale({scale:e})}zoomin(e){e||(e=.05);const t=this.scale;this.changeScale(t+e)}zoomout(e){e||(e=.05);const t=this.scale;this.changeScale(t-e)}changeScale(e){delete this.fitOrientation;let t=Number(e)?e:this.scale;t>4?t=4:t<.3&&(t=.3),this.transformScale({scale:t})}transformScale(e={}){const{scale:t=this.scale}=e;this.scale!=t&&this.trigger("transformScale",t),this.scale=t;const s=this.instance,o=s.sectionNode,i=s.screenNode,n=s.containerNode;i.style.width=this.width*t+"px",i.style.height=this.height*t+"px";const r=o.offsetHeight-i.offsetHeight;i.style.marginTop=r>0?r/2+"px":0,n.style.transform="scale("+t+")",n.setAttribute("scale",t)}setBackgroundImage(e){const t=this,s=t.instance.svgNode;return new Promise((function(o,i){const n=new Image;n.onload=function(){s.style.background="url("+n.src+")",s.style.backgroundRepeat="no-repeat",s.style.backgroundSize="cover",s.setAttribute("width",n.width),s.setAttribute("height",n.height),t.width=n.width,t.height=n.height,t.image=n,t.transformScale(),o()},n.onerror=function(e){i(e)},n.src=e}))}getBackgroundImage(){return this.image}setBackgroundColor(e={}){const{color:t="#ffffff",opacity:s=1}=e;this.instance.svgNode.style.backgroundColor=t,this.instance.svgNode.style.background="none"}switchCtrlmode(e){const t=this.instance.svgNode;0!=this.instance.options.selectable&&(e?(t.classList.add("ctrl-mode"),t.setAttribute("pointer-events","visiblePainted")):(t.classList.remove("ctrl-mode"),t.setAttribute("pointer-events","none")))}switchErasermode(e){const t=this.instance.svgNode,s=t.getDeployNode(2);t.classList.remove("ctrl-mode"),e?(t.setAttribute("pointer-events","visiblePainted"),t.querySelectorAll("polyline").forEach((e=>e.setAttribute("pointer-events","visiblePainted"))),s.style.pointerEvents="none"):(s.style.pointerEvents="",t.setAttribute("pointer-events","none"),t.querySelectorAll("polyline").forEach((e=>e.setAttribute("pointer-events","none"))))}}Object.assign(A.prototype,L);class H{constructor(e={}){const{type:t,posX:s=0,posY:o=0,width:i=0,height:n=0,stroke:r="#000000",strokeOpacity:a=1,strokeWidth:l=2,strokeDasharray:c=null,strokeLinejoin:d="round",strokeLinecap:h="round",fill:u="none",fillOpacity:p=0,level:g=1}=e;this.type=t,this.posX=s,this.posY=o,this.width=i,this.height=n,this.stroke=r,this.strokeOpacity=a,this.strokeWidth=l,this.strokeDasharray=c,this.strokeLinejoin=d,this.strokeLinecap=h,this.fill=u,this.fillOpacity=p,this.level=g}update(e={}){const{type:t=this.type,posX:s=this.posX,posY:o=this.posY,width:i=this.width,height:n=this.height,stroke:r=this.stroke,strokeOpacity:a=this.strokeOpacity,strokeWidth:l=this.strokeWidth,strokeDasharray:c=this.strokeDasharray,fill:d=this.fill,fillOpacity:h=this.fillOpacity,level:u=this.level}=e;this.type=t,this.posX=s,this.posY=o,this.width=i,this.height=n,this.stroke=r,this.strokeOpacity=a,this.strokeWidth=l,this.strokeDasharray=c,this.level=u,this.trigger("update")}getDependencyAttribute(){return{type:this.type}}getStyleAttribute(){return{stroke:this.stroke,"stroke-opacity":this.strokeOpacity,"stroke-width":this.strokeWidth,"stroke-dasharray":this.strokeDasharray,"stroke-linejoin":this.strokeLinejoin,"stroke-linecap":this.strokeLinecap,fill:this.fill,"fill-opacity":this.fillOpacity}}getCoordinateAttribute(){return{posX:this.posX,posY:this.posY,width:this.width,height:this.height}}getProperties(){return{type:this.type,...this.getCoordinateAttribute(),stroke:this.stroke,strokeOpacity:this.strokeOpacity,strokeWidth:this.strokeWidth,strokeDasharray:this.strokeDasharray,strokeLinejoin:this.strokeLinejoin,strokeLinecap:this.strokeLinecap,fill:this.fill,fillOpacity:this.fillOpacity}}setStroke(e){this.stroke=e}setStrokeWidth(e){this.strokeWidth=e}setStrokeOpacity(e){this.strokeOpacity=e}setStrokeDasharray(e){this.strokeDasharray=e}setFill(e){this.fill=e}setFillOpacity(e){this.fillOpacity=e}getLevel(){return this.level}}class z extends H{constructor(e={}){super(e);const{startPos:t=[0,0],endPos:s=[0,0]}=e;this.startPos=t,this.endPos=s}update(e={}){super.update(e);const{startPos:t=this.startPos,endPos:s=this.endPos}=e;this.startPos=t,this.endPos=s}getStyleAttribute(){return{stroke:this.stroke,"stroke-opacity":this.strokeOpacity,"stroke-width":this.strokeWidth,"stroke-dasharray":this.strokeDasharray,fill:this.fill,"fill-opacity":this.fillOpacity}}getCoordinateAttribute(){return{...super.getCoordinateAttribute(),startPos:this.startPos,endPos:this.endPos,pointGroup:[this.startPos,this.endPos]}}}class B extends z{constructor(e={}){super({...e,type:"textarea"});const{text:t="",color:s="#000000",fontSize:o=28,fontFamily:i="sans-serif"}=e;this.text=t,this.color=s,this.fontSize=o,this.fontFamily=i}update(e={}){super.update(e);const{text:t=this.text,color:s=this.color,fontSize:o=this.fontSize,fontFamily:i=this.fontFamily}=e;this.text=t,this.color=s,this.fontSize=o,this.fontFamily=i}getFontAttribute(){return{color:this.color,"font-size":this.fontSize,"font-family":this.fontFamily}}getText(){return this.text}setText(e){this.text=e}setFontColor(e){this.color=e}setFontSize(e){this.fontSize=e}setFontFamily(e){this.fontFamily=e}toObject(){return{...super.getProperties(),text:this.text,color:this.color,fontSize:this.fontSize,fontFamily:this.fontFamily}}static builder(e={}){return new Path(e)}}Object.assign(B.prototype,L);class Y{constructor(e={}){const{id:t=null,shape:s=null,packedElem:o=null,selected:i=!1,visible:n=!0,level:r=1}=e;this.id=t,this.shape=s,this.packedElem=o,this.selected=i,this.visible=n,this.level=r}select(){this.selected=!0}deselect(){this.selected=!1}isSelected(){return this.selected}show(){this.packedElem.removeAttribute("visibility"),this.visible=!0}hide(){this.packedElem.setAttribute("visibility","hidden"),this.visible=!1}isVisible(){return this.visible}setLevel(e){this.level=e}getLevel(){return this.level}destroy(){delete this.shape,this.packedElem?.remove(),delete this.packedElem}getShape(){return this.shape}getPackedElem(){return this.packedElem}getCoordElem(){return this.packedElem.coordNode}getGraphicElem(){return this.packedElem.graphicNode}getForeignElem(){return this.packedElem.foreignNode}getEditTool(){this.shape}toContext(){return{id:this.id,level:this.level,shape:this.shape.toObject()}}}const I={createElementNS:function(e,t){return F(e,t)},setElementAttributes:function(e,t){U(e,t)},createSVG:function(e,t){const s=F("g",{id:e,role:"container"}),o=F("svg",{role:"coordinator",preserveAspectRatio:"none",overflow:"visible"});s.appendChild(o),s.coordNode=o;const i=t.type;let n;switch(i){case"path":case"line":case"polyline":case"rect":n=G(i);break;case"textarea":{n=G("rect");const e=G(i);s.foreignNode=e,o.appendChild(e)}}return s.graphicNode=n,o.appendChild(n),this.updateSVG(t,s),s},updateSVG:function(e,t){const s=t,o=s.coordNode,i=s.graphicNode,n=s.foreignNode;U(i,e.getStyleAttribute());const r=e.getCoordinateAttribute();switch(e.type){case"line":{const e=X([r.startPos,r.endPos]),t=e.maxX-e.minX,s=e.maxY-e.minY;U(o,{x:r.posX+e.minX,y:r.posY+e.minY}),U(i,{x1:0,y1:0,x2:t,y2:s})}break;case"rect":{const e=X([r.startPos,r.endPos]),t=e.maxX-e.minX,s=e.maxY-e.minY;U(o,{x:r.posX+e.minX,y:r.posY+e.minY}),U(i,{x:0,y:0,width:t,height:s})}break;case"textarea":{const t=X([r.startPos,r.endPos]),s=t.maxX-t.minX,a=t.maxY-t.minY;U(o,{x:r.posX+t.minX,y:r.posY+t.minY}),U(i,{x:0,y:0,width:s,height:a});const l=e.getFontAttribute();U(n,{x:0,y:0,width:s,height:a});const c=n.textareaElem;c.style.color=l.color,c.style.fontSize=l["font-size"]+"px",c.style.fontFamily=l["font-family"];const d=e.getText();c.value=d}break;case"path":{const e=function(e){const t=e.concat(),s=X(j(t));return{...s,pointGroupList:t.map((e=>e.map((e=>[e[0]-s.minX,e[1]-s.minY]))))}}(r.pointGroup),t=e.maxX-e.minX,s=e.maxY-e.minY,n=function(e){let t="";for(const s of e)t+=q(s);return t}(e.pointGroupList);U(o,{x:r.posX+e.minX,y:r.posY+e.minY,width:r.width?r.width:t,height:r.height?r.height:s,viewBox:"0 0 "+t+" "+s}),U(i,{x:0,y:0,d:n})}break;case"polyline":U(i,{x:0,y:0,points:function(e){let t=e[0][0]+","+e[0][1]+" ";for(let s=1;s<e.length;s++){let o=e[s];t+=o[0]+","+o[1]+" "}return t}(r.pointGroup)})}}};function j(e,t=1){return t>0?e.reduce(((e,s)=>e.concat(Array.isArray(s)?j(s,t-1):s)),[]):e.slice()}function X(e){if(0==e.length)return{minX:0,maxX:0,minY:0,maxY:0};let t=e[0][0],s=e[0][0],o=e[0][1],i=e[0][1];return e.length<2?{minX:t,maxX:t,minY:o,maxY:o}:(e.forEach((e=>{const n=e[0],r=e[1];t=t>n?n:t,s=s<n?n:s,o=o>r?r:o,i=i<r?r:i})),{minX:t,maxX:s,minY:o,maxY:i})}function q(e){let t=e[0],s="M"+t+" ";1==e.length&&e.push(e[0]);for(let n=1;n<e.length;n++){const r=e[n];s+="Q"+(o=t,i=r,[(Number(o[0])+Number(i[0]))/2,(Number(o[1])+Number(i[1]))/2]+" "),s+=r,t=r}var o,i;return s}function F(e,t){const s=document.createElementNS("http://www.w3.org/2000/svg",e);return U(s,t),s}function U(e,t){if(null!=t)for(let s in t){const o=t[s];0==o||null!=o&&null!=o&&""!=o?e.setAttribute(s,o):e.removeAttribute(s)}}function G(e,t){switch(e){case"line":case"path":case"polyline":case"rect":return F(e,t);case"textarea":{const e=F("foreignObject"),t=document.createElement("textarea");return t.style.cssText="width: 100%;height: 100%;background: transparent;fill: none;border: none;resize: none;overflow: hidden;",e.textareaElem=t,t.getContainer=function(){return e.getContainer()},e.appendChild(t),e}}}const R=function(e={}){const{id:t=null,shape:s=null,level:o=1}=e,i=I.createSVG(t,s),n=new Y({id:t,shape:s,packedElem:i,level:o});return s.on("update",(function(){setTimeout((()=>I.updateSVG(s,i)))})),n};class K extends H{constructor(e={}){super(e);const{pointGroup:t=[[[0,0]]]}=e;this.pointGroup=t}update(e={}){super.update(e);const{pointGroup:t=this.pointGroup}=e;this.pointGroup=t}getCoordinateAttribute(){return{...super.getCoordinateAttribute(),pointGroup:this.pointGroup}}getProperties(){return{...super.getProperties(),pointGroup:this.pointGroup}}}class W extends K{constructor(e={}){super({...e,type:"path"});const{}=e}update(e={}){super.update(e)}toObject(){return super.getProperties()}}Object.assign(W.prototype,L);class V extends K{constructor(e={}){super({...e,type:"polyline"});const{}=e}update(e={}){super.update(e)}toObject(){return super.getProperties()}}Object.assign(V.prototype,L);class J extends z{constructor(e={}){super({...e,type:"line"})}update(e={}){super.update(e)}toObject(){return super.getProperties()}}Object.assign(J.prototype,L);class Q extends z{constructor(e={}){super({...e,type:"rect"})}update(e={}){super.update(e)}getFontAttribute(){return{color:this.color,"font-size":this.fontSize,"font-family":this.fontFamily}}toObject(){return super.getProperties()}}Object.assign(Q.prototype,L);class Z{constructor(e={}){const{instance:t=null}=e;this.instance=t,this.empty()}empty(){this.instance.svgNode.clearGraphic(),this._display?.map((e=>e.destroy())),this._display=[],this._garbage?.map((e=>e.destroy())),this._garbage=[]}isEmpty(){return 0==this._display.length}createShapeModel(e,t){let s;switch(e){case"line":s=new J(t);break;case"rectangle":s=new Q(t);break;case"textarea":s=new B(t);break;case"path":s=new W(t);break;case"polyline":s=new V(t)}return s}createUpdateModel(e,t={}){return{id:e,action:"U",shape:{...t}}}createDeleteModel(e){return{id:e,action:"D"}}create(e){return R(e)}insert(e){return this.get(e.id)||(this._display.push(e),this.instance.svgNode.querySelector("#"+e.id)?.remove(),this.instance.svgNode.addGraphic({element:e.getPackedElem(),level:e.getLevel()})),e}load(e){const t={...e};switch(t.action){case"N":{t.shape=this.createShapeModel(t.shape.type,t.shape);const e=R(t);this.insert(e)}break;case"U":{const e=this.get(t.id);e?.shape?.update(t.shape)}break;case"D":this.remove(t.id)}}remove(e){const t=this.get(e);return t&&(this._display=this._display.filter((t=>t.id!==e)),this._garbage.push(t),t.hide()),t}runGarbageCollector(){const e=this._display.filter((e=>!e.isVisible()||!e.packedElem));this._garbage=this._garbage.concat(e),this._garbage.forEach((e=>e.destroy())),this._garbage=[]}get(e){return this._display.find((t=>t.id==e))}getAll(){return this._display}select(e){this._display.forEach((e=>e.deselect()));const t=this.get(e);return t?.select(),t}getSelected(){return this._display.find((e=>e.isSelected()))}restore(e){this.empty();const t=JSON.parse(e);t.forEach((e=>{e.shape=this.createShapeModel(e.shape.type,e.shape)})),t.forEach((e=>{const t=this.create(e);this.insert(t)}))}}Object.assign(Z.prototype,L);class ee{constructor(e){this.empty(),this._service=e}empty(){this._undoStack=[],this._redoStack=[]}dump(){this._dump=te(this._service._display)}take(){let e=this._dump;e||(e=te(this._service._display)),this._undoStack.push(e),this._redoStack=[],this._dump=void 0}undo(){if(this._undoStack.length>0){const e=this._undoStack.pop(),t=te(this._service._display);this._redoStack.push(t),this._service.restore(e)}}redo(){if(this._redoStack.length>0){const e=this._redoStack.pop(),t=te(this._service._display);this._undoStack.push(t),this._service.restore(e)}}hasRedo(){return this._redoStack.length>0}}function te(e){const t=e.map((e=>e.toContext()));return JSON.stringify(t)}const se={con:'<div id="editTool"></div>',header:{con:'<div class="editToolHeader"></div>',paleteIcon:'<i class="fas fa-palette"></i>',delIcon:'<i class="fas fa-trash-alt"></i>'},palete:{con:'<div class="editToolProperty subDiv" style="display:none">',font:{con:'<div class="fontSizeDiv"><div class="item">크기</div></div>',item:'<div class="tt"></div>'},color:{con:'<div class="colorDiv"><div class="item">색상</div></div>',item:'<div class="cc"></div>'},close:{con:'<div class="closeBtnDiv sUp"></div>',icon:'<i class="fal fa-angle-up"></i>'}}};class oe{constructor(e={}){const{rootNode:t=null,svgNode:s=null}=e;this.rootNode=t,this.svgNode=s}startEdit(e){if(this.stopEdit(),this.graphic=e,e){const t=e.getShape();if("textarea"==t?.type){const t=e.getForeignElem();this.textareaElem=t.querySelector("textarea")}}ie.call(this),ne.call(this),re.call(this),ae.call(this)}stopEdit(){const e=this.graphic;if(e){const t=e.getShape();if("textarea"==t?.type){const t=e.getForeignElem().querySelector("textarea");t.blur(),t.setAttribute("disabled",!0)}}this.boundaryNode?.remove(),delete this.boundaryNode,this.editTool?.remove(),delete this.editTool,this.observer?.disconnect(),delete this.observer}show(){this.editTool?.show()}hide(){this.editTool?.hide()}}function ie(){const e=this,t=e.rootNode,s=e.graphic,o=s.getShape(),i=[28,32,36,40,44],n=["#000000","#e90000","#0076e3","#00b100","#ffba00","#ffffff"];!function(){const r=se,a=$(r.con);e.editTool=a,t.appendChild(a[0]);const l=r.header,c=$(l.con);a.append(c),o instanceof B&&function(){const t=r.palete,d=$(t.con),h=$(t.font.con);for(const[o,n]of i.entries()){const i=$(t.font.item);i.text(o+1),h.append(i),i.on("click",(function(){e.trigger("changeFontSize",s,n)}))}d.append(h);const u=$(t.color.con);for(const o of n){const i=$(t.color.item);i.css({border:"1px solid #999","background-color":o}),u.append(i),i.on("click",(function(){f.css("color",o),e.trigger("changeFontColor",s,o)}))}d.append(u);const p=$(t.close.con),g=$(t.close.icon);p.append(g),p.on("click",(function(){d.slideUp(100)})),d.append(p),a.append(d);const f=$(l.paleteIcon);f.css("color",o.color),f.on("click",(function(e){d.is(":visible")?d.slideUp(100):d.slideDown(100)})),c.append(f)}(),function(){const t=$(l.delIcon);c.append(t),t.on("click",(async t=>{t.stopPropagation(),t.preventDefault(),"DELETE"==await m.confirm({msg:"텍스트 입력을 삭제합니다.",delMode:!0})?e.trigger("deleteElem",s.id):e.textareaElem.focus()}))}()}(),function(){const t=["x","y","width","height","scale"],o=new MutationObserver((function(s,o){for(const o of s)if("childList"===o.type)console.log("A child node has been added or removed.");else if("attributes"===o.type){const s=o.attributeName;t.includes(s)&&ae.call(e,s)}}));var i={attributes:!0,childList:!0,characterData:!0};const n=s.getCoordElem();o.observe(n,i),o.observe(e.rootNode,i),e.observer=o}()}function ne(){const e=this,t=e.graphic,s=(t.getPackedElem(),t.getGraphicElem(),t.getShape(),function(e={}){const{x:t=0,y:s=0,width:o=0,height:i=0,scale:n=1}=e,r=I.createElementNS("svg",{x:t,y:s,width:o,height:i,role:"boundary"}),a=I.createElementNS("rect",{x:0,y:0,width:"100%",height:"100%","pointer-events":"visiblePainted",role:"boundary-box",class:"bBox",cursor:"move"});r.appendChild(a);const l=I.createElementNS("circle",{"pointer-events":"visiblePainted",cx:"0%",cy:"0%",class:"bVertex resize",role:"boundary-vertex","resize-direction":"nw",cursor:"nw-resize"}),c=I.createElementNS("circle",{"pointer-events":"visiblePainted",cx:"100%",cy:"0%",class:"bVertex resize",role:"boundary-vertex","resize-direction":"ne",cursor:"ne-resize"}),d=I.createElementNS("circle",{"pointer-events":"visiblePainted",cx:"0%",cy:"100%",class:"bVertex resize",role:"boundary-vertex","resize-direction":"sw",cursor:"sw-resize"}),h=I.createElementNS("circle",{"pointer-events":"visiblePainted",cx:"100%",cy:"100%",class:"bVertex resize",role:"boundary-vertex","resize-direction":"se",cursor:"se-resize"});r.appendChild(l),r.appendChild(c),r.appendChild(d),r.appendChild(h);const u=I.createElementNS("circle",{"pointer-events":"visiblePainted",cx:"50%",cy:"0%",class:"bVertex resize",role:"boundary-vertex","resize-direction":"n",cursor:"ns-resize"}),p=I.createElementNS("circle",{"pointer-events":"visiblePainted",cx:"50%",cy:"100%",class:"bVertex resize",role:"boundary-vertex","resize-direction":"s",cursor:"ns-resize"}),g=I.createElementNS("circle",{"pointer-events":"visiblePainted",cx:"100%",cy:"50%",class:"bVertex resize",role:"boundary-vertex","resize-direction":"e",cursor:"ew-resize"}),f=I.createElementNS("circle",{"pointer-events":"visiblePainted",cx:"0%",cy:"50%",class:"bVertex resize",role:"boundary-vertex","resize-direction":"w",cursor:"ew-resize"});return r.appendChild(u),r.appendChild(p),r.appendChild(g),r.appendChild(f),r.update=(e={})=>{const t=r.getBBox(),{x:s=t.x,y:o=t.y,width:i=t.width,height:n=t.height,scale:l=1}=e,c=4/l,d=2/l,h=8/l;I.setElementAttributes(r,{x:s,y:o,width:i,height:n}),a.setAttribute("stroke-width",c),r.querySelectorAll("circle").forEach((e=>{I.setElementAttributes(e,{r:h,"stroke-width":d})}))},r.update({x:t,y:s,width:o,height:i,scale:n}),r}({x:0,y:0,width:0,height:0}));e.svgNode.appendChild(s),e.boundaryNode=s}function re(){const e=this,t=e.graphic;if("textarea"==t.shape.type){const s=t.getForeignElem().querySelector("textarea");$(s).unbind(),$(s).on("change",(function(o){s.innerHTML=s.value,e.trigger("changeText",t,s.value)})),$(s).on("focus",(function(e){s.innerHTML})),$(s).on("keyup",(function(o){o.keyCode,s.innerHTML=s.value,e.trigger("changeText",t,s.value)})),$(s).on("blur",(function(e){s.innerHTML})),s.removeAttribute("disabled"),s.focus()}}function ae(e){const t=this,s=t.graphic,o=s.shape,i=t.rootNode,n=i.getBoundingClientRect(),r=s.getCoordElem(),a=r.getBoundingClientRect(),l=r.getBBox(),c=1*r.getAttribute("x"),d=1*r.getAttribute("y"),h=o.width?o.width:l.width,u=o.height?o.height:l.height,p=i.getAttribute("scale"),g=o.strokeWidth*p,f=(4+g)*p,m=(a.left,n.left,a.top,n.top,t.editTool);switch(m.css("transform","scale("+1/p+")"),e){case"x":m.css("left",c-f/2+"px");break;case"y":m.css("top",d-f/2+"px");break;case"width":case"height":break;default:m.css("left",c-f/2+"px"),m.css("top",d-f/2+"px")}t.boundaryNode.update({x:c-g/2,y:d-g/2,width:h+g,height:u+g,scale:p})}Object.assign(oe.prototype,d);class le{constructor(e={}){const{type:t,name:s="",title:o="",icon:i="fas fa-tools"}=e;this.type=t,this.name=s,this.title=o,this.icon=i}setType(e){this.type=e}}Object.assign(le.prototype,L);class ce extends le{constructor(e={}){super({...e,type:"eraser"})}}class de extends le{constructor(e={}){super({...e,type:"control"})}}class he extends le{constructor(e={}){super({...e,type:"zoom"});const{zoom:t=""}=e;this.zoom=t}}class ue extends le{constructor(e={}){super({...e,type:"fit"});const{fit:t="vertical"}=e;this.fit=t}}const pe={getUUID:function(e){return e||(e=16),([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))).substring(0,e)},roundToTwo:function(e){return+(Math.round(e+"e+2")+"e-2")},defer:(e,t)=>function(){setTimeout((()=>e.apply(this,arguments)),t)},getPointerPos:function(e,t,s){let o=pe.roundToTwo(e.offsetX)/t,i=pe.roundToTwo(e.offsetY)/t;return s?{x:o,y:i}:{x:Math.floor(o),y:Math.floor(i)}},getDistance:function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}},ge={createInterface(){if(this.element)return;const e=this,t=$('<div class="tool"></div>');t.attr("title",e.title);let s=$("<i></i>");return s.addClass(e.icon),t.append(s),t.on("click",(function(){e.trigger("select")})),this.element=t,t},select(){const e=this.element;e&&e.addClass("selected")},unselect(){const e=this.element;e&&e.removeClass("selected")},enable(){this.activate=!0,this.element?.removeClass("disabled")},disable(){this.activate=!1,this.element?.addClass("disabled")},show(){this.element?.removeClass("d-none")},hide(){this.element?.addClass("d-none")}},fe={__proto__:ge,enable(){super.enable()},disable(){super.disable()},show(){super.show()},hide(){super.hide()},toContext(){return{id:"G"+pe.getUUID(6),action:"N",shape:new this.constructor(this)}},createInterface(e,t,s){if(this.element)return;const o=this,i='<div class="item"></div>',n='<div class="sizeDiv">',r='<div class="tt"><div></div></div>',a='<div class="colorDiv">',l='<div class="cc"></div>',c=$('<div class="tool"></div>');c.attr("title",o.title);let d=$('<div class="sDown"></div>'),h=$('<div class="subDiv penSubDiv"></div>'),u=$("<i></i>");if(u.addClass(e),d.html(u),c.append(d),c.append(h),c.on("click",(function(e){$(".subDiv").not(h).slideUp(100),h.is(":visible")?h.slideUp(100):$(this).hasClass("selected")?($(this).addClass("selected"),h.slideDown(100)):$(this).addClass("selected"),o.trigger("select")})),t){let e=$(n);e.addClass("z-100");let s=$(i);s.html("두께"),e.append(s);let a=t.list,l=["t1","t2","t3","t4","t5","t6"];for(let s=0;s<a.length;s++){let i=$(r);s==t.def&&(i.addClass("selected"),o.setStrokeWidth(a[s])),i.addClass(l[s]),e.append(i),i.on("click",(function(t){t.stopPropagation(),e.find("div").removeClass("selected"),$(this).addClass("selected"),o.setStrokeWidth(a[s])}))}h.append(e)}if(s){let e=$(a),t=$(i);t.html("색상"),e.append(t);let n=s.list,r=["cBlack","cRed","cBlue","cGreen","cYellow","cWhite"];for(let t=0;t<n.length;t++){let i=$(l);t==s.def&&(u.addClass(r[t]),o.setStroke(n[t])),i.addClass(r[t]),e.append(i),i.on("click",(function(e){e.stopPropagation(),u.removeClass(r),u.addClass(r[t]),o.setStroke(n[t])}))}h.append(e)}let p=$('<div class="closeBtnDiv sUp"><i class="fal fa-angle-up"></i></div>');return p.addClass("z-100"),p.on("click",(function(e){$(".subDiv").slideUp(100),e.stopPropagation()})),h.append(p),h.hide(),o.open=function(){c.addClass("selected"),h.slideDown(100)},o.close=function(){h.slideUp(100)},this.element=c,c},select(){const e=this.element;e&&e.addClass("selected")},unselect(){const e=this.element;e&&(e.removeClass("selected"),e.find(".subDiv")?.slideUp())},pointerEnter(e){e.preventDefault();const t=this,s=t.getStyleAttribute(),o=e.currentTarget;$(o).attr("scale"),o.style.cursor="none";let i=o.closest("div").querySelector(".cursor");i&&i.remove(),i=document.createElement("div"),i.classList.add("cursor","draw");const n=s["stroke-width"];i.style.width=n+"px",i.style.height=n+"px",i.style.visibility="hidden";const r=s.stroke;i.style.borderColor=r,o.closest("div").appendChild(i),$(o).unbind("pointermove pointerdown wheel"),$(o).on("pointermove",(function(e){e.preventDefault();const t=pe.getPointerPos(e,1,!0),s=(i.getBoundingClientRect(),t.y-n/2),o=t.x-n/2;i.style.top=s+"px",i.style.left=o+"px",i.style.visibility="visible"})),$(o).on("pointerdown",(function(e){t.pointerDown(e)})),t.cursorRemove=function(){i.remove()}},pointerDown(e){if(e.preventDefault(),null!=e.isPrimary&&!e.isPrimary)return;const t=this;t.close();const s=e.currentTarget,o=($(s).attr("scale"),e.pointerId),i=e.pointerType;if("touch"==i)return;const n=[];if(this.pointerType)switch(i){case"mouse":case"pen":n.length=0,t.drawCancel(),t.pointerId=o,t.pointerType=i;break;case"touch":return}else t.pointerId=o,t.pointerType=i;let r=pe.getPointerPos(e,1);function a(e){if(document.elementFromPoint(e.pageX-window.pageXOffset,e.pageY-window.pageYOffset)!=s&&l(e),e.preventDefault(),e.pointerId!=t.pointerId)return;let o=pe.getPointerPos(e,1);pe.getDistance(r,o)<(t.strokeWidth/2<5?5:t.strokeWidth/2)||(n.push([o.x,o.y]),r=o,t.drawMove([o.x,o.y],n.slice(n.length-2,n.length),n))}function l(e){e.preventDefault(),$(s).unbind("pointerup",l),$(s).unbind("pointermove",a);const o=e.pointerId;e.pointerType,n.length>1&&(!o||t.pointerId==o)?t.drawEnd(n):t.drawCancel(),delete t.pointerType,delete t.pointerId}n.push([r.x,r.y]),t.drawStart([r.x,r.y]),$(s).on("pointermove",a),$(s).on("pointerup",l)},setName(e){this.name=e},setTitle(e){this.title=e}},me={__proto__:fe,icon:"fas fa-pen",size:{list:[2,4,6,8,10,12],def:1},color:{list:["#000000","#e90000","#0076e3","#00b100","#ffba00","#ffffff"],def:0},toContext(){return super.toContext()},select(){super.select()},unselect(){super.unselect()},enable(){super.enable()},disable(){super.disable()},show(){super.show()},hide(){super.hide()},pointerEnter(e){super.pointerEnter(e)},pointerDown(e){super.pointerDown(e)},createInterface(){return super.createInterface(this.icon,this.size,this.color)},setName(e){super.setName(e)},setTitle(e){super.setTitle(e)}},ve={__proto__:fe,icon:"fas fa-highlighter",size:{list:[10,25,50,75,100],def:1},color:{list:["#000000","#ff0000","#a1d9ff","#a1ffa1","#ffea8c"],def:3},toContext(){return super.toContext()},select(){super.select()},unselect(){super.unselect()},enable(){super.enable()},disable(){super.disable()},show(){super.show()},hide(){super.hide()},pointerEnter(e){super.pointerEnter(e)},pointerDown(e){super.pointerDown(e)},createInterface(){return super.createInterface(this.icon,this.size,this.color)},setName(e){super.setName(e)},setTitle(e){super.setTitle(e)}},ye={__proto__:fe,icon:"fas fa-pen-fancy",size:{list:[5,10,15,20,25],def:0},color:{list:["#000000","#ff0000","#a1d9ff","#a1ffa1","#ffea8c"],def:0},toContext(){return super.toContext()},select(){super.select()},unselect(){super.unselect()},enable(){super.enable()},disable(){super.disable()},show(){super.show()},hide(){super.hide()},pointerEnter(e){super.pointerEnter(e)},pointerDown(e){super.pointerDown(e)},createInterface(){return super.createInterface(this.icon,this.size,this.color)},setName(e){super.setName(e)},setTitle(e){super.setTitle(e)}},be=new V;Object.assign(be,ye),be.setName("fancy"),be.setTitle("펜시");const we=be,Ce={__proto__:ge,toContext(){return{id:"G"+pe.getUUID(6),action:"N",shape:new this.constructor(this)}},createInterface(){return super.createInterface()},select(){super.select()},unselect(){super.unselect()},enable(){super.enable()},disable(){super.disable()},show(){super.show()},hide(){super.hide()},pointerEnter(e){const t=this;e.preventDefault();const s=e.currentTarget;$(s).attr("scale"),$(s).css("cursor","crosshair"),$(s).unbind("pointermove pointerdown wheel"),$(s).on("pointerdown",(function(e){t.pointerDown(e)}))},pointerDown(e){if(e.preventDefault(),null!=e.isPrimary&&!e.isPrimary)return;const t=this,s=e.currentTarget,o=($(s).attr("scale"),pe.getPointerPos(e,1));function i(e){e.preventDefault();const s=pe.getPointerPos(e,1);t.drawMove?.(o,s)}function n(e){e.preventDefault(),$(s).unbind("pointerup",n),$(s).unbind("pointermove",i);const o=pe.getPointerPos(e,1);t.drawEnd?.(o)}t.drawStart?.(o),$(s).unbind("pointerdown",n),$(s).on("pointermove",i),$(s).on("pointerup",n)},setName(e){this.name=e},setTitle(e){this.title=e}},xe={__proto__:Ce,icon:"far fa-text",toContext(){return super.toContext()},select(){super.select()},unselect(){super.unselect()},enable(){super.enable()},disable(){super.disable()},show(){super.show()},hide(){super.hide()},pointerEnter(e){super.pointerEnter(e)},pointerDown(e){super.pointerDown(e)},createInterface(){return super.createInterface(this.icon)},setName(e){super.setName(e)},setTitle(e){super.setTitle(e)}},Ee={__proto__:Ce,icon:"far fa-square-full",toContext(){return super.toContext()},select(){super.select()},unselect(){super.unselect()},enable(){super.enable()},disable(){super.disable()},show(){super.show()},hide(){super.hide()},pointerEnter(e){super.pointerEnter(e)},pointerDown(e){super.pointerDown(e)},createInterface(){return super.createInterface(this.icon)},setName(e){super.setName(e)},setTitle(e){super.setTitle(e)}},Se=new Q;Object.assign(Se,Ee),Se.setName("sqaure"),Se.setTitle("사각형");const ke=Se,Te=new W({name:"pen",title:"펜",level:3});Object.assign(Te,me),Te.setName("pen"),Te.setTitle("펜");const Ne=Te,De=new W({strokeWidth:25,strokeOpacity:.5,level:1});Object.assign(De,ve),De.setName("marker"),De.setTitle("마커");const Pe=De,Me=new B({level:2});Object.assign(Me,xe),Me.setName("textbox"),Me.setTitle("텍스트상자");const _e=Me,Oe={__proto__:ge,createInterface(){return super.createInterface()},select(){super.select()},unselect(){super.unselect()},enable(){super.enable()},disable(){super.disable()},show(){super.show()},hide(){super.hide()},pointerEnter(e){e.preventDefault();const t=e.currentTarget,s=this,o=$(t).attr("scale");t.style.cursor="none";let i=t.closest("div").querySelector(".cursor");i&&i.remove(),i=document.createElement("div"),i.classList.add("cursor","draw"),i.style.visibility="visible",i.style.width="20px",i.style.height="20px",i.style.borderColor="#999999",t.closest("div").appendChild(i),$(t).unbind("pointermove pointerdown wheel"),$(t).on("pointermove",(function(e){e.preventDefault();const t=pe.getPointerPos(e,1,!0),s=(i.getBoundingClientRect(),t.y-10),o=t.x-10;i.style.top=s+"px",i.style.left=o+"px"})),$(t).on("pointerdown",(function(e){s.pointerDown(e,o)})),s.cursorRemove=function(){i.remove()}},pointerDown(e,t){const s=this;if(e.preventDefault(),e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId),null!=e.isPrimary&&!e.isPrimary)return;if("touch"==e.pointerType)return;const o=e.currentTarget,i=e.target;let n=pe.getPointerPos(e,1,!0);function r(e){e.preventDefault();const t=e.target;n=pe.getPointerPos(e,1,!0),s.erase([n.x,n.y],t)}i!=o&&s.erase([n.x,n.y],i),$(o).on("pointermove",r),$(o).on("pointerup",(function e(t){t.preventDefault(),$(o).unbind("pointerup",e),$(o).unbind("pointermove",r),s.eraseEnd()}))}},Le=new ce({name:"eraser",title:"지우개",icon:"fas fa-eraser"});Object.assign(Le,Oe);const Ae=Le;class $e extends de{constructor(e={}){super(e);const{node:t=null,color:s="#fff",wradius:o=16,hradius:i=16}=e;this.node=t,this.wradius=o,this.hradius=i,this.color=s,this.posX=0,this.posY=0}update(e={}){const{node:t=this.node,color:s=this.color,wradius:o=this.wradius,hradius:i=this.hradius}=e;this.node=t,this.wradius=o,this.hradius=i,this.color=s}updatePos(e={}){const{posX:t=this.posX,posY:s=this.posY}=e;this.posX=t,this.posY=s}startDraw(){const e=this;this.endDraw(),this.interval=setInterval((function(){!function(e={}){const{node:t,wradius:s,hradius:o,color:i,posX:n,posY:r}=e;$(t).children("#laserCircle").length<=0?$('<div class="laserCircle" id="laserCircle"></div>').css({position:"absolute",width:s,height:o,"border-radius":"50%",background:i,border:"3px solid"+i,top:r-o/2+"px",left:n-s/2+"px","touch-action":"none","pointer-events":"none"}).appendTo(t):($("#laserCircle"),$("#laserCircle").finish().css({top:r-o/2+"px",left:n-s/2+"px",opacity:1,display:"block"}))}({node:e.node,wradius:e.wradius,hradius:e.hradius,color:e.color,posX:e.posX,posY:e.posY})}),10)}endDraw(){$("#laserCircle").fadeOut("slow",(function(){})),clearInterval(this.interval)}}const He={__proto__:ge,createInterface(){return super.createInterface()},select(){super.select()},unselect(){super.unselect()},enable(){super.enable()},disable(){super.disable()},show(){super.show()},hide(){super.hide()},pointerEnter(e){e.preventDefault();const t=e.currentTarget,s=$(t).attr("scale");$(t).unbind("wheel"),$(t).css("cursor","grab");const o=new ze({tool:this,scale:s});$(t).on("pointerdown",(function(e){e.stopPropagation(),e.preventDefault(),$(t).css("cursor","grabbing"),o.controlStart(e)})),$(t).on("pointermove",(function(e){e.stopPropagation(),e.preventDefault(),$(t).css("cursor","grab"),o.controlMove(e)})),$(t).on("pointerup",(function(e){e.stopPropagation(),e.preventDefault(),$(t).css("cursor","grabbing"),o.controlEnd(e)}))}};class ze{constructor(e={}){const{tool:t,scale:s=1}=e;this.tool=t,this.evCache=[],this.lastPos=[],this.totalMove=0,this.grab=!1}controlStart(e,t){this.prevDiff=-1,this.startTime=e.timeStamp,e.currentTarget;const s=pe.getPointerPos(e,1);this.totalMove=0,this.lastPos=s,this.evCache.push(e),this.tool.controlStart?.(e,s)}controlMove(e,t){e.preventDefault(),e.stopPropagation();const s=this.evCache;if(0!=s.length){for(let t=0;t<s.length;t++)if(e.pointerId===s[t].pointerId){s[t]=e;break}if(2===s.length){const e=Math.abs(s[0].clientX-s[1].clientX),t=this.prevDiff;t>0&&(e>t&&this.tool.zoom("in",e-t),e<t&&this.tool.zoom("out",t-e)),this.prevDiff=e}else{const t=this.lastPos,s=pe.getPointerPos(e,1);if(!t)return void(this.lastPos=s);let o=pe.getDistance(t,s);if(o<=0)return;this.totalMove+=o,this.tool.controlMove?.(e,t,s,o),this.direction=t.y-s.y>0?"bottom":"top",this.lastPos=null}}}controlEnd(e,t){if(e.preventDefault(),e.stopPropagation(),!e.pointerId)return;!function(e,t){for(let s=0;s<t.length;s++)if(t[s].pointerId===e.pointerId){t.splice(s,1);break}}(e,this.evCache),this.evCache.length<2&&(this.prevDiff=-1),this.lastPos=null;const s=pe.getPointerPos(e,1),o=e.timeStamp,i=Math.floor(o-this.startTime);this.tool.controlEnd?.(s,this.totalMove,this.direction,i)}scroll(e,t){this.tool.scroll(e,pe.roundToTwo(t))}}const Be={__proto__:He,toContext(){return super.toContext()},select(){super.select()},unselect(){super.unselect()},enable(){super.enable()},disable(){super.disable()},show(){super.show()},hide(){super.hide()},pointerEnter(e){const t=this;e.preventDefault();const s=e.currentTarget;$(s).css("cursor","default"),$(s).unbind("click wheel pointermove pointerdown"),$(s).on("pointerdown",(function(e){e.stopPropagation(),e.preventDefault(),t.pointerDown(e)}))},pointerDown(e){const t=this,s=(e.timeStamp,e.currentTarget);s.setPointerCapture(e.pointerId);const o=pe.getPointerPos(e,1);let i=o;function n(e){e.preventDefault(),e.stopPropagation();const s=pe.getPointerPos(e,1);pe.getDistance(i,s)<=1||(t.laserMove?.(s),i=s)}$(s).on("pointermove",n),$(s).on("pointerup",(function o(i){s.releasePointerCapture(e.pointerId),i.preventDefault(),i.stopPropagation(),$(s).unbind("pointerup",o),$(s).unbind("pointermove",n),t.laserEnd?.()})),t.laserStart?.(o)},createInterface(){return super.createInterface()}},Ye=new $e({name:"laser",title:"레이저포인터",icon:"fas fa-bullseye-pointer",color:"#e9000066",wradius:40,hradius:40});Ye.setType("highlight"),Object.assign(Ye,Be);const Ie=Ye,je=new de({name:"pointer",title:"포커스",icon:"fas fa-hand-paper"});Object.assign(je,He);const Xe=je,qe={__proto__:ge,createInterface(){return super.createInterface()},select(){},unselect(){},enable(){super.enable()},disable(){super.disable()},show(){super.show()},hide(){super.hide()}},Fe={__proto__:ge,createInterface(){return super.createInterface()},select(){super.select()},unselect(){super.unselect()},enable(){super.enable()},disable(){super.disable()},show(){super.show()},hide(){super.hide()}},Ue=new he({name:"zoomout",title:"축소",icon:"fas fa-search-minus",zoom:"out"});Object.assign(Ue,qe);const Ge=Ue,Re=new he({name:"zoomin",title:"확대",icon:"fas fa-search-plus",zoom:"in"});Object.assign(Re,qe);const Ke=Re,We=new ue({name:"fitver",title:"세로맞춤",icon:"fas fa-arrows-alt-v",fit:"vertical"});Object.assign(We,Fe);const Ve=We,Je=new ue({name:"fithor",title:"가로맞춤",icon:"fas fa-arrows-alt-h",fit:"horizontal"});Object.assign(Je,Fe);const Qe=Je;class Ze{constructor(e={}){const{unuse:t=[we,ke]}=e,s=t,o=[Ne,Pe,we,ke,_e,Ae,Ie,Xe,Ge,Ke,Ve,Qe].filter((e=>!s.includes(e)));this.toolCollection=o.map((e=>{return t=e,Object.assign(Object.create(Object.getPrototypeOf(t)),t);var t})),this.pathToolCollection=this.toolCollection.filter((e=>e instanceof K)),this.basicToolCollection=this.toolCollection.filter((e=>e instanceof z)),this.eraserToolCollection=this.toolCollection.filter((e=>e instanceof ce)),this.controlToolCollection=this.toolCollection.filter((e=>e instanceof de)),this.resizeToolCollection=this.toolCollection.filter((e=>e instanceof he||e instanceof ue));const i=this;this.pathToolCollection.forEach((e=>e.on("select",(function(){i.pathToolCollection.filter((e=>e!=this)).forEach((e=>e.unselect())),i.basicToolCollection.forEach((e=>e.unselect())),i.eraserToolCollection.forEach((e=>e.unselect())),i.controlToolCollection.forEach((e=>e.unselect())),e.select()})))),this.basicToolCollection.forEach((e=>e.on("select",(function(){i.pathToolCollection.forEach((e=>e.unselect())),i.basicToolCollection.filter((e=>e!=this)).forEach((e=>e.unselect())),i.eraserToolCollection.forEach((e=>e.unselect())),i.controlToolCollection.forEach((e=>e.unselect())),e.select()})))),this.eraserToolCollection.forEach((e=>e.on("select",(function(){i.pathToolCollection.forEach((e=>e.unselect())),i.basicToolCollection.forEach((e=>e.unselect())),i.eraserToolCollection.filter((e=>e!=this)).forEach((e=>e.unselect())),i.controlToolCollection.forEach((e=>e.unselect())),e.select()})))),this.controlToolCollection.forEach((e=>e.on("select",(function(){i.pathToolCollection.forEach((e=>e.unselect())),i.basicToolCollection.forEach((e=>e.unselect())),i.eraserToolCollection.forEach((e=>e.unselect())),i.controlToolCollection.filter((e=>e!=this)).forEach((e=>e.unselect())),e.select()})))),this.resizeToolCollection.forEach((e=>e.on("select",(function(){i.resizeToolCollection.filter((e=>e!=this)).forEach((e=>e.unselect())),e.select()})))),this.interfaceCollection=this.toolCollection.map((e=>e.createInterface()))}selectTool(e){this.unselectAll();const t=this.toolCollection.find((t=>t.name==e));return t?(t.trigger("select"),t):Ne}unselectAll(){this.toolCollection.forEach((e=>e.unselect()))}getTool(e){return this.toolCollection.find((t=>t.name==e))}getAllTool(){return this.toolCollection}getPathTool(){return this.pathToolCollection}getBasicTool(){return this.basicToolCollection}getEraserTool(){return this.eraserToolCollection}getControlTool(){return this.controlToolCollection}getResizeTool(){return this.resizeToolCollection}getToolInterface(){return this.interfaceCollection}}const et={ResizeFactor:function(e){const t={x:0,y:0,width:0,height:0};switch(e){case"nw":t.x=1,t.y=1,t.width=-1,t.height=-1;break;case"ne":t.x=0,t.y=1,t.width=1,t.height=-1;break;case"sw":t.x=1,t.y=0,t.width=-1,t.height=1;break;case"se":t.x=0,t.y=0,t.width=1,t.height=1;break;case"n":t.x=0,t.y=1,t.width=0,t.height=-1;break;case"s":t.x=0,t.y=0,t.width=0,t.height=1;break;case"e":t.x=0,t.y=0,t.width=1,t.height=0;break;case"w":t.x=1,t.y=0,t.width=-1,t.height=0}return t},DefaultFontFamily:"HelveticaNeue-Light,AppleSDGothicNeo-Light,Pretendard,Malgun Gothic,맑은 고딕,sans-serif"};class tt{constructor(e={}){const t={selectable:!0,disableTool:[],hideTool:["highlight"]},{width:s=300,height:o=150,section:i=null,options:n=t}=e;if(this.options=n,this.mutex=new O,!i||""==i)return console.error("캔버스가 위치할 선택자 혹은 DOM이 설정되어 있지 않습니다."),null;this.sectionNode="string"==typeof i?document.querySelector("#"+i):i,st.call(this),at.call(this),lt.call(this),rt.call(this,{width:s,height:o}),nt.call(this,n)}update(e={}){const{options:t={}}=e;nt.call(this,t)}start(){const e=this,t=this.containerNode;if($(t).on({pointerenter:function(t){t.stopPropagation(),t.preventDefault(),1!=e.nowEnter&&(ot.call(e,t),e.nowEnter=!0)},pointerleave:function(t){t.stopPropagation(),t.preventDefault(),it.call(e,t),e.nowEnter=!1}}),this.eventTool){const e=this.eventObject;ot.call(this,e)}}stop(){const e=this;return new Promise(((t,s)=>{const o=e.containerNode;o.style.cursor="default",e.laserEnd(),e.eventTool?.cursorRemove?.(),e.editService.stopEdit(),$(o).trigger("pointerup"),$(o).unbind("pointerdown pointerenter pointermove pointerup pointerleave"),setTimeout((()=>t()))}))}clear(){this.editService.stopEdit(),this.graphicService.empty(),this.screenService.transformScale(),this.screenService.setBackgroundColor()}fitScreenToWindow(){this.screenService.fitScreenToWindow()}fitVerticalOrientation(){this.screenService.fitVerticalOrientation()}fitHorizontalOrientation(){this.screenService.fitHorizontalOrientation()}setFocus(){}setBackground(e={}){return new Promise((async(t,s)=>{const{url:o=null,color:i="white"}=e;if(o)try{await this.screenService.setBackgroundImage(o)}catch(e){s(e)}else this.screenService.setBackgroundColor(i);t()}))}getSourceImg(){return this.screenService.image}isEmpty(){return this.graphicService.isEmpty()}getPadImage(){const e=this;return new Promise(((t,s)=>{e.editService.stopEdit();const o=e.getSourceImg();ft.call(e).then((function(e={}){const{canvas:s,ctx:i}=e;o&&(i.globalCompositeOperation="destination-over",i.drawImage(o,0,0,s.width,s.height));let n=s.toDataURL();t(n)}))}))}selectTool(e){this.toolService.selectTool(e),it.call(this),ot.call(this)}disableTool(e){const t=this;e.forEach((e=>{t.toolService.getTool}))}getToolInterface(){return this.toolService.getToolInterface()}loadGraphicContext(e){return new Promise(((t,s)=>{this.graphicService.empty();for(const t of e)this.graphicHistory.take(),this.graphicService.load(t);t(this.graphicService.getAll())}))}getGraphicContext(){return this.graphicService.getAll().map((e=>JSON.stringify(e)))}undo(){this.mutex.runExclusive((async()=>{this.editService.stopEdit(),this.graphicHistory.undo()}))}redo(e){this.mutex.runExclusive((async()=>{this.editService.stopEdit(),this.graphicHistory.hasRedo()?this.graphicHistory.redo():(this.graphicHistory.take(),this.graphicService.load(e))}))}laserStart(e){const t=this.toolService.getTool("laser");t?.update({node:this.containerNode}),t?.updatePos({posX:e.x,posY:e.y}),t?.startDraw(),this.laser=t}laserMove(e){$(this.containerNode).children("#laserCircle").length<=0?this.laserStart(e):this.laser?.updatePos({posX:e.x,posY:e.y})}laserEnd(){this.laser?.endDraw(),delete this.laser}}function st(){const e=this.sectionNode;e.setAttribute("node-role","section");const t=document.createElement("div");t.setAttribute("node-role","screen"),e.appendChild(t),e.screenNode=t,this.screenNode=t;const s=document.createElement("div");s.setAttribute("node-role","container"),t.appendChild(s),t.containerNode=s,this.containerNode=s;const o=I.createElementNS("svg",{role:"area"});o.style.overflow="hidden",o.setAttribute("node-role","deploy");const i=I.createElementNS("g",{role:"depth","depth-level":1}),n=I.createElementNS("g",{role:"depth","depth-level":2}),r=I.createElementNS("g",{role:"depth","depth-level":3}),a=[i,n,r];o.appendChild(i),o.appendChild(n),o.appendChild(r),o.getDeployNode=e=>(e>3?e=3:e<1&&(e=1),a[e-1]),o.addGraphic=(e={})=>{const{element:t,level:s=1}=e;s>3?s=3:s<1&&(s=1),a[s-1].appendChild(t)},o.clearGraphic=()=>{a.forEach((e=>e.innerHTML=""))},s.appendChild(o),s.svgNode=o,this.svgNode=o}function ot(e){const t=this.eventTool;e&&(this.eventObject=e),this.eventObject&&this.eventCallback?.call(t,this.eventObject)}function it(e){const t=this.eventTool;t?.cursorRemove?.();const s=this.containerNode;$(s).trigger("pointerup"),$(s).unbind("pointerdown pointermove pointerup"),$(s).css("cursor","default")}function nt(e={}){const{selectable:t=this.options.selectable,disableTool:s=this.options.disableTool,hideTool:o=this.options.hideTool}=e;this.options.selectable=t,this.options.disableTool=s,this.options.hideTool=o,this.svgNode,1==t?document.querySelectorAll("svg").forEach((e=>e.setAttribute("pointer-events","visiblePainted"))):document.querySelectorAll("svg").forEach((e=>e.setAttribute("pointer-events","none")));const i=this.toolService.getAllTool();i.forEach((e=>{e.enable(),e.show()})),i.filter((e=>s.includes(e.type))).forEach((e=>e.disable())),i.filter((e=>o.includes(e.type))).forEach((e=>e.hide()))}function rt(e={}){const t=this,{width:s,height:o}=e,i=new A({instance:t,width:s,height:o});i.on("transformScale",(function(e){t.trigger("transformScale",e)})),this.screenService=i}function at(){const e=new Z({instance:this});this.graphicService=e;const t=new ee(e);this.graphicHistory=t}function lt(){const e=this;this.editService=new oe({rootNode:e.containerNode,svgNode:e.svgNode}),this.toolService=new Ze,e.editService.on("deleteElem",(t=>{e.editService.stopEdit(),e.graphicHistory.take(),e.graphicService.remove(t),e.trigger("addContext",{id:t,action:"D"})})),e.editService.on("changeFontSize",((t,s)=>{e.graphicHistory.take(),t.shape.update({fontSize:s}),e.trigger("addContext",{id:t.id,action:"U",shape:{fontSize:s}})})),e.editService.on("changeFontColor",((t,s)=>{e.graphicHistory.take(),t.shape.update({color:s}),e.trigger("addContext",{id:t.id,action:"U",shape:{color:s}})})),e.editService.on("changeText",((t,s)=>{t.shape.getText()!=s&&(e.graphicHistory.take(),t.shape.update({text:s}),e.trigger("addContext",{id:t.id,action:"U",shape:{text:s}}))})),e.toolService.getAllTool().forEach((t=>t.on("select",(function(){t instanceof he?"in"==t.zoom?e.screenService.zoomin():"out"==t.zoom&&e.screenService.zoomout():t instanceof ue?"horizontal"==t.fit?e.screenService.fitHorizontalOrientation():"vertical"==t.fit&&e.screenService.fitVerticalOrientation():(e.editService.stopEdit(),e.screenService.switchCtrlmode(!1),e.screenService.switchErasermode(!1),t instanceof W?(e.eventTool=t,e.eventCallback=t.pointerEnter,ct.call(e,t)):t instanceof V?(e.eventTool=t,e.eventCallback=t.pointerEnter,dt.call(e,t)):t instanceof z?(e.eventTool=t,e.eventCallback=t.pointerEnter,ht.call(e,t)):t instanceof ce?(e.eventTool=t,e.eventCallback=t.pointerEnter,e.screenService.switchErasermode(!0),ut.call(e,t)):t instanceof de&&(e.eventTool=t,e.eventCallback=t.pointerEnter,e.screenService.switchCtrlmode(!0),t instanceof $e?pt.call(e,t):gt.call(e,t)))}))))}function ct(e){const t=this,s=t.svgNode;let o,i,n;e.drawStart=function(r){let a=[];if(a.push(r),o)clearTimeout(o),o=null,n.push(a);else{t.graphicHistory.dump(),n=[],n.push(a);const o=e.toContext();i=t.graphicService.create(o),i.setLevel(e.getLevel()),s.appendChild(i.getPackedElem())}e.drawMove=function(e,t,s){a.push(e),i.shape.update({pointGroup:n})},e.drawEnd=function(e){o=setTimeout((()=>{const e=i.toContext();t.graphicHistory.take(),t.graphicService.insert(i),t.trigger("addContext",{...e,action:"N"}),o=null}),200)},e.drawCancel=function(){n.pop(),i.shape.update({pointGroup:n})}}}function dt(e){const t=this,s=t.svgNode;e.drawStart=function(o){t.graphicHistory.dump();const i=e.toContext(),n=t.graphicService.create(i);n.setLevel(e.getLevel()),s.appendChild(n.getPackedElem()),e.drawMove=function(e,t,s){n.shape.update({pointGroup:s})},e.drawEnd=function(e){const s=n.toContext();t.graphicHistory.take(),t.graphicService.insert(n),t.trigger("addContext",{...s,action:"N"})},e.drawCancel=function(){n.destroy()}}}function ht(e){const t=this,s=t.svgNode;e.drawStart=function(o){t.graphicHistory.dump();const i=e.toContext(),n=t.graphicService.create(i);n.setLevel(e.getLevel()),s.appendChild(n.getPackedElem());let r=0,a=0;e.drawMove=function(e,t){r=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y),n.shape.update({startPos:[e.x,e.y],endPos:[t.x,t.y],strokeDasharray:r<40||a<20?"6 4":""})},e.drawEnd=function(e){n.shape.update({stroke:"none"}),(r<40||a<20)&&n.shape.update({startPos:[o.x,o.y],endPos:[o.x+300,o.y+100],strokeDasharray:""});const s=n.toContext();t.graphicHistory.take(),t.graphicService.insert(n),t.trigger("addContext",{...s,action:"N"}),t.selectTool("pointer"),t.graphicService.select(n.id),t.editService.startEdit(n)},e.drawCancel=function(){trigger("cancelStroke")}}}function ut(e){const t=this;t.svgNode,e.erase=function(e,s){t.mutex.runExclusive((async()=>{if("path"!=s.nodeName&&"polyline"!=s.nodeName)return;const e=s.closest('g[role="container"]'),o=e.id;t.graphicHistory.dump(),t.graphicService.remove(o)?(t.graphicHistory.take(),t.trigger("addContext",{id:o,action:"D"})):e.remove()}))},e.eraseEnd=function(){t.graphicService.runGarbageCollector()}}function pt(e){const t=this;e.laserStart=function(s){const o=e;o.update({node:t.containerNode}),o.updatePos({posX:s.x,posY:s.y}),o.startDraw(),t.trigger("laserStart",s),e.laserMove=function(e){o.updatePos({posX:e.x,posY:e.y}),t.trigger("laserMove",e)},e.laserEnd=function(){o.endDraw(),t.trigger("laserEnd")}}}function gt(e){const t=this;t.svgNode;let s=null,o=null,i=null;e.scroll=function(e,n){o?clearTimeout(o):(i=n,s=t.sectionNode.scrollTop),o=setTimeout((()=>{const r=n-i;o=null,t.sectionNode.scrollTop==s&&r<40&&t.trigger("swipe",e)}),100)},e.controlStart=function(s,o){const i=s.target,n=i.getAttribute("role");let r=t.sectionNode.scrollTop;if(i==t.containerNode||i==t.svgNode)t.editService.stopEdit(),e.controlMove=function(s,o,i,n){const r=t.screenService.scale,a=o.x-i.x,l=o.y-i.y;t.sectionNode.scrollLeft+=a*r,t.sectionNode.scrollTop+=l*r,t.trigger("pointerMove",e,[i.x,i.y])},e.controlEnd=function(e,s,o,i){t.editService.show();let n=t.sectionNode.scrollTop;n==r&&i<125&&s>100&&t.trigger("swipe",o),r=n},e.zoom=function(e,s){"in"==e?t.screenService.zoomin(.01):t.screenService.zoomout(.01)};else if("boundary-vertex"==n)t.sectionNode.style.overflow="none",t.sectionNode.style.touchAction="none",function(s,o,i){t.graphicHistory.dump(),t.editService.hide();const n=t.graphicService.getSelected(),r=n.getPackedElem().getBBox(),a=n.shape,l=a.posX,c=a.posY,d=r.x,h=r.y,u=d-l,p=h-c,g=r.width,f=r.height,m=et.ResizeFactor(i);"path"==a.type?(e.controlMove=function(e,s,i,r){const a=t.screenService.width,d=t.screenService.height,h=i.x-o.x,v=i.y-o.y,y=l+h*m.x,b=c+v*m.y,w=g+h*m.width,C=f+v*m.height;y+u<0||b+p<0||w<40||C<20||y+u+w>a||b+p+C>d||n.shape.update({posX:y,posY:b,width:w,height:C})},e.controlEnd=function(e,s,o){t.editService.show(),t.graphicHistory.take(),t.trigger("addContext",{id:n.id,action:"U",shape:{posX:a.posX,posY:a.posY,width:a.width,height:a.height}})}):(e.controlMove=function(e,s,i,r){const a=t.screenService.width,l=t.screenService.height;let c=i.x-o.x,u=i.y-o.y,p=d+c*m.x,v=h+u*m.y,y=g+c*m.width,b=f+u*m.height,w=[p,v],C=[p+y,v+b];p<0||v<0||y<40||b<20||p+y>a||v+b>l||n.shape.update({posX:0,posY:0,startPos:w,endPos:C})},e.controlEnd=function(e,s,o){t.editService.show(),t.graphicHistory.take(),t.trigger("addContext",{id:n.id,action:"U",shape:{posX:0,posY:0,startPos:a.startPos,endPos:a.endPos}})})}(0,o,i.getAttribute("resize-direction"));else if("boundary-box"==n)t.sectionNode.style.overflow="none",t.sectionNode.style.touchAction="none",function(s,o){t.graphicHistory.dump(),t.editService.hide();const i=t.graphicService.getSelected(),n=i.getPackedElem().getBBox(),r=i.shape,a=r.posX,l=r.posY,c=n.x,d=n.y,h=c-a,u=d-l,p=n.width,g=n.height;e.controlMove=function(e,s,n,r){const c=n.x-o.x,d=n.y-o.y,f=t.screenService.width,m=t.screenService.height;let v=a+c,y=l+d;v=h+v<0?-1*h:v,y=u+y<0?-1*u:y,v=v+h+p>f?f-(p+h):v,y=y+u+g>m?m-(g+u):y,i.shape.update({posX:v,posY:y})},e.controlEnd=function(e,s,o){t.editService.show(),t.graphicHistory.take(),t.trigger("addContext",{id:i.id,action:"U",shape:{posX:r.posX,posY:r.posY}})}}(0,o);else try{delete e.controlMove,delete e.controlEnd;const s=i.closest('g[role="container"]'),o=t.graphicService.select(s.id);t.editService.startEdit(o)}catch(e){}}}function ft(){const e=this;return new Promise(((t,s)=>{const o=e.svgNode,i=document.createElement("canvas");i.width=o.getAttribute("width"),i.height=o.getAttribute("height");const n=i.getContext("2d"),r=e.graphicService.getAll();for(const e of r)if("textarea"==e.getShape().type){e.getGraphicElem();const t=e.getForeignElem().querySelector("textarea"),s=window.getComputedStyle(t);Array.from(s).forEach((e=>t.style.setProperty(e,s.getPropertyValue(e),"important"))),t.innerHTML=t.value}const a=new Image;a.crossOrigin="*",a.onload=function(){n.drawImage(this,0,0,i.width,i.height),t({canvas:i,ctx:n})};const l="data:image/svg+xml; charset=utf8, "+encodeURIComponent(function(e){const t="http://www.w3.org/2000/xmlns/";e=e.cloneNode(!0);const s=window.location.href+"#",o=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null,!1);for(;o.nextNode();)for(const e of o.currentNode.attributes)e.value.includes(s)&&(e.value=e.value.replace(s,"#"));e.setAttributeNS(t,"xmlns","http://www.w3.org/2000/svg"),e.setAttributeNS(t,"xmlns:xlink","http://www.w3.org/1999/xlink");return(new XMLSerializer).serializeToString(e)}(o));a.src=l}))}Object.assign(tt.prototype,L);const mt=N.getModalModel();class vt extends mt{constructor(e={}){super(e),this.signPad=new tt({section:"signPad",width:280,height:220}),this.signPad.start(),this.signPad.selectTool("pen")}show(){return this.signPad.clear(),super.show()}async getSign(){return this.signPad.isEmpty()?null:await this.signPad.getPadImage()}}function yt(){if(yt.executed)return;yt.executed=!0,(e=>{const t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href="/resources/core-assets/modules/limePad/limePad.css",document.head.appendChild(t)})();const e=n('\n<div class="modal" data-modal="sign">\n    <div class="modalWrap">\n        <div class="modal_content">\n            <div class="modalTitle">참석자 사인</div>\n            <div class="modalBody">\n            \t<div id="signPad" class="border overflow-visible">\n            \t\n            \t</div>\n            </div>\n            <div class="modalBtnDiv">\n                <div class="btn btn-md btn-silver" data-modal-action="CANCEL">취 소</div>\n                <div class="btn btn-md btn-blue" data-modal-action="OK">저 장</div>\n            </div>\n        </div>\n    </div>\n</div>\n'),t=new vt({modalElement:e,autoHide:!1,autoDestroy:!1});return N.add(t),t.on({action:async e=>{switch(e){case"CANCEL":t.hide({action:e});break;case"OK":{const s=await t.getSign();t.hide({action:e,status:"SUCCESS",payload:s})}}}}),t}const bt=document.querySelector("meta[name='_csrf']")?.content,wt=document.querySelector("meta[name='_csrf_header']")?.content,Ct=e=>Object.fromEntries(Object.entries(e).filter((([e,t])=>null!=t))),xt=(e,t="GET",s=null,o={},i={})=>{const n=((e,t)=>{const s=new URLSearchParams(Ct(t)).toString();return s?`${e}?${s}`:e})(e,o),r={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"};bt&&wt&&!["GET","HEAD","OPTIONS","TRACE"].includes(t.toUpperCase())&&(r[wt]=bt);const a={method:t,headers:{...r,...i}};return s&&("multipart/form-data"===a.headers["Content-Type"]?(delete a.headers["Content-Type"],a.body=s instanceof FormData?s:new FormData):a.headers["Content-Type"].includes("application/x-www-form-urlencoded")?a.body=s instanceof FormData?s:new URLSearchParams(s).toString():a.body=s&&JSON.stringify(s)),console.log("Request","requestUrl:",n,"data:",s,"Options:",a),fetch(n,a).then((e=>{if(!e.ok)throw e;if("0"===e.headers.get("Content-Length"))return null;const t=e.headers.get("Content-Type");if(!t||!t.includes("application/json"))return e.text();try{return e.json()}catch(e){return null}})).catch((e=>{throw console.error("Fetch error:",e),e}))},Et=(e,t={})=>xt(e,"GET",null,Ct(t),{}),St=(e,{data:t=null,queryParams:s={},headers:o={}}={})=>xt(e,"POST",t,Ct(s),o),kt=(e,{data:t=null,queryParams:s={},headers:o={}}={})=>xt(e,"PUT",t,Ct(s),o),Tt={assignOne:e=>Et(`/api/ewp/meeting/assign/${e}`,{skdKey:e}),assignList:(e={})=>{const{officeCode:t,approvalStatus:s,roomType:o,roomKey:i,title:n,host:r,attendeeName:a,elecYN:l,secretYN:c,startDate:d,endDate:h,pageNo:u,pageCnt:p,orderColumn:g,orderDirection:f="ASC"}=e;return Et("/api/ewp/meeting/assign/list",{officeCode:t,approvalStatus:s,roomType:o,roomKey:i,title:n,host:r,attendeeName:a,elecYN:l,secretYN:c,startDate:d,endDate:h,pageNo:u,pageCnt:p,orderColumn:g,orderDirection:f})},assignListCnt:(e={})=>{const{officeCode:t,approvalStatus:s,roomType:o,roomKey:i,title:n,host:r,attendeeName:a,elecYN:l,secretYN:c,startDate:d,endDate:h,pageNo:u,pageCnt:p}=e;return Et("/api/ewp/meeting/assign/list/cnt",{officeCode:t,approvalStatus:s,roomType:o,roomKey:i,title:n,host:r,attendeeName:a,elecYN:l,secretYN:c,startDate:d,endDate:h,pageNo:u,pageCnt:p})},assignListForPlanned:(e={})=>{const{startDate:t,endDate:s}=e;return Et("/api/ewp/meeting/assign/planned/list",{startDate:t,endDate:s})},assignStatForPlanned:(e={})=>{const{startDate:t,endDate:s}=e;return Et("/api/ewp/meeting/assign/planned/stat",{startDate:t,endDate:s})},assignListForRegister:(e={})=>{const{pageNo:t,pageCnt:s}=e;return Et("/api/ewp/meeting/assign/register/list",{pageNo:t,pageCnt:s})},assignListForDisplay:(e={})=>{const{officeCode:t,roomType:s,roomKey:o,startDate:i,endDate:n}=e;return Et("/api/ewp/meeting/assign/display/list",{officeCode:t,roomType:s,roomKey:o,startDate:i,endDate:n})},assignPublicListForDisplay:(e={})=>{const{officeCode:t,roomType:s,roomKey:o,startDate:i,endDate:n}=e;return Et("/api/ewp/public/meeting/assign/display/list",{officeCode:t,roomType:s,roomKey:o,startDate:i,endDate:n})},userArchiveList:(e={})=>{const{skdHost:t,title:s,originalName:o,roleType:i,startDate:n,endDate:r,pageNo:a,pageCnt:l}=e;return Et("/api/ewp/meeting/archive/manage/user",{skdHost:t,title:s,originalName:o,roleType:i,startDate:n,endDate:r,pageNo:a,pageCnt:l})},deptArchiveList:(e={})=>{const{skdHost:t,title:s,originalName:o,startDate:i,endDate:n,pageNo:r,pageCnt:a}=e;return Et("/api/ewp/meeting/archive/manage/dept",{skdHost:t,title:s,originalName:o,startDate:i,endDate:n,pageNo:r,pageCnt:a})},adminArchiveList:(e={})=>{const{skdHost:t,title:s,originalName:o,startDate:i,endDate:n,pageNo:r,pageCnt:a}=e;return Et("/api/ewp/admin/master/meeting/archive/manage",{skdHost:t,title:s,originalName:o,startDate:i,endDate:n,pageNo:r,pageCnt:a})},userAssignList:(e={})=>{const{approvalStatus:t,meetingStatus:s,roomType:o,title:i,host:n,writerKey:r,attendeeName:a,elecYN:l,secretYN:c,startDate:d,endDate:h,pageNo:u,pageCnt:p,orderColumn:g,orderDirection:f="DESC"}=e;return Et("/api/ewp/meeting/assign/manage/user",{approvalStatus:t,meetingStatus:s,roomType:o,title:i,host:n,writerKey:r,attendeeName:a,elecYN:l,secretYN:c,startDate:d,endDate:h,pageNo:u,pageCnt:p,orderColumn:g,orderDirection:f})},deptAssignList:(e={})=>{const{approvalStatus:t,meetingStatus:s,roomType:o,title:i,host:n,attendeeName:r,elecYN:a,secretYN:l,startDate:c,endDate:d,pageNo:h,pageCnt:u,orderColumn:p,orderDirection:g="DESC"}=e;return Et("/api/ewp/meeting/assign/manage/dept",{approvalStatus:t,meetingStatus:s,roomType:o,title:i,host:n,attendeeName:r,elecYN:a,secretYN:l,startDate:c,endDate:d,pageNo:h,pageCnt:u,orderColumn:p,orderDirection:g})}},Nt={Get:{attendeeOne:(e={})=>{const{meetingKey:t,attendKey:s}=e;return Et(`/api/ewp/meeting/${t}/attendee/${s}`)},attendeeListByMeeting:(e={})=>{const{meetingKey:t,attendRole:s,assistantYN:o,attendYN:i,exitYN:n,signYN:r}=e;return Et(`/api/ewp/meeting/${t}/attendee/list`,{attendRole:s,assistantYN:o,attendYN:i,signYN:r})},attendeeSimpleListByMeeting:(e={})=>{const{meetingKey:t}=e;return Et(`/api/ewp/meeting/${t}/attendee/list/simple`)},selectSecurityAgreementOne:(e={})=>{const{meetingKey:t,attendKey:s}=e;return Et(`/api/ewp/meeting/${t}/attendee/${s}/security-agreement`)},selectSecurityAgreementAll:(e={})=>{const{meetingKey:t}=e;return Et(`/api/ewp/meeting/${t}/attendee/security-agreement`)}},Post:{attendeeList:(e={})=>{const{meetingKey:t,list:s}=e;return St(`/api/ewp/meeting/${t}/attendee`,{data:s,headers:{"Content-Type":"application/json; charset=utf-8"}})},insertSecurityAgreementOne:(e={})=>{const{meetingKey:t,signSrc:s}=e;return St(`/api/ewp/meeting/${t}/attendee/security-agreement`,{data:s,headers:{"Content-Type":"application/json; charset=utf-8"}})}},Put:{assistant:(e={})=>{const{meetingKey:t,attendKey:s,assistantYN:o}=e;return kt(`/api/ewp/meeting/${t}/attendee/${s}/assistant/${o}`)},check:(e={})=>{const{meetingKey:t,attendKey:s,attendYN:o}=e;return kt(`/api/ewp/meeting/${t}/attendee/${s}/attendance/${o}`)},sign:(e={})=>{const{meetingKey:t,attendKey:s,signYN:o,signSrc:i}=e;return kt(`/api/ewp/meeting/${t}/attendee/${s}/sign/${o}`,{data:i,headers:{"Content-Type":"application/json; charset=utf-8"}})}},Delete:{}};window.onload=async()=>{const e=yt(),t=await Tt.assignOne(skdKey),{title:s,agreementDate:o=moment().format("YYYY년 MM월 DD일")}=t;l("#phrase1").innerText=`본인은 ${o} 한국동서발전(주) ${s} 회의를 함에 있어`,l("#phrase2").innerText=`${o}`;const n=l("#signLoc");n.style.position="absolute",n.style.pointerEvents="none",l("#signBtn").onclick=async()=>{const{action:t,payload:s}=await e.show();if("OK"==t&&s){const e=s;n.innerHTML="";const t=n.parentNode,o=i("div","signImg"),r=i("img");r.style.height=t.offsetHeight+"px",r.src=e,o.appendChild(r),n.appendChild(o);const a=l("#agreementBtn");a.disabled=!1,a.onclick=async()=>{a.disabled=!0,((e={})=>new y(e))({request:Nt.Post.insertSecurityAgreementOne,param:{meetingKey,signSrc:e},exception:"success-only"}).success((e=>{location.href=`/ewp/meeting/assign/${skdKey}`})).error((e=>{N.errorBuilder(e).build().show(),a.disabled=!1})).exe()}}}}})();