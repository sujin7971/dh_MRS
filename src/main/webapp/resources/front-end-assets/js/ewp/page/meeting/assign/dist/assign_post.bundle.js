(()=>{"use strict";const e=e=>e.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,((e,t)=>0==+e?"":0===t?e.toLowerCase():e.toUpperCase())),t=e=>null==e||"object"==typeof e&&0===Object.keys(e).length||!(!Array.isArray(e)||0!==e.length)||"string"==typeof e&&0===e.trim().length,i=e=>"string"==typeof e?e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'"):e,n=document,s=(e,...t)=>{const i=n.createElement(e);return a(i,...t),i},a=(e,...i)=>{const n=l(e);for(const e of i)t(e)||n?.classList.add(e);return n},o=(e,...i)=>{const n=l(e);for(const e of i)t(e)||n?.classList.remove(e);return n},l=e=>e instanceof HTMLElement?e:n.querySelector(e),r={on(e,t){if(this._eventHandlers||(this._eventHandlers={}),"string"==typeof e)this._eventHandlers[e]||(this._eventHandlers[e]=[]),this._eventHandlers[e].push(t);else if("object"==typeof e)for(let t in e){let i=t,n=e[t];this._eventHandlers[i]||(this._eventHandlers[i]=[]),this._eventHandlers[i].push(n)}return this},off(e,t){if(!this._eventHandlers)return;if(!e&&!t)return void(this._eventHandlers={});if(e&&!t)return void delete this._eventHandlers[e];let i=this._eventHandlers?.[e];if(i){let e=i.indexOf(t);-1!==e&&i.splice(e,1)}return this},unbind(...e){this.off(...e)},trigger(e,...t){if(this._eventHandlers?.[e])if("string"==typeof e)this._eventHandlers[e].forEach((e=>e.apply(this,t)));else if("object"==typeof e)for(let t in e){let i=t,n=e[t];this._eventHandlers[i].forEach((e=>e.apply(this,n)))}}},d={collection:new Set,add(e){this.collection.add(e)},delete(e){this.collection.delete(e)},get(e){return Array.from(this.collection).find((t=>t.id==e))},getAll(){return this.collection},hasSingleton(){return!!Array.from(this.collection).find((e=>1==e.singleton))}},c=(e,t)=>{if("show"==t){if(d.hasSingleton()&&1!=e.singleton)return;1==e.singleton&&d.getAll().forEach((e=>{e.close()})),d.add(e)}else"hide"==t&&(d.delete(e),1!=e.persistent&&e.remove())},h={promisifyModal(e){const t="string"==typeof e?l(e):e;if(!t)return null;if(1==t.promisify)return t;const i=t.querySelectorAll("[data-modal-btn]");return i.forEach((e=>{e.addEventListener("click",(()=>{t.resolve?.(e.dataset.modalBtn),e.dataset.modalClose&&"manual"==e.dataset.modalClose||t.hide()})),e.setText=t=>(e.innerText=t,e),e.setColor=t=>{switch(t){case"blue":o("$btn","btn-red","btn-white"),a("$btn","btn-blue");break;case"red":o("$btn","btn-blue","btn-white"),a("$btn","btn-red");break;case"white":o("$btn","btn-red","btn-blue"),a("$btn","btn-white")}return e}})),t.getBtn=e=>{const t=Array.from(i).filter((t=>t.dataset.modalBtn==e));return t?.pop()},t.show=e=>(t.style.display="block",t.onshow?.(),t.onswitch?.(t,"show"),e?.(),new Promise(((e,i)=>{t.resolve=e,t.reject=i,t.close=()=>{e("CLOSE"),t.hide()}}))),t.hide=()=>{t.style.display="none",i.forEach((e=>{e.onclick=void 0})),t.onhide?.(),t.onswitch?.(t,"hide")},t.close=t.hide,t.enableBtn=e=>{const i=t.querySelector('[data-modal-btn="'+e+'"]');i&&(i.disabled=!1)},t.disableBtn=e=>{const i=t.querySelector('[data-modal-btn="'+e+'"]');i&&(i.disabled=!0)},t.on=(e,i)=>{switch(e){case"show":t.onshow=i;break;case"hide":t.onhide=i;break;case"switch":t.onswitch=i}return t},t.off=e=>{switch(e){case"show":t.onshow=null;break;case"hide":t.onhide=null;break;case"switch":t.onswitch=null}return t},t.promisify=!0,t},buildTemplate(e){const t=s("div","modal","top-front"),i=s("div","modalWrap");t.appendChild(i);const n=s("div","modal_content");i.appendChild(n);const o=s("div","modalTitle");o.style.display="none",n.appendChild(o),t.getTitleDiv=()=>o;const l=s("div","modalBody","flex-direction-column");l.style.display="none",n.appendChild(l),t.getMsgDiv=()=>l;const r=s("div","modalInfo");r.style.display="none",n.appendChild(r),t.getDetailDiv=()=>r;const d=s("div","modalBtnDiv");return"vertical"==e&&a(d,"flex-direction-column"),n.appendChild(d),t.addBtn=e=>{d.appendChild(e)},t.singleton=!1,t.addBlackout=()=>{t.style.background="rgba(0,0,0,0.5)"},t.removeBlackout=()=>{t.style.background=""},t},buildButton(e){switch(e){case"OK":const t=s("button","btn","btn-md","btn-blue");return t.innerHTML="확 인",t.dataset.modalBtn="OK",t;case"CLOSE":const i=s("button","btn","btn-md","btn-silver");return i.innerHTML="닫 기",i.dataset.modalBtn="CLOSE",i;case"CANCEL":const n=s("button","btn","btn-md","btn-silver");return n.innerHTML="취 소",n.dataset.modalBtn="CANCEL",n;case"DELETE":const o=s("button","btn","btn-md","btn-red");return o.innerHTML="삭 제",o.dataset.modalBtn="DELETE",o;default:const{isPrimary:l,key:r,text:d}=e,c=s("button","btn","btn-md");return a(c,1==l?"btn-blue":"btn-blue-border"),c.innerHTML=d,c.dataset.modalBtn=r,c}},buildModal(e={}){const{btnList:t,direction:i="horizontal",target:n=l("body")}=e,a=this.buildTemplate(i);return t.forEach((e=>a.addBtn(this.buildButton(e)))),a.setTitle=e=>{const t=a.getTitleDiv();t.style.display="",t.innerHTML=e},a.setMsg=e=>{const t=s("div","commonMent");t.innerHTML=e;const i=a.getMsgDiv();i.querySelector(".commonMent")?.remove(),i.style.display="",i.appendChild(t)},a.setDetail=(...e)=>{if(0==e.length)return;const t=s("ul","modalInfo");for(const i of e){const e=s("li");e.innerHTML=i.message?i.message:i,t.appendChild(e)}const i=a.getDetailDiv();i.style.display="",i.appendChild(t)},a.setErrorInfo=(...e)=>{const t=s("ul","modalInfo");for(const i of e){const e=s("li");e.innerHTML=i.message?i.message:i,t.appendChild(e)}a.setDetail(t)},a.persistent=!1,n.appendChild(a),this.promisifyModal(a).on(c)}},m={animations:{doubleBounce:()=>{const e=s("div","sk-double-bounce"),t=s("div","sk-child","sk-double-bounce1"),i=s("div","sk-child","sk-double-bounce2");return e.appendChild(t),e.appendChild(i),e},pulse:()=>s("div","sk-spinner","sk-spinner-pulse"),spinner:()=>{const e=s("div","sk-fading-circle");for(let t=0;t<12;t++){const i=s("div","sk-circle","sk-circle"+(t+1));e.appendChild(i)}return e},foldingCube:()=>{const e=s("div","sk-folding-cube"),t=s("div","sk-cube","sk-cube1"),i=s("div","sk-cube","sk-cube2"),n=s("div","sk-cube","sk-cube3"),a=s("div","sk-cube","sk-cube4");return e.appendChild(t),e.appendChild(i),e.appendChild(a),e.appendChild(n),e}},promisifyModal(e){const t="string"==typeof e?l(e):e;if(!t)return null;if(1==t.promisify)return t;const i=t.querySelectorAll("[data-modal-btn]");return t.show=()=>(a(t,"visible"),o(t,"hidden"),t.onshow?.(),t.onswitch?.(t,"show"),new Promise(((e,n)=>{i.forEach((i=>{i.onclick=()=>{e(i.dataset.modalBtn),t.hide()}})),t.close=()=>{e("CLOSE"),t.hide()}}))),t.hide=()=>{o(t,"visible"),a(t,"hidden"),i.forEach((e=>{e.onclick=void 0})),t.onhide?.(),t.onswitch?.(t,"hide")},t.close=t.hide,t.on=(e,i)=>{switch(e){case"show":t.onshow=i;break;case"hide":t.onhide=i;break;case"switch":t.onswitch=i}return t},t.off=e=>{switch(e){case"show":t.onshow=null;break;case"hide":t.onhide=null;break;case"hide":t.onswitch=null}return t},t.promisify=!0,t},buildTemplate(){const e=s("div","modal","loading-modal","visible"),t=s("div","loading-info-box","m-2");e.appendChild(t);const i=s("div","loading-animation");t.appendChild(i);const n=s("div","loading-text");return t.appendChild(n),e.setAnimation=t=>{const n=this.animations[t]?.();i.appendChild(n),e.animation=n},e.setPosition=t=>{e.style.position=t},e.setText=e=>{n.innerHTML=e},e.setTextColor=e=>{n.style.color=e},e.setAnimationColor=t=>{e.animation.setColor(t)},e.setBackgroundColor=t=>{e.style.backgroundColor=t},e.setBackgroundOpacity=t=>{e.style.opacity=t},e.persistent=!1,e.addBlackout=()=>{e.style.background="rgba(0,0,0,0.5)",o(i,"blackout")},e.removeBlackout=()=>{e.style.background="none",a(i,"blackout")},e},buildLoading(e={}){const{position:t="auto",text:i="",color:n="#fff",opacity:s="0.7",backgroundColor:a="rgb(0,0,0)",animation:r="doubleBounce",target:h=l("body"),blackout:m=!0,isModal:p=!0}=e,u=d.get("loadingModal")?d.get("loadingModal"):this.buildTemplate();return u.setPosition(t),u.setAnimation(r),u.setText(i),u.setTextColor(n),u.setBackgroundColor(a),u.setBackgroundOpacity(s),m?u.addBlackout():u.removeBlackout(),p||o(u,"modal"),h.appendChild(u),this.promisifyModal(u).on("switch",c)}},p={init(){var e;this.target=l("body"),this.persistentMap=new Map,((e=".modal")instanceof HTMLElement?e:n.querySelectorAll(e)).forEach(((e,t)=>{const i=h.promisifyModal(e)?.on("switch",c);if(i){i.persistent=!0;const e=i.id?i.id:"modal"+t;this.persistentMap.set(e,i),i.hide()}}))},persistentModal(e){return this.persistentMap.get(e)},info(e={}){const{id:t="infoModal",title:i="알 림",detail:n,msg:s,singleton:a=!1}=e;console.log("info modal","title",i,"msg",s,"detail",n);const o=h.buildModal({btnList:["OK"]});return o.id=t,o.singleton=a,i&&o.setTitle(i),s&&o.setMsg(s),n&&o.setDetail(...n),o},confirm(e={}){const{id:t="confirmModal",title:i,msg:n,detail:s,delMode:a=!1,singleton:o=!1}=e,l=1==a?["CANCEL","DELETE"]:["CANCEL","OK"],r=h.buildModal({btnList:l});return r.id=t,r.singleton=o,i&&r.setTitle(i),n&&r.setMsg(n),s&&r.setDetail(...s),r},select(e={}){const{id:t="selectModal",title:i,msg:n,select:s=[],singleton:a=!1,direction:o="vertical"}=e;s.push("CLOSE");const l=h.buildModal({btnList:s,direction:o});return l.id=t,l.singleton=a,i&&l.setTitle(i),n&&l.setMsg(n),l},error(e={}){const{id:t="errorModal",singleton:i=!1,response:{status:n,responseText:s,message:a,detail:o,error:l}}=e,r=h.buildModal({btnList:["OK"]});switch(r.id=t,r.singleton=i,n){case 0:r.setTitle("연결 실패"),r.setMsg("서버와의 연결이 끊어졌습니다. 인터넷 연결 상태를 확인하고 다시 시도해주세요."),r.onhide=e=>{location.href="/login"},r.singleton=!0;break;case 500:r.setTitle("500 Internal Server Error"),r.setMsg("서버에서 요청을 처리할 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.");break;case 400:r.setTitle("400 Bad Request"),r.setMsg("요청문에 오류가 있거나 서버가 요청을 이해하지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.");break;case 422:r.setTitle("422 Unprocessable Entity"),r.setMsg("요청에 대해 응답할 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.");break;case 401:r.setTitle("401 Unauthorized"),r.setMsg(s||"인증되지 않은 사용자의 요청입니다. 로그인 페이지로 이동합니다."),r.onhide=e=>{location.href="/login"},r.singleton=!0;break;case 403:r.setTitle("403 Forbidden"),r.setMsg("요청에 대한 권한이 없습니다.");break;case 404:r.setTitle("404 Not Found"),r.setMsg("요청한 페이지를 찾을 수 없습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.");break;case 409:r.setTitle("409 Conflict"),r.setMsg("요청한 서비스가 현재 사용 가능하지 않습니다. 다시 시도해 주세요.");break;default:r.setTitle("잠시 후 다시 시도해주세요"),r.setMsg("서버로부터 올바른 응답을 받지 못했습니다. 지속적으로 발생할 경우 관리자에게 문의해주세요.")}return a&&r.setTitle(a),o&&r.setMsg(o),l&&0!=l.length&&r.setErrorInfo(...l),r},loading(e={}){const{id:t="loadingModal",target:i=this.target}=e;i!==this.target&&(e.blackout=!1,e.isModal=!1);const n=m.buildLoading(e);return n.id=t,n}},u={__proto__:r,init(e={}){const{}=e},promisify:e=>h.promisifyModal(e),info:(e={})=>p.info(e).show(),confirm:(e={})=>p.confirm(e).show(),select:(e={})=>p.select(e).show(),error:(e={})=>p.error(e).show(),startLoading:(e={})=>p.loading(e).show(),endLoading(e={}){d.get("loadingModal")?.hide()},get:e=>p.persistentModal(e),getPopupList:()=>d.getAll(),show:e=>p.persistentModal(e).show(),close(e){const t=d.get(e);t?.close()},closeAll(){d.getAll().forEach((e=>{e.close()}))}};p.init();const g=["success-only","http-errors-only","no-exceptions"];class f{constructor(e={}){const{request:t,param:i,loading:n=!0,debug:s=!0,exception:a=g[1],exceptionModal:o=!0}=e;this.request=t,this.param=i,this.loading=n,this.debug=s,this.exception=a}success(e){return this.successExe=e,this}error(e){return this.errorExe=e,this}finally(e){return this.finallyExe=e,this}async exe(){try{this.loading&&u.startLoading();const e=await this.request(this.param);if(this.loading&&u.endLoading(),this.exception==g[0]&&200!=e.status)throw e;return this.successExe?.(e),e}catch(e){return this.loading&&u.endLoading(),this.debug&&console.log(e),this.exceptionModal&&u.error({response:e}),this.errorExe?.(e),null}finally{this.finallyExe?.()}}}const b=(e={})=>new f(e),y=e=>e.reduce(((e,t)=>e+(t.size?t.size:t.fileSize)),0),T={__proto__:r,update(e={}){const{multiple:t=!0}=e;this.$fileInput.multiple=t},fileInput(){const e=new MouseEvent("click",{bubbles:!1,cancelable:!1});this.$fileInput.dispatchEvent(e)},getFileSize(e){return y(e||this.addedList)},addedList:[],sizeLimit:314572800,uploadLimit:10};T.$fileInput=((e={})=>{const{multiple:t=!0,accept:i=[".pdf",".hwp",".hwpx",".pptx",".ppt",".doc",".docx",".xls",".xlsx",".jpg",".jpeg",".gif",".png",".bmp"]}=e,n=s("input");return n.setAttribute("type","file"),n.setAttribute("accept",i.toString()),n.multiple=t,n.style.display="none",n})({multiple:!0}),T.$fileInput.onchange=e=>{const i=(e=>{let t=Object.values(e.files);return t=t.filter((t=>{const i=t.name;let n=i.lastIndexOf("."),s=i.slice(n+1);return e.accept.includes("."+s)})),t.forEach((e=>{e.isNew=!0,e.fileKey=((e=16)=>((e<1||e>16)&&(e=16),([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))).substring(0,e)))(5),e.originalName=e.name})),e.value="",t})(T.$fileInput);t(i)||T.trigger("added",{files:i,size:y(i),count:i.length})},l("body").appendChild(T.$fileInput);const L=T,v=["fas","fa-cog","fa-spin"],C=["fas","fa-exclamation-triangle","colorRed"],w={MATERIAL:{cls:"kOrigin",state:[[!1,!1,!1],[!1,!0,!1],[!1,!0,!1],[!1,!0,!1],[!1,!0,!0]],icon:[[],C,v,v,[]]},COPY:{cls:"kMydocu",state:[[!0,!1,!1],[!0,!1,!1],[!1,!1,!1],[!1,!1,!1],[!0,!0,!0]],icon:[[],C,v,v,[]]},REPORT:{cls:"kReport",state:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1],[!1,!1,!1],[!1,!0,!0]],icon:[[],C,v,v,[]]},MEMO:{cls:"kMemo",state:[[!0,!1,!1],[!0,!1,!1],[!1,!1,!1],[!1,!1,!1],[!0,!0,!0]],icon:[[],C,v,v,[]]},PHOTO:{cls:"kPicture",state:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1],[!1,!1,!1],[!1,!0,!0]],icon:[[],C,v,v,[]]},VOICE:{cls:"kRecord",state:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1],[!1,!1,!1],[!1,!0,!0]],icon:[[],C,v,v,[]]}},k=document.querySelector("meta[name='_csrf']")?.content,D=document.querySelector("meta[name='_csrf_header']")?.content,M=e=>Object.fromEntries(Object.entries(e).filter((([e,t])=>null!=t))),H=(e,t="GET",i=null,n={},s={})=>{const a=((e,t)=>{const i=new URLSearchParams(M(t)).toString();return i?`${e}?${i}`:e})(e,n),o={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"};k&&D&&!["GET","HEAD","OPTIONS","TRACE"].includes(t.toUpperCase())&&(o[D]=k);const l={method:t,headers:{...o,...s}};return i&&("multipart/form-data"===l.headers["Content-Type"]?(delete l.headers["Content-Type"],l.body=i instanceof FormData?i:new FormData):l.headers["Content-Type"].includes("application/x-www-form-urlencoded")?l.body=i instanceof FormData?i:new URLSearchParams(i).toString():l.body=i&&JSON.stringify(i)),console.log("Request","requestUrl:",a,"data:",i,"Options:",l),fetch(a,l).then((e=>{if(!e.ok)throw e;if("0"===e.headers.get("Content-Length"))return null;const t=e.headers.get("Content-Type");if(!t||!t.includes("application/json"))return e.text();try{return e.json()}catch(e){return null}})).catch((e=>{throw console.error("Fetch error:",e),e}))},S=(e,t={})=>H(e,"GET",null,M(t),{}),Y=(e,{data:t=null,queryParams:i={},headers:n={}}={})=>H(e,"POST",t,M(i),n),E=(e,{data:t=null,queryParams:i={},headers:n={}}={})=>H(e,"PUT",t,M(i),n),N=(e,{data:t=null,queryParams:i={},headers:n={}}={})=>H(e,"DELETE",t,M(i),n),x=e=>{window.location="/api/file/"+e+"/download"},A=e=>{window.location="/meeting/file/"+e+"/download"},I={meetingFileOne:e=>S(`/api/ewp/meeting/file/${e}`),meetingMaterialFileList:e=>S(`/api/ewp/meeting/${e}/file/material/list`),meetingSharedFileList:e=>S(`/api/ewp/meeting/${e}/file/shared/list`),meetingPrivateFileList:e=>S(`/api/ewp/meeting/${e}/file/private/list`),meetingAllFileList:e=>S(`/api/ewp/meeting/${e}/file/all/list`),viewMeetingFileOne:(e={})=>{const{mime:t,link:i}=e;"IMG"==t||"AUDIO"==t?window.open("/meeting/file/"+i+"/view"):window.open("/viewer?file=/meeting/file/"+i+"/view")},downloadOne:x,downloadList:e=>{for(let t=0;t<e.length;t++){let i=e[t];setTimeout((function(){x(i)}),500*t)}},downloadMeetingFileOne:A,downloadMeetingFileList:e=>{for(let t=0;t<e.length;t++){let i=e[t];setTimeout((function(){A(i)}),500*t)}},viewFileOne:(e={})=>{const{fileCategory:t,fileId:i}=e;"IMG"==t?window.open("/api/file/"+i+"/view"):window.open("/viewer?file=/api/file/"+i+"/view")}},B={fileList:(e={})=>{const{fileList:t}=e;return Y("/api/file/list",{data:t,headers:{"Content-Type":"multipart/form-data"}})},meetingFileList:(e={})=>{const{meetingKey:t,fileType:i,fileList:n}=e;return Y(`/api/ewp/meeting/${t}/file/${i}/list`,{data:n,headers:{"Content-Type":"multipart/form-data"}})}},O={meetingFileList:(e={})=>{const{meetingKey:t,fileList:i}=e;return N(`/api/ewp/meeting/${t}/file/list`,{data:i})}},K={__proto__:r,init(e={}){const{editable:t=!0,deletable:i=!0,addConfirm:n=!1,delConfirm:s=!1,autoDisplay:a=!0,sizeLimit:o=314572800,uploadLimit:l=10}=e;return this.editable=t,this.addConfirm=n,this.delConfirm=s,this.deletable=i,this.sizeLimit=o,this.uploadLimit=l,this.oldList=[],this.newList=[],this.setBtnEvt(),console.log("init",this.editable),L.on("added",(async e=>{const{files:t,size:i,count:n}=e;if(this.addConfirm){const e=t.map((e=>e.name));if("OK"!=await u.confirm({title:"파일 업로드",msg:"선택한 파일을 업로드하시겠습니까?",detail:e}))return}const s=L.getFileSize(this.newList),a=n+this.newList.length;i+s>this.sizeLimit?u.info({msg:"업로드 허용 용량을 초과했습니다"}):a>this.uploadLimit?u.info({msg:"업로드 허용 개수를 초과했습니다"}):(this.newList.push(...t),this.setFileBox(t),this.setLimitInfo(),this.trigger("added",{files:t}))})),this},update(e={}){const{editable:t=this.editable,deletable:i=this.deletable,delConfirm:n=this.delConfirm,sizeLimit:s=this.sizeLimit,uploadLimit:a=this.uploadLimit}=e;return this.editable=t,this.delConfirm=n,this.deletable=i,this.sizeLimit=s,this.uploadLimit=a,this},setBtnEvt(){const e=l("#allChk");e&&(e=>{this.switchAllChk=()=>{0==this.getCheckedFileList().length&&(e.checked=!1)},e.onchange=()=>{1==e.checked?this.checkAll():this.uncheckAll(),this.validDownBtn?.(),this.validDelBtn?.()}})(e);const t=l("#fileDownBtn");t&&(t.disabled=!0,(e=>{this.validDownBtn=()=>{const t=this.isSelectedDowloadable();e.disabled=!t},e.onclick=()=>{const e=this.getCheckedFileList();I.downloadMeetingFileList(e.map((e=>e.fileKey)))}})(t));const i=l("#fileDelBtn");i&&(i.disabled=!0,(e=>{this.validDelBtn=()=>{const t=this.isSelectedDeletable();e.disabled=!t},e.onclick=()=>{const e=this.getCheckedFileList();console.log("delete",e)}})(i));const n=l("#fileDeleteAll");n&&(e=>{e.onclick=()=>{this.clearFiles()}})(n);const s=l("#uploadBtn");s&&(s.onclick=()=>{L.fileInput()})},setLimitInfo(){if(0==this.editable)return;const e=L.getFileSize(this.newList),t=this.newList.length,i=l("#fileSize"),n=l("#fileCount");i&&(i.innerHTML=(e=>{if(0==e)return 0;const t=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,t)).toFixed(2)+" "+["Byte","KB","MB","GB","TB","PB"][t]})(e)),n&&(n.innerHTML=t+" 개")},setFiles(e){e&&(this.oldList=[...e],this.newList=[...e],this.clearFileBox(),this.setFileBox(e),this.setLimitInfo())},setFileBox(e){const t=w,i=e=>{const i=s("li");if(e.isNew){const e=s("span","badge","bg-info","mr-1");e.innerHTML="NEW",i.appendChild(e)}else if(e.roleType){const n=s("span","my-auto","mr-2"),a=s("i",...t[e.roleType].icon[e.state+2]);n.appendChild(a),i.appendChild(n)}const n=s("a");if(n.innerHTML=e.originalName?e.originalName:e.uploadedFileName,i.appendChild(n),1==this.deletable){const t=s("span","btn-del","ml-1");t.setAttribute("title","삭제"),n.appendChild(t),t.onclick=async()=>{if(this.delConfirm&&"DELETE"!=await u.confirm({title:"파일 삭제",msg:"해당 파일을 삭제합니다.",detail:["삭제된 파일에 대한 참석자들의 판서 내용도 함께 삭제됩니다."],delMode:!0}))return;i.remove();const t=e.fileKey?e.fileKey:e.fileId;this.deleteFiles(t),this.trigger("deleted",{files:[t]})}}return i},n=e=>{const i=s("tr"),[n,o,l]=t[e.roleType].state[e.state+2];i.deletable=n,i.downloadable=o,i.viewable=l;const r=s("td","text-align-center");i.appendChild(r);const d=s("input");d.type="checkbox",r.appendChild(d);const c=s("td","text-align-center",t[e.roleType].cls);i.appendChild(c);const h=s("div");c.appendChild(h);const m=s("div","tip");h.appendChild(m);const p=s("td","text-align-left");i.appendChild(p);const u=s("div","d-flex","flex-row");p.appendChild(u);const g=s("span","my-auto","mr-2"),f=s("i",...t[e.roleType].icon[e.state+2]);g.appendChild(f),u.appendChild(g);const b=s("span");return b.innerHTML=e.originalName,u.appendChild(b),1==i.viewable?(a(p,"cursor-pointer"),p.onclick=()=>{I.viewMeetingFileOne({mime:e.mimeType,link:e.fileKey})}):a(p,"text-muted"),i.getFile=()=>e,i.isChecked=()=>d.checked,i.check=()=>{d.checked=!0},i.uncheck=()=>{d.checked=!1},d.onchange=()=>{this.switchAllChk?.(),this.validDownBtn?.(),this.validDelBtn?.()},i},o=l("#fileContainer");e.forEach((e=>{const t=this.editable?i(e):n(e);o.appendChild(t)}))},clearFileBox(){l("#fileContainer").innerHTML=""},checkAll(){const e=l("#fileContainer").children;Array.from(e).forEach((e=>{e.check()}))},uncheckAll(){const e=l("#fileContainer").children;Array.from(e).forEach((e=>{e.uncheck()}))},getCheckedFileList(){const e=l("#fileContainer").children;return Array.from(e).filter((e=>e.isChecked())).map((e=>e.getFile()))},isSelectedDowloadable(){const e=l("#fileContainer").children,t=Array.from(e).filter((e=>e.isChecked()));return 0!=t.length&&t.reduce(((e,t)=>e&&t.downloadable),!0)},isSelectedDeletable(){const e=l("#fileContainer").children,t=Array.from(e).filter((e=>e.isChecked()));return 0!=t.length&&t.reduce(((e,t)=>e&&t.deletable),!0)},deleteFiles(...e){this.newList=this.newList.filter((t=>!e.includes(t.fileKey))),this.setLimitInfo()},clearFiles(){this.newList=[],this.setLimitInfo(),this.clearFileBox()},getAddedFiles(){const e=this.oldList.map((e=>e.fileKey));return this.newList.filter((t=>!e.includes(t.fileKey)))},getDeletedFiles(){const e=this.newList.map((e=>e.fileKey));return this.oldList.filter((t=>!e.includes(t.fileKey))).map((e=>e.fileKey))}},P=[{name:"skdKey",input:l("#skdKeyInput"),submit:!0,required:!0,readOnly:!0},{name:"meetingKey",input:l("#meetingKeyInput"),submit:!0,required:!0,readOnly:!0},{name:"writerKey",input:l("#writerKeyInput"),submit:!0,required:!0,readOnly:!0},{name:"writer",input:l("#writerInput"),submit:!1,required:!1,readOnly:!0},{name:"writerTel",input:l("#writerTelInput"),submit:!1,required:!1,readOnly:!0},{name:"skdStatus",input:l("#skdStatusInput"),submit:!1,required:!1,readOnly:!0},{name:"skdComment",input:l("#commentInput"),submit:!1,required:!1,readOnly:!0},{name:"officeCode",input:l("#officeSelect"),submit:!0,required:!0,readOnly:!0},{name:"roomType",input:l("#roomTypeSelect"),submit:!0,required:!0,readOnly:!0},{name:"roomKey",input:l("#roomKeyInput"),submit:!0,required:!0,readOnly:!0},{name:"roomName",input:l("#roomInput"),submit:!1,required:!1,readOnly:!0},{name:"holdingDate",input:l("#holdingDateInput"),submit:!1,nullable:!1,required:!1,readOnly:!1},{name:"endDate",input:l("#endDateInput"),submit:!1,nullable:!1,required:!1,readOnly:!1},{name:"beginTime",input:l("#beginTimeInput"),submit:!1,nullable:!1,required:!1,readOnly:!1},{name:"finishTime",input:l("#finishTimeInput"),submit:!1,nullable:!1,required:!1,readOnly:!1},{name:"beginDateTime",input:l("#beginDateTimeInput"),submit:!0,required:!1,readOnly:!0},{name:"finishDateTime",input:l("#finishDateTimeInput"),submit:!0,required:!1,readOnly:!0},{name:"title",input:l("#titleInput"),submit:!0,nullable:!1,required:!1,readOnly:!1,size:30},{name:"skdHost",input:l("#skdHostInput"),submit:!0,nullable:!1,required:!1,readOnly:!1,size:10},{name:"attendeeCnt",input:l("#attendeeCntInput"),submit:!0,nullable:!0,required:!1,size:100},{name:"contents",input:l("#contentsInput"),submit:!0,nullable:!0,required:!1,readOnly:!1,size:100},{name:"elecYN",input:l("#switchElec"),submit:!0,required:!1,readOnly:!1},{name:"messengerYN",input:l("#switchMessenger"),submit:!0,required:!1,readOnly:!1},{name:"smsYN",input:l("#switchSms"),submit:!0,required:!1,readOnly:!1},{name:"secretYN",input:l("#switchSecret"),submit:!0,required:!1,readOnly:!1},{name:"hostSecuLvl",input:[l("#switchHostSecuLvl"),l("#switchHostDeptSecuLvl")],submit:!0,required:!1,readOnly:!1},{name:"attendeeSecuLvl",input:[l("#switchAttendeeSecuLvl"),l("#switchAttendeeDeptSecuLvl")],submit:!0,required:!1,readOnly:!1}],F=(...e)=>{e.forEach((e=>{e&&("text"==e.type?e.readOnly=!0:e.disabled=!0)}))},q=e=>{if(0==e.length)return null;const t=s("form");return e.forEach((e=>{t.appendChild(e)})),t},R={__proto__:r,init(t={}){const{editable:i=!0}=t;P.forEach((t=>{if(t.generateHidden=()=>{const e=s("input");return e.setAttribute("name",t.name),e.setAttribute("type","hidden"),e.setAttribute("value",t.get()),console.log("generateHidden",t.name,t.get()),e},this[e("update "+t.name)]=e=>{Object.assign(t,e)},!i||t.readOnly){const e=t.input;if(!e)return;Array.isArray(e)?F(...e):F(e)}this.setInput(t)}))},validation:()=>P.filter((e=>e.submit)).filter((e=>!e.isValid())),setInput(e){if(e.input){let t=e.input.type;switch(t||2!=e.input.length||(t="multi-checkbox"),t){case"checkbox":this.setCheckboxInput(e);break;case"multi-checkbox":this.setMultiCheckboxInput(e);break;case"select-one":this.setSelectInput(e);break;case"textarea":case"text":this.setTextInput(e);break;case"hidden":this.setHiddenInput(e);break;default:this.setSpanInput(e)}}},setSelectInput(t){const i=t.input,n=()=>{const e=i.getAttribute("id");l("label[for="+e+"]").innerHTML=i.options[i.selectedIndex].text};this[e("enable "+t.name)]=e=>{i.disabled=!1,t.submit=!0},this[e("disable "+t.name)]=e=>{i.disabled=!0,t.submit=!1},this[e("init "+t.name)]=e=>{i.value=e,t.initial=e,n()},this[e("set "+t.name)]=e=>{i.value=e,n()},t.get=this[e("get "+t.name)]=()=>i.value,t.isChanged=()=>t.get()!=t.initial,t.isValid=()=>!0,i.onchange=()=>{n()}},setCheckboxInput(t){const i=t.input;this[e("enable "+t.name)]=e=>{i.disabled=!1,t.submit=!0},this[e("disable "+t.name)]=e=>{i.disabled=!0,t.submit=!1},this[e("init "+t.name)]=e=>{const n="Y"==e;i.checked=n,t.initial=e,this.trigger("checkboxChange",t)},this[e("switch "+t.name)]=e=>{const n="Y"==e;i.checked=n,this.trigger("checkboxChange",t)},t.get=this[e("get "+t.name)]=()=>1==i.checked?"Y":"N",t.onchange&&(i.onchange=t.onchange),t.isChanged=()=>t.get()!=t.initial,t.isValid=()=>!0,i.onchange=()=>{this.trigger("checkboxChange",t)}},setMultiCheckboxInput(t){const i=t.input[0],n=t.input[1];i&&n&&(this[e("init "+t.name)]=e=>{switch(e){case 1:i.checked=!1,n.checked=!1,t.initial=1;break;case 2:i.checked=!0,n.checked=!1,t.initial=2;break;case 3:i.checked=!0,n.checked=!0,t.initial=3}},this[e("set "+t.name)]=e=>{switch(e){case 1:i.checked=!1,n.checked=!1;break;case 2:i.checked=!0,n.checked=!1;break;case 3:i.checked=!0,n.checked=!0}},t.get=this[e("get "+t.name)]=()=>{let e=1;return i.checked&&(e+=1),n.checked&&(e+=1),e},t.isChanged=()=>t.get()!=t.initial,t.isValid=()=>!0)},setTextInput(n){const s=n.input;n.initial="",this[e("enable "+n.name)]=e=>{s.readOnly=!1,s.disabled=!1,n.submit=!0},this[e("disable "+n.name)]=e=>{s.readOnly=!0,s.disabled=!0,s.onclick=null,n.submit=!1},this[e("writable "+n.name)]=e=>{s.readOnly=e},this[e("init "+n.name)]=e=>{t(e)||(s.value=i(e),n.initial=e,this.trigger("textInput",n))},this[e("set "+n.name)]=e=>{t(e)||(s.value=i(e),this.trigger("textInput",n))},this[e("clear "+n.name)]=()=>{s.value="",this.trigger("textInput",n)},n.get=this[e("get "+n.name)]=()=>s.value,n.isChanged=()=>n.get()!=n.initial,n.isValid=()=>0!=n.nullable||!t(n.get()),s.oninput=()=>{this.trigger("textInput",n)},s.onchange=()=>{this.trigger("textInput",n)}},setSpanInput(t){const i=t.input;t.initial="",this[e("init "+t.name)]=e=>{i.innerHTML=e,t.initial=e},this[e("set "+t.name)]=e=>{i.innerHTML=e},t.get=this[e("get "+t.name)]=()=>i.innerHTML,t.isChanged=()=>i.innerHTML!=t.innerHTML,t.isValid=()=>!0},setHiddenInput(t){const i=t.input;this[e("init "+t.name)]=e=>{i.value=e},this[e("set "+t.name)]=e=>{i.value=e},t.get=this[e("get "+t.name)]=()=>i.value,t.isChanged=()=>!!i.value,t.isValid=()=>!0},getForm(){const e=P.filter((e=>e.submit&&e.isValid())).map((e=>e.generateHidden()));return q(e)},getChangedForm(){const e=P.filter((e=>e.submit&&(e.required||e.isChanged()))).map((e=>e.generateHidden()));return q(e)}},_=e=>S(`/api/ewp/dept/${e}/sub`),U={Get:{deptOne:e=>S(`/api/ewp/dept/${e}`),subDeptList:_,userList:(e={})=>{const{officeCode:t,deptId:i,deptName:n,userKey:s,userName:a}=e;return S("/api/ewp/user/list",{officeCode:t,deptId:i,deptName:n,userName:a})},subDeptList:_,userAuthorityForMeeting:e=>S(`/api/ewp/user/authority/meeting/${e}`),adminAuthorityForMeeting:e=>S(`/api/ewp/admin/authority/meeting/${e}`),approvalManagerPublicList:(e={})=>{const{officeCode:t,roomType:i}=e;return S("/api/ewp/public/roster/approval-manager/list",{officeCode:t,roomType:i})}},Post:{switchUserAuthenticationToken:(e={})=>{const{userId:t,loginType:i}=e;return Y(`/api/ewp/dev/switch-authentication/user/${t}/loginType/${i}`)}},Put:{},Delete:{}},z="50001253",V=[{__proto__:r,name:"tree",title:"조직도",id:"user_tree",parentCode:z,nowLevel:-1,generateNav(){const e=s("li");return this.$nav=e,e.id=this.id+"-tab",e.innerHTML=this.title,e},generateTab(){const e=s("div","partSelectDiv","flex-column");this.$tab=e,e.id=this.id;const t=[{name:"사업부",text:"사업부선택"},{name:"부서",text:"부서선택"},{name:"팀",text:"팀선택"}],i=(e,t)=>{const i=s("option");return i.value=e,i.innerHTML=t,i},n=e=>{const n=t[e],s=n.node;s.innerHTML="",s.disabled=!0;const a=i(0,n.text);a.style.display="none",s.appendChild(a)},a=e=>{n(this.nowLevel);const s=t[this.nowLevel].node;0!=e.length&&(e.forEach((e=>{const{deptId:t,deptName:n}=e,a=i(t,n);s.appendChild(a)})),s.disabled=!1)},o=async()=>{const e=this.parentCode;this.nowLevel+=1;const t=await U.Get.subDeptList(e);a(t)};return t.forEach(((t,i)=>{const a=s("div","d-flex","flex-row"),l=s("select");t.node=l,a.appendChild(l),e.appendChild(a),l.onchange=async()=>{const e=l.value;if(this.nowLevel>i)for(let e=i+1;e<=this.nowLevel;e++)n(e);this.nowLevel=i,this.parentCode=e,2!=this.nowLevel&&await o(),this.trigger("search",{deptId:e})},n(i)})),o(),this.clear=()=>{t.forEach(((e,t)=>{n(t)})),this.parentCode=z,this.nowLevel=-1,o()},this.setDeptList=e=>{a(e)},e},open(){a(this.$nav,"active"),a(this.$tab,"d-flex"),o(this.$tab,"d-none")},close(){o(this.$nav,"active"),o(this.$tab,"d-flex"),a(this.$tab,"d-none")}},{__proto__:r,name:"text",title:"직원검색",id:"user_search",generateNav(){const e=s("li");return this.$nav=e,e.id=this.id+"-tab",e.innerHTML=this.title,e},generateTab(){const e=s("div","singleSrchDiv","d-flex");this.$tab=e,e.id=this.id;const t=s("div","inputBox");e.appendChild(t);const i=s("input");t.appendChild(i),i.type="text",i.setAttribute("placeholder","이름을 입력해주세요"),i.maxLength=10,i.oninput=()=>{((e,t={})=>{e.value.length>=e.maxLength&&(t.returnValue=!1),e.value=e.value.replace(/[ \{\}\[\]\/?.,;:|\)*~`!^\-_+┼<>@\#$%&\'\"\\\(\=]/gi,"")})(i)},i.onkeyup=e=>{13==e.keyCode&&this.search()};const n=s("div","srchBtn");e.appendChild(n);const a=s("i","far","fa-search");return a.onclick=()=>{this.search()},n.appendChild(a),this.clear=()=>{i.value=""},this.search=()=>{const e=i.value;e&&""!=e&&this.trigger("search",{searchText:e,nameplate:!0})},e},open(){a(this.$nav,"active"),a(this.$tab,"d-flex"),o(this.$tab,"d-none")},close(){o(this.$nav,"active"),o(this.$tab,"d-flex"),a(this.$tab,"d-none")}}],j={getUserBook(){return this.userBook||(this.userBook={}),this.userBook},addUser(e){this.getUserBook()[e.userKey]=e},addUserList(e){const t=this.getUserBook();e.forEach((e=>{t[e.userKey]=e}))},deleteUserList(e){const t=this.getUserBook();e.forEach((e=>{delete t[e]}))},getUserByKey(e){return this.getUserBook()[e]}},G={init(e={}){const{officeCode:t,enableTab:i=["tree","text"],selectType:n="checkbox",checked:s=[],disabled:a=[]}=e;this.enableTab=i,this.officeCode=t,this.selectedList=[],this.checked=s,this.disabled=a,this.selectType=n,this.$modal?this.reset():this.generate()},reset(){this.clearTab(),this.clearUserSearchResultList(),this.clearAttendList()},generate(){this.$modal=s("div","modal"),this.$modal.id="addUserModal",this.$modal.style.display="none";const e=s("div","modalWrap"),i=s("div","modal_content"),n=s("div","modalBody","flex-direction-column");this.$modal.appendChild(e),e.appendChild(i),i.appendChild(n),(()=>{const e=s("ul","addUserTabDiv");n.appendChild(e);const t=s("div","px-3","pt-3","d-flex","flex-column");n.appendChild(t),this.selectTab=e=>{const t=V[e];V.forEach((e=>{e.isEnable&&e.close()})),this.clearTab(),this.clearUserSearchResultList(),t.open()},V.forEach(((i,n)=>{if(this.enableTab.includes(i.name)){i.isEnable=!0;const s=i.generateNav();e.appendChild(s),i.nav=s;const a=i.generateTab();t.appendChild(a),s.onclick=()=>{this.selectTab(n)}}else i.isEnable=!1})),this.clearTab=()=>{V.forEach(((e,t)=>{e.isEnable&&e.clear()}))}})(),(()=>{const e=s("div","px-3","pt-1","d-flex","flex-column");n.appendChild(e);const i=s("div","d-flex","flex-column","overflow-hidden","border","rounded","border-third","p-1");i.style.minHeight="10rem",i.style.maxHeight="20rem",e.appendChild(i);const o=s("div","d-flex","flex-row","border-bottom","pb-1"),l=s("div","pt-1","overflow-auto");(()=>{i.appendChild(o);const e=s("input");e.id="allChk",e.type="checkbox",e.style.visibility="hidden";const t=s("label","ml-2","my-auto");t.htmlFor="allChk",t.style.visibility="hidden",t.innerHTML="전체",o.appendChild(e),o.appendChild(t);const n=s("div","ml-auto","my-auto");o.appendChild(n);const a=s("span");n.appendChild(a);const l=s("span","mx-1");l.innerHTML="/",n.appendChild(l);const r=s("span");n.appendChild(r),e.onchange=()=>{const t=e.checked;this.getSearchResultList().forEach((e=>{const i=e.querySelector("input");if(0==i.disabled&&i.checked!=t){const e=new MouseEvent("click",{bubbles:!1,cancelable:!1});i.dispatchEvent(e)}}))},this.setAllUserCnt=()=>{const i=this.getSearchResultList().length;r.innerHTML=i,o.dataset.allCnt=i,0==i||"radio"==this.selectType?(e.style.visibility="hidden",t.style.visibility="hidden"):(e.style.visibility="visible",t.style.visibility="visible"),this.setSelectableUserCnt()},this.setSelectableUserCnt=()=>{const t=this.getSearchResultList().filter((e=>0==e.querySelector("input").disabled)).length;o.dataset.selectableCnt=t,o.dataset.disabledCnt=o.dataset.allCnt-t,0==t||"radio"==this.selectType?e.style.visibility="hidden":e.style.visibility="visible"},this.setSelectedUserCnt=()=>{const t=this.getSearchResultList().filter((e=>1==e.querySelector("input").checked)),i=t.length,n=t.filter((e=>0==e.querySelector("input").disabled)).length;a.innerHTML=i,o.dataset.selectedCnt=i,o.dataset.nowSelectedCnt=n,o.dataset.selectableCnt==n?(e.checked=!0,e.indeterminate=!1):0==n?(e.checked=!1,e.indeterminate=!1):(e.checked=!1,e.indeterminate=!0)}})(),(()=>{i.appendChild(l),this.getSearchResultList=()=>{const e=l.querySelectorAll("li");return Array.from(e)}})();const r=s("div","selectedUserDiv","border","rounded","border-third","overflow-auto","empty-hidden");r.style.maxHeight="10rem",e.appendChild(r);const d=e=>{const t=[];this.selectedList.forEach((i=>{if(e&&i.userKey!=e)t.push(i);else{const e=l.querySelector("#user"+i.userKey);e&&(e.checked=!1);const t=r.querySelector("#attend"+i.userKey);t&&t.remove()}})),this.selectedList=t,this.setSelectedUserCnt()};this.clearUserSearchResultList=()=>{l.innerHTML="",this.setAllUserCnt(),this.setSelectedUserCnt()},this.clearAttendList=()=>{this.selectedList=[],r.innerHTML=""};const c=(e,t)=>{const i=s("div","attend");i.id="attend"+e;const n=s("span");n.innerHTML=t,i.appendChild(n);const a=s("div","btn-del");a.setAttribute("title","삭제"),i.appendChild(a),a.onclick=()=>{d(e)},r.appendChild(i),this.setSelectedUserCnt()},h=(e,t,i)=>{const n=s("li","d-flex","my-2"),o=s("input");o.name="user",o.type=this.selectType,o.value=t,o.id="user"+t,n.appendChild(o);const r=s("label","ml-2","my-auto");r.innerHTML=i,r.htmlFor="user"+t,n.appendChild(r),l.appendChild(n),this.checked.includes(t)&&(o.checked=!0,"checkbox"==this.selectType&&(o.disabled=!0)),this.disabled.includes(t)&&(o.disabled=!0,a(n,"disabled")),this.selectedList.map((e=>e.userKey)).includes(t)&&(o.checked=!0),o.onchange=()=>{1!=o.disabled&&(1==o.checked?("radio"==this.selectType&&d(),this.selectedList.push({userKey:t,deptId:e,nameplate:i}),c(t,i)):d(t))}};V.forEach(((e,i)=>{e.on("search",(async e=>{const{deptId:i,searchText:n,nameplate:s=!1}=e,a=await U.Get.userList({officeCode:this.officeCode,deptId:i,userName:n});this.clearUserSearchResultList(),t(a)||(j.addUserList(a),a.forEach((e=>{h(e.deptId,e.userKey,s?e.nameplate:e.userName)})),this.setAllUserCnt(),this.setSelectedUserCnt())}))}))})(),(()=>{const e=s("div","modalBtnDiv");i.appendChild(e);const t=s("div","btn","btn-md","btn-silver");t.innerHTML="취 소",this.getCancelBtn=()=>t,e.appendChild(t);const n=s("div","btn","btn-md","btn-blue");n.innerHTML="확 인",this.getConfirmBtn=()=>n,e.appendChild(n)})(),this.selectTab(0),l("body").appendChild(this.$modal)},destroy(){this.$modal.remove(),delete this.$modal,this.selectedList=[]},update(e={}){this.init(e)},show(){this.$modal||this.init(),this.$modal.style.display="block"},hide(){this.reset(),this.$modal.style.display="none"},getSelectedList(){return this.selectedList}},W={__proto__:r,init(e={}){const{onchange:t}=e;return G.init(e),G.getConfirmBtn().onclick=()=>{const e=G.getSelectedList();G.hide(),e.length>0&&(this.trigger("change",e),t?.(e))},G.getCancelBtn().onclick=()=>{G.hide()},this},update(e={}){return this.init(e)},show(){G.show()},getUser:e=>j.getUserByKey(e)},J=()=>[{role:"HOST",selectbox:"radio",btnList:document.querySelectorAll("button[data-btn=hostBtn]"),nodeDiv:document.querySelector("#hostDiv")},{role:"ATTENDEE",selectbox:"checkbox",btnList:document.querySelectorAll("button[data-btn=attendeeBtn]"),nodeDiv:document.querySelector("#attendeeDiv")},{role:"OBSERVER",selectbox:"checkbox",btnList:document.querySelectorAll("button[data-btn=observerBtn]"),nodeDiv:document.querySelector("#observerDiv")}],Q={__proto__:r,async init(e={}){const{officeCode:t="1000",maxSize:i=100,editable:n=!0}=e;this.editable=n,this.setBtn(),this.newList=[],this.oldList=[],n&&W.init({officeCode:t})},validation(){return this.newList.filter((e=>"HOST"==e.attendRole)).length>0},update(e={}){const{editable:t=this.editable}=e;this.editable=t},setBtn(){J().forEach((e=>{e.btnList.forEach((t=>{t.onclick=()=>{const{selected:t,disabled:i}=((e,t)=>{const i=[],n=[];return e.forEach((e=>{e.attendRole==t?i.push(e.userKey):n.push(e.userKey)})),{selected:i,disabled:n}})(this.newList,e.role);this.show({selectType:e.selectbox,checked:t,disabled:i,role:e.role})}}))}))},initAttendeeList(e){J(),this.oldList=e,this.newList=[...this.oldList],this.displayAttendeeList()},setAttendeeList(e){e.forEach((e=>{"HOST"==e.attendRole&&this.deleteRole("HOST"),this.newList.push(e)})),this.displayAttendeeList()},clearAttendeeList(){this.newList=[],this.displayAttendeeList()},displayAttendeeList(){const e=this.newList,t={};J().forEach((e=>{e.nodeDiv&&(t[e.role]={nodeDiv:e.nodeDiv,isDeletable:"HOST"!=e.role},e.nodeDiv.innerHTML="")}));const i=(e,t)=>{console.log("createUserElem",e);const i=s("div","attend"),n=s("span");if(n.innerHTML=e.nameplate,i.appendChild(n),this.editable&&t){const t=s("div","btn-del");t.setAttribute("title","삭제"),i.appendChild(t),t.onclick=()=>{this.deleteUser(e.userKey),this.trigger("change",this.getSelectedSize()),i.remove()}}return i};e.forEach((e=>{const n=t[e.attendRole],s=i(e,n.isDeletable);"HOST"==e.attendRole&&(n.nodeDiv.innerHTML=""),n.nodeDiv.appendChild(s),this.trigger("change",this.getSelectedSize())}))},async show(e={}){const{selectType:t="checkbox",checked:i,disabled:n,role:s}=e;W.update({selectType:t,checked:i,disabled:n}),W.unbind("change"),W.on("change",(e=>{e.forEach((e=>{e.attendRole=s})),this.setAttendeeList(e)})),W.show()},getSelectedSize(){return this.newList.length},deleteUser(e){return this.newList=this.newList.filter((t=>t.userKey!=e)),this.newList.length},deleteRole(e){return this.newList=this.newList.filter((t=>t.attendRole!=e)),this.newList.length},getChangeResult(){const e=[],t=[];this.newList.forEach((i=>{let n=e;for(const[e,s]of this.oldList.entries())if(s.userKey==i.userKey){if(this.oldList.splice(e,1),s.attendRole!=i.attendRole){n=t;break}n=null;break}n?.push(i)}));const i=this.oldList;return{insertList:e,updateList:t,deleteList:i}}},X={async init(e={}){this.initInputHandler(e),this.initFileHandler(e)},initInputHandler(e={}){const{editable:t=!0}=e;this.editable=t,R.init({editable:t}),t&&Z.init({openTime:OPEN_TIME,closeTime:CLOSE_TIME,interval:INTERVAL_MINUTE}),R.on("textInput",(e=>{const t=e.name;if("holdingDate"==t||"beginTime"==t||"finishTime"==t)return void((e,t={})=>{e.value.length>=e.maxLength&&(t.returnValue=!1),e.value=e.value.replace(/[\ㄱ-ㅎㅏ-ㅣ가-힣]/g,"")})(e.input);if("attendeeCnt"==t)return void((e,t={})=>{e.value.length>=e.maxLength&&(t.returnValue=!1),e.value=e.value.replace(/[^0-9]/g,"").replace(/(\..*)\./g,"$1"),e.value=e.value.replace(" ","")})(e.input);"skdHost"==t&&((e,t={})=>{e.value.length>=e.maxLength&&(t.returnValue=!1)})(e.input);const i=e.input,n=e.size,s=l("#"+t+"Length");n&&s&&(s.innerHTML=i.value.length+"/"+n)})),R.on("checkboxChange",(e=>{const t=e.name,i=e.input.checked;switch(t){case"elecYN":1==i?($(".scheduleWriteDiv").addClass("elect"),R.writableAttendeeCnt(!0)):($(".scheduleWriteDiv").removeClass("elect"),R.writableAttendeeCnt(!1));break;case"secretYN":1==i?($(".secuMoff").hide(),$(".secuMon").show()):($(".secuMoff").show(),$(".secuMon").hide())}}))},getInputHandler:()=>R,initAttendeeHandler(e={}){const{officeCode:t="1000",editable:i=!0}=e;Q.init({officeCode:t,editable:i}),Q.on("change",(e=>{R.setAttendeeCnt(e)}))},initFileHandler(e={}){const{editable:t=!0,deletable:i=!0}=e;K.init({editable:t,deletable:i})},initHiddenParam(e){null!=e&&(R.initSkdKey?.(e.skdKey),R.initMeetingKey?.(e.meetingKey))},initStatusParam(e={}){const{appStatus:t="REQUEST",appComment:i=""}=e,n=document.querySelector(".statusRow");switch(t){case"REQUEST":a(n,"s0");break;case"APPROVED":a(n,"s1");break;case"CANCELED":a(n,"s4");break;case"REJECTED":a(n,"s5")}R.initSkdComment?.(i)},initRoomParam(e){null!=e&&(R.initOfficeCode(e.officeCode),R.initRoomType(e.roomType),R.initRoomKey?.(e.roomKey),R.initRoomName(e.roomName),this.getRoomParam=()=>({officeCode:R.getOfficeCode(),roomType:R.getRoomType(),roomKey:R.getRoomKey()}))},initScheduleParam(e={}){let{holdingDate:t,beginTime:i,finishTime:n,beginDateTime:s,finishDateTime:a,skdHost:o,attendeeCnt:l}=e;i=s?moment(s).format("HH:mm"):i,n=a?moment(a).format("HH:mm"):n,t&&(R.initHoldingDate(t),R.initEndDate?.(t)),i&&R.initBeginTime(i),n&&R.initFinishTime(n);const r=moment(t+"T"+i,"YYYY-MM-DDTHH:mm:ss"),d=moment(t+"T"+n,"YYYY-MM-DDTHH:mm:ss");R.initBeginDateTime?.(r.format("YYYY-MM-DDTHH:mm:ss")),R.initFinishDateTime?.(d.format("YYYY-MM-DDTHH:mm:ss")),R.initSkdHost(o),R.initAttendeeCnt(l),this.editable&&Z.setTimeLimit()},setScheduleParam(e={}){let{holdingDate:t=R.getHoldingDate(),beginTime:i,finishTime:n,beginDateTime:s,finishDateTime:a,skdHost:o,attendeeCnt:l}=e;i=s?moment(s).format("HH:mm"):i,n=a?moment(a).format("HH:mm"):n,t&&(R.setHoldingDate(t),R.setEndDate?.(t)),i&&R.setBeginTime(i),n&&R.setFinishTime(n);const r=moment(t+"T"+i,"YYYY-MM-DDTHH:mm:ss"),d=moment(t+"T"+n,"YYYY-MM-DDTHH:mm:ss");R.setBeginDateTime?.(r.format("YYYY-MM-DDTHH:mm:ss")),R.setFinishDateTime?.(d.format("YYYY-MM-DDTHH:mm:ss")),R.setSkdHost(o),R.setAttendeeCnt(l),this.editable&&Z.setTimeLimit()},setDateTimeInput(e={}){const{holdingDate:t=R.getHoldingDate()}=e;R.setHoldingDate(t),Z.setDateTimeInput()},initMeetingParam(e={}){const{title:t,contents:i,elecYN:n,messengerYN:s,mailYN:a,smsYN:o,secretYN:l,hostSecuLvl:r,attendeeSecuLvl:d,observerSecuLvl:c}=e;R.initTitle(t),R.initContents(i),R.initElecYN?.(n),R.initMessengerYN?.(s),R.initMailYN?.(a),R.initSmsYN?.(o),R.initSecretYN?.(l),R.initHostSecuLvl?.(r),R.initAttendeeSecuLvl?.(d),R.initObserverSecuLvl?.(c)},setMeetingParam(e){const{title:t=R.getTitle(),contents:i=R.getContents(),elecYN:n=R.getElecYN(),messengerYN:s=R.getMessengerYN(),mailYN:a=R.getMailYN(),smsYN:o=R.getSmsYN(),secretYN:l=R.getSecretYN(),hostSecuLvl:r=R.getHostSecuLvl(),attendeeSecuLvl:d=R.getAttendeeSecuLvl(),observerSecuLvl:c=R.getObserverSecuLvl()}=e;R.setTitle(e.title),R.setContents(e.contents),R.switchElecYN?.(e.elecYN),R.switchMessengerYN?.(e.messengerYN),R.switchMailYN?.(e.mailYN),R.switchSmsYN?.(e.smsYN),R.switchSecretYN?.(e.secretYN),R.setHostSecuLvl?.(e.hostSecuLvl),R.setAttendeeSecuLvl?.(e.attendeeSecuLvl),R.setObserverSecuLvl?.(e.observerSecuLvl)},initWriterParam(e){null!=e&&(R.initWriter(e.nameplate),R.initWriterTel(e.officeDeskPhone))},initAttendeeParam(e){Q.initAttendeeList(e)},setAttendeeParam(e){Q.setAttendeeList(e)},clearAttendeeParam(){Q.clearAttendeeList()},setFiles(e){K.setFiles(e)},getAddedFiles:()=>"Y"==R.getElecYN()?K.getAddedFiles():null,getDeletedFiles:()=>"Y"==R.getElecYN()?K.getDeletedFiles():null,getInputParam:()=>R.getForm(),getChangedInputParam:()=>R.getChangedForm(),getAttendeeParam:()=>"Y"==R.getElecYN()?Q.getChangeResult():null,validation(){const e=R.validation(),t={valid:!0};if(0!=e.length)switch(t.valid=!1,e[0].name){case"title":t.msg="제목을 입력해 주세요.";break;case"skdHost":t.msg="주관자를 입력해 주세요."}return"Y"==R.getElecYN()&&(Q.validation()||(t.valid=!1,t.msg="회의 진행자를 선택해 주세요.")),t}},Z={init(e={}){const{openTime:t,closeTime:i,interval:n}=e;this.openTime=t,this.closeTime=i,this.minTime=t,this.maxTime=i,this.interval=n,this.$holdingDate=l("#holdingDateInput"),this.$endDate=l("#endDateInput"),this.$beginTime=l("#beginTimeInput"),this.$finishTime=l("#finishTimeInput");const s=moment().format("YYYY-MM-DD");this.setHoldingDatePicker(),this.setBeginTimePicker(),this.setFinishTimePicker(),this.setDateTimeInput(),this.$holdingDate.value=s,this.$beginTime.value=this.minTime,this.$finishTime.value=this.maxTime,this.$holdingDate.onkeydown=e=>(e.preventDefault(),!1),this.$beginTime.onkeydown=e=>(e.preventDefault(),!1),this.$finishTime.onkeydown=e=>(e.preventDefault(),!1),this.setTimeLimit(),this.$endDate&&(this.setEndDatePicker(),this.$endDate.value=s,this.$endDate.onkeydown=e=>(e.preventDefault(),!1))},setHoldingDatePicker(){const e=moment().format("YYYY-MM-DD");$("#datepicker").datepicker({dateFormat:"yy-mm-dd",minDate:this.$holdingDate.value}),l("#holdingDateDiv").onclick=async()=>{$("#datepicker").datepicker("option","minDate",e);const t=R.getEndDate?.();if(1!=this.$holdingDate.disabled){const e=R.getHoldingDate();if(1==moment(e).isValid()&&$("#datepicker").datepicker("setDate",e),"OK"==await u.get("datePickerModal").show()){const e=$("#datepicker").datepicker("getDate"),i=moment(e),n=i.format("YYYY-MM-DD");t&&i.isAfter(t)&&R.setEndDate(n),R.setHoldingDate(n),this.setDateTimeInput(),this.setTimeLimit()}}}},setEndDatePicker(){const e=moment().format("YYYY-MM-DD");$("#datepicker").datepicker({dateFormat:"yy-mm-dd",minDate:this.$endDate.value}),l("#endDateDiv").onclick=async()=>{$("#datepicker").datepicker("option","minDate",e);const t=R.getEndDate();if(1!=this.$endDate.disabled){const e=R.getEndDate();if(1==moment(e).isValid()&&$("#datepicker").datepicker("setDate",e),"OK"==await u.get("datePickerModal").show()){const e=$("#datepicker").datepicker("getDate"),i=moment(e),n=i.format("YYYY-MM-DD");i.isBefore(t)&&R.setHoldingDate(n),R.setEndDate(n),this.setDateTimeInput(),this.setTimeLimit()}}}},setTimeLimit(){const e=R.getHoldingDate(),t=moment(),i=t.minute();t.minutes(Math.floor(i/this.interval)*this.interval),t.format("YYYYMMDD"),moment(e).format("YYYYMMDD"),this.minTime=this.openTime,this.setBeginTimePicker(),this.setFinishTimePicker()},setBeginTimePicker(){if(!this.beginTimePickerInit)return this.beginTimePickerInit=!0,$(this.$beginTime).timepicker({step:this.interval,timeFormat:"H:i"}),$(this.$beginTime).on("changeTime",(()=>{this.setFinishTimePicker(),this.setDateTimeInput()})),void setTimeout((()=>{this.setBeginTimePicker()}));const e=moment(this.minTime,"HH:mm"),t=moment(this.maxTime,"HH:mm").add(-1*this.interval,"m");let i=moment(this.$beginTime.value,"HH:mm");const n=moment(this.$finishTime.value,"HH:mm");(i.isAfter(n)||i.isSame(n))&&(this.$beginTime.value=n.add(-1*this.interval,"m").format("HH:mm")),i=moment(this.$beginTime.value,"HH:mm"),i.isBefore(e)&&(this.$beginTime.value=this.minTime),$(this.$beginTime).timepicker("option",{minTime:e.format("hh:mm A"),maxTime:t.format("hh:mm A")})},setFinishTimePicker(){if(!this.finishTimePickerInit)return this.finishTimePickerInit=!0,$(this.$finishTime).timepicker({step:this.interval,timeFormat:"H:i"}),$(this.$finishTime).on("changeTime",(()=>{this.setBeginTimePicker(),this.setDateTimeInput()})),void setTimeout((()=>{this.setFinishTimePicker()}));const e=moment(this.minTime,"HH:mm").add(this.interval,"m"),t=moment(this.maxTime,"HH:mm"),i=moment(this.$beginTime.value,"HH:mm");let n=moment(this.$finishTime.value,"HH:mm");(n.isBefore(i)||n.isSame(i))&&(this.$finishTime.value=i.add(this.interval,"m").format("HH:mm")),n=moment(this.$finishTime.value,"HH:mm"),n.isAfter(t)&&(this.$finishTime.value=this.maxTime),$(this.$finishTime).timepicker("option",{minTime:e.format("hh:mm A"),maxTime:t.format("hh:mm A")})},setDateTimeInput(){const e=this.$holdingDate.value,t=this.$beginTime.value,i=this.$finishTime.value,n=moment(e+"T"+t,"YYYY-MM-DDTHH:mm:ss"),s=moment(e+"T"+i,"YYYY-MM-DDTHH:mm:ss");R.setBeginDateTime(n.format("YYYY-MM-DDTHH:mm:ss")),R.setFinishDateTime(s.format("YYYY-MM-DDTHH:mm:ss"))}},ee={roomOne:(e={})=>{const{roomType:t,roomKey:i}=e;return S(`/api/ewp/room/${t}/${i}`)},roomList:(e={})=>{const{officeCode:t,roomType:i="ALL_ROOM",rentYN:n,delYN:s}=e;return S(`/api/ewp/admin/system/room/${i}/list`,{officeCode:t,rentYN:n,delYN:s})},rentableList:(e={})=>{const{officeCode:t,roomType:i}=e;return S(`/api/ewp/room/${i}/rentable/list`,{officeCode:t})},publicListForDisplay:(e={})=>{const{officeCode:t,roomType:i}=e;return S(`/api/ewp/public/room/${i}/display/list`,{officeCode:t})},roomPermissionList:e=>{const{roomType:t,roomKey:i}=e;return S(`/api/ewp/admin/system/room/${t}/${i}/permission/list`)}},te={Get:{assignOne:e=>S(`/api/ewp/meeting/assign/${e}`,{skdKey:e}),assignList:(e={})=>{const{officeCode:t,approvalStatus:i,roomType:n,roomKey:s,title:a,host:o,attendeeName:l,elecYN:r,secretYN:d,startDate:c,endDate:h,pageNo:m,pageCnt:p,orderColumn:u,orderDirection:g="ASC"}=e;return S("/api/ewp/meeting/assign/list",{officeCode:t,approvalStatus:i,roomType:n,roomKey:s,title:a,host:o,attendeeName:l,elecYN:r,secretYN:d,startDate:c,endDate:h,pageNo:m,pageCnt:p,orderColumn:u,orderDirection:g})},assignListCnt:(e={})=>{const{officeCode:t,approvalStatus:i,roomType:n,roomKey:s,title:a,host:o,attendeeName:l,elecYN:r,secretYN:d,startDate:c,endDate:h,pageNo:m,pageCnt:p}=e;return S("/api/ewp/meeting/assign/list/cnt",{officeCode:t,approvalStatus:i,roomType:n,roomKey:s,title:a,host:o,attendeeName:l,elecYN:r,secretYN:d,startDate:c,endDate:h,pageNo:m,pageCnt:p})},assignListForPlanned:(e={})=>{const{startDate:t,endDate:i}=e;return S("/api/ewp/meeting/assign/planned/list",{startDate:t,endDate:i})},assignStatForPlanned:(e={})=>{const{startDate:t,endDate:i}=e;return S("/api/ewp/meeting/assign/planned/stat",{startDate:t,endDate:i})},assignListForRegister:(e={})=>{const{pageNo:t,pageCnt:i}=e;return S("/api/ewp/meeting/assign/register/list",{pageNo:t,pageCnt:i})},assignListForDisplay:(e={})=>{const{officeCode:t,roomType:i,roomKey:n,startDate:s,endDate:a}=e;return S("/api/ewp/meeting/assign/display/list",{officeCode:t,roomType:i,roomKey:n,startDate:s,endDate:a})},assignPublicListForDisplay:(e={})=>{const{officeCode:t,roomType:i,roomKey:n,startDate:s,endDate:a}=e;return S("/api/ewp/public/meeting/assign/display/list",{officeCode:t,roomType:i,roomKey:n,startDate:s,endDate:a})},userArchiveList:(e={})=>{const{skdHost:t,title:i,originalName:n,roleType:s,startDate:a,endDate:o,pageNo:l,pageCnt:r}=e;return S("/api/ewp/meeting/archive/manage/user",{skdHost:t,title:i,originalName:n,roleType:s,startDate:a,endDate:o,pageNo:l,pageCnt:r})},deptArchiveList:(e={})=>{const{skdHost:t,title:i,originalName:n,startDate:s,endDate:a,pageNo:o,pageCnt:l}=e;return S("/api/ewp/meeting/archive/manage/dept",{skdHost:t,title:i,originalName:n,startDate:s,endDate:a,pageNo:o,pageCnt:l})},adminArchiveList:(e={})=>{const{skdHost:t,title:i,originalName:n,startDate:s,endDate:a,pageNo:o,pageCnt:l}=e;return S("/api/ewp/admin/master/meeting/archive/manage",{skdHost:t,title:i,originalName:n,startDate:s,endDate:a,pageNo:o,pageCnt:l})},userAssignList:(e={})=>{const{approvalStatus:t,meetingStatus:i,roomType:n,title:s,host:a,writerKey:o,attendeeName:l,elecYN:r,secretYN:d,startDate:c,endDate:h,pageNo:m,pageCnt:p,orderColumn:u,orderDirection:g="DESC"}=e;return S("/api/ewp/meeting/assign/manage/user",{approvalStatus:t,meetingStatus:i,roomType:n,title:s,host:a,writerKey:o,attendeeName:l,elecYN:r,secretYN:d,startDate:c,endDate:h,pageNo:m,pageCnt:p,orderColumn:u,orderDirection:g})},deptAssignList:(e={})=>{const{approvalStatus:t,meetingStatus:i,roomType:n,title:s,host:a,attendeeName:o,elecYN:l,secretYN:r,startDate:d,endDate:c,pageNo:h,pageCnt:m,orderColumn:p,orderDirection:u="DESC"}=e;return S("/api/ewp/meeting/assign/manage/dept",{approvalStatus:t,meetingStatus:i,roomType:n,title:s,host:a,attendeeName:o,elecYN:l,secretYN:r,startDate:d,endDate:c,pageNo:h,pageCnt:m,orderColumn:p,orderDirection:u})}},Post:{assignApproval:(e={})=>{const{skdKey:t,status:i,comment:n}=e;return Y(`/api/ewp/meeting/assign/${t}/approval/${i}`,{queryParams:{comment:n}})},assignOne:(e={})=>{const{roomType:t,formData:i}=e;return Y("/api/ewp/meeting/assign/post",{data:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}},Put:{assignOne:(e={})=>{const{skdKey:t,formData:i}=e;return E(`/api/ewp/meeting/assign/${t}`,{data:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}},Delete:{}},ie={attendeeOne:(e={})=>{const{meetingKey:t,attendKey:i}=e;return S(`/api/ewp/meeting/${t}/attendee/${i}`)},attendeeListByMeeting:(e={})=>{const{meetingKey:t,attendRole:i,assistantYN:n,attendYN:s,exitYN:a,signYN:o}=e;return S(`/api/ewp/meeting/${t}/attendee/list`,{attendRole:i,assistantYN:n,attendYN:s,signYN:o})},attendeeSimpleListByMeeting:(e={})=>{const{meetingKey:t}=e;return S(`/api/ewp/meeting/${t}/attendee/list/simple`)},selectSecurityAgreementOne:(e={})=>{const{meetingKey:t,attendKey:i}=e;return S(`/api/ewp/meeting/${t}/attendee/${i}/security-agreement`)},selectSecurityAgreementAll:(e={})=>{const{meetingKey:t}=e;return S(`/api/ewp/meeting/${t}/attendee/security-agreement`)}},ne={attendeeList:(e={})=>{const{meetingKey:t,list:i}=e;return Y(`/api/ewp/meeting/${t}/attendee`,{data:i,headers:{"Content-Type":"application/json; charset=utf-8"}})},insertSecurityAgreementOne:(e={})=>{const{meetingKey:t,signSrc:i}=e;return Y(`/api/ewp/meeting/${t}/attendee/security-agreement`,{data:i,headers:{"Content-Type":"application/json; charset=utf-8"}})}};$((async()=>{X.init(),se.init(),oe.init()}));const se={async init(){const e=document.querySelector("#saveBtn");ae.disable=()=>{e.disabled=!0,e.onclick=""},isPost?(ae.enable=()=>{e.disabled=!1,e.onclick=async()=>{e.disabled=!0;const t=X.validation();t.valid?await ae.post():u.info({msg:t.msg}),e.disabled=!1}},e.innerHTML="등 록",await this.setPostMode(),ae.enable()):(ae.enable=()=>{e.disabled=!1,e.onclick=async()=>{e.disabled=!0;const t=X.validation();t.valid?await ae.put():u.info({msg:t.msg}),e.disabled=!1}},e.innerHTML="수 정",await this.setPutMode(),ae.enable()),this.setApprovalManager()},async setPostMode(){const e=await ee.roomOne({roomType,roomKey});X.initRoomParam(e),X.initAttendeeHandler({officeCode:e.officeCode,editable:!0});let t=moment(holdingDate).format("YYYY-MM-DD");"Invalid date"==t&&(t=moment().format("YYYY-MM-DD")),X.initScheduleParam({holdingDate:t,beginTime:startTime,finishTime:endTime,attendeeCnt:0})},async setPutMode(){const e=await te.Get.assignOne(skdKey);if(e){ae.meetingKey=e.meetingKey,X.initAttendeeHandler({officeCode:e.officeCode,editable:!0}),X.initHiddenParam(e),X.initStatusParam(e),X.initRoomParam(e.room),X.initScheduleParam(e),X.initMeetingParam(e);const t=await ie.attendeeSimpleListByMeeting({meetingKey:e.meetingKey});X.initAttendeeParam(t);const i=await I.meetingMaterialFileList(e.meetingKey);X.setFiles(i)}else location.href=history.back()},async setApprovalManager(){const{officeCode:e,roomType:i}=X.getRoomParam();await b({request:U.Get.approvalManagerPublicList,param:{officeCode:e,roomType:i}}).success((e=>{const i=l("#managerName"),n=l("#managerTel");if(t(e))i.innerHTML="미지정",n.innerHTML="-";else{const t=e[0];i.innerHTML=t.userName,n.innerHTML=t.officeDeskPhone}})).error((()=>{})).exe()}},ae={async post(){try{let e=[],i=[];const n=R.getHoldingDate(),s=R.getEndDate?.()?R.getEndDate():n,a=(e,t,i=!1)=>{const n=moment(e),s=moment(t);let a=0;for(let e=n;e.isSameOrBefore(s);e.add(1,"days")){if(i){const t=e.day();if(6===t||0===t)continue}a++}return a},o=async(e,t,n=!1)=>{const s=moment(e),a=moment(t);for(let e=s;e.isSameOrBefore(a);e.add(1,"days")){if(n){const t=e.day();if(6===t||0===t)continue}const s=e.format("YYYY-MM-DD");if(X.setDateTimeInput({holdingDate:s}),!await l())if(u.endLoading(),s==t){const e=i[i.length-1];await u.confirm({title:"신청 실패",msg:s+"일 예약에 실패했습니다.",detail:[e.detail]})}else{if("OK"!=await u.confirm({title:"신청 실패",msg:s+"일 예약에 실패했습니다. 연속신청을 계속 진행하시겠습니까?"}))return;u.startLoading()}}},l=async()=>{const t=X.getInputParam(),n=$(t).serialize();let s=null,a=null;try{s=await this.postAssign(n),e.push(s)}catch(e){a=e,i.push(a)}if(s){const e=s.data.meetingKey;return await this.postAttendee(e),await this.postFile(e),!0}return!1},r=a(n,s);if(r>1&&"OK"!=await u.confirm({title:"연속 신청",msg:n+"일부터 "+s+"일까지 "+r+"일 연속 예약 신청을 하시겠습니까?"}))return;if(u.startLoading(),await o(n,s),u.endLoading(),!t(e)){await u.info({msg:"회의가 등록되었습니다."}),history.replaceState(null,null,"/ewp/dashboard");const t=e.pop().data.skdKey;location.href=`/ewp/meeting/assign/${t}`}}catch(e){console.log("err",e),u.error({response:e})}finally{u.endLoading()}},async put(){try{u.startLoading();const e=X.getChangedInputParam();if(e){const t=$(e).serialize();await this.putAssign(t)}const t=this.meetingKey;await this.postAttendee(t),await this.postFile(t),await this.deleteFile(t),u.endLoading(),await u.info({msg:"회의가 수정되었습니다."}),history.replaceState(null,null,"/ewp/dashboard"),location.href=`/ewp/meeting/assign/${skdKey}`}catch(e){console.log("err",e),u.error({response:e})}finally{u.endLoading()}},async postAssign(e){try{const t=await te.Post.assignOne({roomType,formData:e});if(200!=t.status)throw t;return t}catch(e){throw e}},async putAssign(e){try{const t=await te.Put.assignOne({skdKey,formData:e});if(200!=t.status)throw t;return t}catch(e){throw e}},async postAttendee(e){try{const t=X.getAttendeeParam();if(!t)return;const i=[];if(t?.insertList.forEach((e=>{i.push({userKey:e.userKey,deptId:e.deptId,data:e.attendRole,operation:"CREATE"})})),t?.updateList.forEach((e=>{i.push({userKey:e.userKey,data:e.attendRole,operation:"UPDATE"})})),t?.deleteList.forEach((e=>{i.push({userKey:e.userKey,data:e.attendRole,operation:"DELETE"})})),0==i.length)return;const n=await ne.attendeeList({meetingKey:e,list:i});if(200!=n.status)throw n;return n}catch(e){throw e}},async postFile(e){const t=e=>{const t=new FormData;return e.forEach((e=>{t.append("list",e)})),t};try{const i=X.getAddedFiles();if(console.log("fileList",i),!i||0==i.length)return;const n=await B.meetingFileList({meetingKey:e,fileType:"MATERIAL",fileList:t(i)});if(200!=n.status)throw n;return n}catch(e){throw e}},async deleteFile(e){try{const t=X.getDeletedFiles();if(!t||0==t.length)return;const i=await O.meetingFileList({meetingKey:e,fileList:t});if(200!=i.status)throw i;return i}catch(e){throw e}}},oe={init(){this.enableCancelBtn(),this.enableTitleClearBtn(),this.enableSkdHostClearBtn(),this.enableContentsClearBtn(),this.enableLoadInfoBtn()},enableCancelBtn(){$("#cancelBtn").click((e=>{""!=$("#skdKeyInput").val()?location.href=`/ewp/meeting/assign/${skdKey}`:history.back()}))},enableTitleClearBtn(){const e=l("#titleInputClear");e&&(e.onclick=()=>{console.log("inputHandler",R),R.clearTitle()})},enableSkdHostClearBtn(){const e=l("#skdHostInputClear");e&&(e.onclick=()=>{R.clearSkdHost()})},enableContentsClearBtn(){const e=l("#contentsInputClear");e&&(e.onclick=()=>{R.clearContents()})},enableLoadInfoBtn(){const e=l("#loadInfoBtn");if(e){const t=u.get("callRegModal");if(!t)return;const i=async e=>{const t=u.get("infoReservedMeeting");t.querySelector("#titleInput").innerHTML=e.title,t.querySelector("#scheduleInput").innerHTML=moment(e.beginDateTime).format("HH:mm")+" ~ "+moment(e.finishDateTime).format("HH:mm"),t.querySelector("#hostInput").innerHTML=e.skdHost;const i=t.querySelector("[data-row=facilitator]"),n=t.querySelector("[data-row=attendeeList]");if("Y"==e.elecYN){i.style.display="",n.style.display="",t.querySelector("#facilitatorNameplateInput").innerHTML=e.facilitatorName?e.facilitatorName:"";const a=t.querySelector("#attendeeListInput");a.innerHTML="";for(const t of e.attendeeList.filter((e=>"HOST"!=e.attendRole))){const e=s("span","mr-1");e.innerHTML=t.userName,a.appendChild(e)}}else i.style.display="none",n.style.display="none";return await t.show()},n=e=>{const n=s("tr");return(()=>{const t=s("td","align-middle"),i=s("h3"),o=s("span","badge");let l,r=["","d-none"];switch(e.approvalStatus){case"REQUEST":[l,r]=["승인대기","badge-warning"];break;case"APPROVED":[l,r]=["승인완료","badge-primary"];break;case"CANCELED":[l,r]=["사용취소","badge-secondary"];break;case"REJECTED":[l,r]=["승인불가","badge-danger"]}a(o,r),o.innerText=l,i.appendChild(o),t.appendChild(i),n.appendChild(t)})(),(()=>{const t=s("td","align-middle");t.innerHTML=e.holdingDate+"<br>"+moment(e.beginDateTime).format("HH:mm")+"~"+moment(e.finishDateTime).format("HH:mm"),n.appendChild(t)})(),(()=>{const t=s("td","align-middle");t.style.maxWidth="150px";const i=s("span","text-truncate","d-inline-block","w-100");i.innerHTML=e.title,t.appendChild(i),n.appendChild(t)})(),(()=>{const t=s("td","align-middle");t.innerHTML=e.skdHost,n.appendChild(t)})(),(()=>{const t=s("td","align-middle"),i=e.attendeeList.filter((e=>"HOST"==e.attendRole)).pop()?.userName;e.facilitatorName=i,i&&(t.innerHTML=i),n.appendChild(t)})(),(()=>{const t=s("td","align-middle");t.style.maxWidth="150px";const i=e.attendeeList.filter((e=>"HOST"!=e.attendRole));let a="";for(const e of i)a+=e.userName+" ";const o=s("span","text-truncate","d-inline-block","w-100");o.innerHTML=a,t.appendChild(o),n.appendChild(t)})(),n.onclick=async()=>{if("OK"!=await i(e))return;u.startLoading(),X.setScheduleParam({beginDateTime:e.beginDateTime,finishDateTime:e.finishDateTime,skdHost:e.skdHost,attendeeCnt:e.attendeeCnt}),X.setMeetingParam(e);let n=[];"Y"==e.elecYN&&(n=await ie.attendeeSimpleListByMeeting({meetingKey:e.meetingKey})),X.clearAttendeeParam(),X.setAttendeeParam(n),u.endLoading(),t.close()},n},o=t.querySelector(".modalBody"),l=t.querySelector("tbody");e.onclick=async()=>{await t.show((async()=>{if(!t.loaded){l.innerHTML="",u.startLoading({animation:"spinner",target:o});const e=await b({request:te.Get.assignListForRegister,param:{pageNo:1,pageCnt:10},loading:!1}).exe();u.endLoading(),e.forEach((e=>{if("N"==e.secretYN){const t=n(e);l.appendChild(t)}})),t.loaded=!0}}))}}}}})();